"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[90974],{828109:(e,r,t)=>{t.r(r),t.d(r,{default:()=>z});var n=t(273517),o=t(54620),i=t(754602),a=t(712651),l=t(736128),u=t(934142),c=t(644294),d=t(611217),s=t(694974),f=t(652490),y=t(385733),p=t(786717),v=t(206933),g=t(429276),w=t(927733),m=t(113628),h=t(200953),b=t(987021),j=t.n(b),A=t(958704),O=t(764932),P=t(305493);function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function D(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function C(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?D(Object(t),!0).forEach(function(r){_(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):D(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _(e,r,t){return(r=L(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function E(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L(n.key),n)}}function L(e){var r=function(e){if("object"!=S(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var t=r.call(e,"string");if("object"!=S(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==S(r)?r:r+""}function k(e){return function(e){if(Array.isArray(e))return G(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return G(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?G(e,r):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}var F=new l.A,T={Circle:function(e){var r=e.map,t=e.onDrawing;return function(e,n,o){var i=n;i||(i=new u.Ay([])).set("@geometry",new c.A([]));var a=o?o.getCode():r.getView().getProjection().getCode(),l=(0,y.pd)(e[0],a,"EPSG:4326"),d=(0,y.pd)(e[1],a,"EPSG:4326"),s=(0,f.Yf)(l,d),p=(0,u.kj)(l,s,128);return p.transform("EPSG:4326",a),i.setCoordinates(p.getCoordinates()),i.get("@geometry").setCoordinates(e[0]),i.set("@properties",{radius:s,geodesic:!0}),t({coordinates:k(e)}),i}},LineString:function(e){var r=e.map,t=e.onDrawing;return function(e,n,o){var i=n;i||(i=new d.A([])).set("@geometry",new d.A([]));var a=o?o.getCode():r.getView().getProjection().getCode(),l=(0,O.transformLineToArcs)(e.map(function(e){var r=(0,O.reproject)(e,a,"EPSG:4326");return[r.x,r.y]}));return i.setCoordinates(l.map(function(e){var r=(0,O.reproject)(e,"EPSG:4326",a);return[r.x,r.y]})),i.get("@geometry").setCoordinates(e),i.set("@properties",{geodesic:!0}),t({coordinates:k(e)}),i}},Polygon:function(e){var r=e.map,t=e.onDrawing;return function(e,n,o){var i=n;i||(i=new u.Ay([])).set("@geometry",new u.Ay([]));var a=o?o.getCode():r.getView().getProjection().getCode(),l=e[0].length?[[].concat(k(e[0]),[e[0][0]])]:[],c=(0,O.transformLineToArcs)(l[0].map(function(e){var r=(0,O.reproject)(e,a,"EPSG:4326");return[r.x,r.y]}));return i.setCoordinates([c.map(function(e){var r=(0,O.reproject)(e,"EPSG:4326",a);return[r.x,r.y]})]),i.get("@geometry").setCoordinates(l),i.set("@properties",{geodesic:!0}),t({coordinates:[].concat(l)}),i}}},I={Point:function(e){var r=e.onDrawing;return function(e,t){var n=t;return n||(n=new c.A([])),n.setCoordinates(e),r({coordinates:k(e)}),n}},Circle:function(e){var r=e.onDrawing;return function(e,t){var n=t;n||(n=new s.A([])).set("@geometry",new c.A([]));var o=(0,v.hG)(e[0],e[1]),i=Math.sqrt(o);return n.setCenterAndRadius(e[0],i),n.get("@geometry").setCoordinates(e[0]),n.set("@properties",{radius:i}),r({coordinates:k(e)}),n}},LineString:function(e){var r=e.onDrawing;return function(e,t){var n=t;return n||(n=new d.A([])),n.setCoordinates(e),r({coordinates:k(e)}),n}},Polygon:function(e){var r=e.onDrawing;return function(e,t){var n=t;n||(n=new u.Ay([]));var o=e[0].length?[[].concat(k(e[0]),[e[0][0]])]:[];return n.setCoordinates(o),r({coordinates:[].concat(o)}),n}}};function x(e,r){if(void 0===r)return e;var t=j()(e).toRgb(),n=t.r,o=t.g,i=t.b;return"rgba(".concat([n,o,i,r].join(", "),")")}const N=function(){return e=function e(){var r=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.type,l=t.coordinatesLength,u=!!t.geodesic,c=t.onDrawStart?t.onDrawStart:function(){},d=t.onDrawing?t.onDrawing:function(){},s=t.onDrawEnd?t.onDrawEnd:function(){};this._map=t.map;var f=(0,P.zY)(t.style),y=new i.A({wrapX:!1});this._layer=new a.A({source:y,zIndex:1/0,style:function(e){var r,t,n,o,i,a,l,u,c,d,s=e.getGeometry().getType(),y=new h.A(C({color:x(null==f||null===(r=f.line)||void 0===r?void 0:r.color,null==f||null===(t=f.line)||void 0===t?void 0:t.opacity),width:null==f||null===(n=f.line)||void 0===n?void 0:n.width},(null==f||null===(o=f.line)||void 0===o?void 0:o.dashLength)&&{lineDash:[f.line.dashLength,f.line.dashLength]})),p=new m.A({color:x(null==f||null===(i=f.area)||void 0===i?void 0:i.color,null==f||null===(a=f.area)||void 0===a?void 0:a.opacity)});return"Point"===s?new g.Ay({image:new w.A({stroke:new h.A({color:x(null==f||null===(l=f.coordinatesNode)||void 0===l?void 0:l.color,null==f||null===(u=f.coordinatesNode)||void 0===u?void 0:u.opacity),width:null==f||null===(c=f.coordinatesNode)||void 0===c?void 0:c.width}),radius:null==f||null===(d=f.coordinatesNode)||void 0===d?void 0:d.radius})}):"LineString"===s?new g.Ay({stroke:y}):new g.Ay({stroke:y,fill:p})}});var v=u&&T[n]?T[n]:I[n];this._draw=new o.Ay({source:y,type:n,maxPoints:l,stopClick:!0,freehandCondition:A.Zm,geometryFunction:v?v({map:this._map,onDrawing:d}):void 0,style:function(e){var r,t,o,i,a,l,u,c,d,s,y=e.getGeometry().getType(),p=new h.A(C({color:x(null==f||null===(r=f.lineDrawing)||void 0===r?void 0:r.color,null==f||null===(t=f.lineDrawing)||void 0===t?void 0:t.opacity),width:null==f||null===(o=f.lineDrawing)||void 0===o?void 0:o.width},(null==f||null===(i=f.lineDrawing)||void 0===i?void 0:i.dashLength)&&{lineDash:[f.lineDrawing.dashLength,f.lineDrawing.dashLength]})),v=new m.A({color:x(null==f||null===(a=f.areaDrawing)||void 0===a?void 0:a.color,null==f||null===(l=f.areaDrawing)||void 0===l?void 0:l.opacity)});return"Point"===y?new g.Ay({image:new w.A({stroke:new h.A({color:x(null==f||null===(u=f.cursor)||void 0===u?void 0:u.color,null==f||null===(c=f.cursor)||void 0===c?void 0:c.opacity),width:null==f||null===(d=f.cursor)||void 0===d?void 0:d.width}),radius:null==f||null===(s=f.cursor)||void 0===s?void 0:s.radius})}):"LineString"===y&&"LineString"===n?new g.Ay({stroke:p}):"Polygon"===y&&["Polygon","Circle"].includes(n)||"Circle"===y?new g.Ay({stroke:p,fill:v}):null}}),this._draw.on("drawstart",function(){c()}),this._draw.on("drawend",function(e){var t=e.feature.getGeometry().get("@properties")||{geodesic:u},n=e.feature.getGeometry().get("@geometry")?new p.A({geometry:e.feature.getGeometry().get("@geometry")}):e.feature;s({feature:C(C({},F.writeFeatureObject(n,{featureProjection:r._map.getView().getProjection().getCode(),dataProjection:"EPSG:4326"})),{},{properties:t})})}),this._map.addInteraction(this._draw),this._map.addLayer(this._layer)},(r=[{key:"getCoordinates",value:function(){return[]}},{key:"remove",value:function(){this._draw&&(this._map.removeInteraction(this._draw),this._draw=null),this._layer&&(this._map.removeLayer(this._layer),this._layer=null)}}])&&E(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r}();function V(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}const z=function(e){var r=e.map,t=e.active,o=e.geometryType,i=void 0===o?"LineString":o,a=e.geodesic,l=void 0!==a&&a,u=e.onDrawStart,c=void 0===u?function(){}:u,d=e.onDrawing,s=void 0===d?function(){}:d,f=e.onDrawEnd,y=void 0===f?function(){}:f,p=e.onInit,v=void 0===p?function(){}:p,g=e.onDestroy,w=void 0===g?function(){}:g,m=e.coordinatesLength,h=e.style,b=(0,n.useRef)();return(0,n.useEffect)(function(){return r&&t&&(v(),b.current=new N({map:r,type:i,coordinatesLength:m,style:h,geodesic:l,onDrawStart:c,onDrawing:s,onDrawEnd:y})),function(){var e;b.current&&(w({coordinates:(e=b.current.getCoordinates(),function(e){if(Array.isArray(e))return V(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return V(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?V(e,r):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}),b.current.remove(),b.current=null)}},[r,t,i,m,l]),null}},305493:(e,r,t)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach(function(r){a(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function a(e,r,t){return(r=function(e){var r=function(e){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var t=r.call(e,"string");if("object"!=n(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function l(e){return i({wireframe:{color:"#000000",opacity:1,depthFailColor:"#000000",depthFailOpacity:.4,width:.5},lineDrawing:{color:"#000000",opacity:1,depthFailColor:"#000000",depthFailOpacity:.4,width:3,dashLength:8},line:{color:"#ffcc33",opacity:1,depthFailColor:"#ffcc33",depthFailOpacity:.4,width:2},areaDrawing:{color:"#ffffff",opacity:.5,depthFailColor:"#ffffff",depthFailOpacity:.25},area:{color:"#ffffff",opacity:.5,depthFailColor:"#ffffff",depthFailOpacity:.25},cursor:{color:"#ff0000",width:2,radius:4},coordinatesNode:{color:"#333333",width:2,radius:5}},e)}t.d(r,{Nv:()=>c,Or:()=>d,zY:()=>l});var u=function(e){var r;return null==e||null===(r=e.geometry)||void 0===r?void 0:r.type},c=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).getGeometryType,r=void 0===e?u:e;return function(e){return i(i({},null==e?void 0:e.properties),{},{geometryType:r(e)})}},d=function(e,r){return i(i({},null==r?void 0:r.properties),void 0!==(null==e?void 0:e.radius)&&{radius:e.radius})}}}]);