(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[17004],{654456:(e,t,r)=>{"use strict";r.d(t,{GW:()=>u,IY:()=>a,Ii:()=>w,Jj:()=>y,KF:()=>l,LO:()=>g,Lk:()=>F,Lm:()=>n,MN:()=>E,Mb:()=>S,P:()=>D,Rb:()=>m,UR:()=>O,V8:()=>v,VZ:()=>C,Ve:()=>d,Xi:()=>b,Z4:()=>j,ZJ:()=>i,_Z:()=>f,cv:()=>c,f4:()=>p,jF:()=>h,oR:()=>x,pF:()=>s,qD:()=>o,qu:()=>A,x5:()=>P}),r(995531);var n="LAYER_SELECTED_FOR_SEARCH",o="FEATURE_TYPE_SELECTED",a="FEATURE_TYPE_LOADED",i="FEATURE_LOADED",l="FEATURE_LOADING",s="FEATURE_TYPE_ERROR",u="FEATURE_ERROR",c="QUERY_CREATE",p="QUERY:UPDATE_QUERY",d="QUERY_RESULT",f="QUERY_ERROR",m="RESET_QUERY",y="QUERY",v="INIT_QUERY_PANEL",b="QUERY:TOGGLE_SYNC_WMS",w="QUERY:TOGGLE_LAYER_FILTER";function g(){return{type:b}}function O(){return{type:w}}function h(){return{type:v}}function S(e,t){return{type:o,url:e,typeName:t,fields:arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],owner:arguments.length>3?arguments[3]:void 0}}function E(e,t,r){return{type:a,typeName:e,featureType:t,owner:r}}function j(e,t){return{type:s,typeName:e,error:t}}function P(e){return{type:l,isLoading:e}}function A(e,t,r,n,o){return{type:d,searchUrl:t,filterObj:r,result:e,queryOptions:n,reason:o}}function F(e){return{type:f,error:e}}function x(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.updates,r=e.reason,n=e.useLayerFilter;return{type:p,updates:t,reason:r,useLayerFilter:n}}function C(e,t,r){return{type:c,searchUrl:e,filterObj:t,owner:r}}function D(e,t,r,n){return{type:y,searchUrl:e,filterObj:t,queryOptions:r,reason:n}}},926560:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(916589),o=r(164045),a=r(509820);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var l=["renderPopover","popoverOptions"];function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function u(e,t,r){return(t=function(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const c=(0,n.compose)((0,n.withProps)(function(e){var t=e.renderPopover,r=e.popoverOptions;return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}(t?{renderPopover:t,popoverOptions:r}:{},function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,l))}),(0,n.branch)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.renderPopover,r=e.popoverOptions;return t&&!!r},a.A,o.A))},509820:(e,t,r)=>{"use strict";r.d(t,{A:()=>g});var n=r(273517),o=r.n(n),a=r(551258),i=r(8117),l=r(590179),s=r.n(l),u=r(310340),c=r.n(u);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}var d=["popoverOptions","keyProp"];function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f.apply(null,arguments)}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e){if("object"!=p(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:t+""}function v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(v=function(){return!!e})()}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}const g=function(e){return function(t){function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),function(e,t,r){return t=b(t),function(e,t){if(t&&("object"==p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,v()?Reflect.construct(t,r||[],b(e).constructor):t.apply(e,r))}(this,r,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(r,t),n=r,l=[{key:"render",value:function(){var t=null,r=this.props,n=r.popoverOptions,l=r.keyProp,u=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(r,d);return o().createElement("span",{className:"mapstore-info-popover"},o().createElement(e,f({},s()(u,["renderPopover","tooltipId"]),{key:l,ref:function(e){t=e}})),o().createElement(a.A,{placement:n.placement,shouldUpdatePosition:!0,show:!0,target:function(){return c().findDOMNode(t)}},o().createElement(i.AM,n.props,n.content)))}}],l&&m(n.prototype,l),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,l}(o().Component)}},628304:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(273517),o=r.n(n),a=r(8117),i=r(711030),l=["disabled","id","visible","onClick","glyph","active","className"];function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(null,arguments)}var u={width:0,padding:0,borderWidth:0},c={},p=function(e){return e?c:u};const d=(0,n.forwardRef)(function(e,t){var r=e.disabled,n=e.id,u=e.visible,c=e.onClick,d=e.glyph,f=e.active,m=e.className,y=void 0===m?"square-button-md":m,v=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,l);return o().createElement(i.A,s({ref:t},v,{bsStyle:f?"success":"primary",disabled:r,id:"fg-".concat(n),style:p(u),className:y,onClick:function(){return!r&&c()}}),o().createElement(a.e6,{glyph:d}))})},545567:(e,t,r)=>{"use strict";r.d(t,{EV:()=>U,Gw:()=>q,o0:()=>_,sq:()=>V});var n=r(23412),o=r.n(n),a=r(956449),i=r.n(a),l=r(499084),s=r.n(l),u=r(269843),c=r.n(u),p=r(223805),d=r.n(p),f=r(45388),m=r.n(f),y=r(738805),v=r(692114),b=r(995531),w=r(102685),g=r(112585),O=r(492312),h=r(193275),S=r(79738),E=r(584153),j=["totalFeatures","features"],P=["sortOptions","propertyName"];function A(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return F(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?F(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function C(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach(function(t){T(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function T(e,t,r){return(t=function(e){var t=function(e){if("object"!=x(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==x(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var I=(0,h.A)({wfsVersion:"1.1.0"}),N=I.getFeature,L=I.query,k=I.sortBy,G=I.propertyName,M=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"json",a=(0,w.zD)(t,r),i=o().parse((0,S.t)(e),!0),l=d()(i.query)?i.query:{};l.service="WFS",l.outputFormat=n;var s=o().format({protocol:i.protocol,host:i.host,pathname:i.pathname,query:l});return r.layer&&"vector"===r.layer.type?m().Observable.defer(function(){return new Promise(function(e){var n,o=function(e,t){if(t.filterFields&&0!==t.filterFields.length){var r=e.features.filter((0,w.Jt)(t));e.features=r,e.numberMatched=r.length,e.numberReturned=r.length,e.totalFeatures=r.length}return t.sortOptions&&t.sortOptions.sortBy&&t.sortOptions.sortOrder&&"NONE"!==t.sortOptions.sortOrder&&e.features.sort(function(e,r){var n=e.properties[t.sortOptions.sortBy],o=r.properties[t.sortOptions.sortBy],a=n.toLowerCase().localeCompare(o.toLowerCase());return"ASC"===t.sortOptions.sortOrder?a:-1*a}),e}({crs:{type:"name",properties:{name:"urn:ogc:def:crs:EPSG::4326"}},numberMatched:(n=r.layer.features).length,numberReturned:n.length,timeStamp:"2020-07-20T11:36:20.118Z",totalFeatures:n.length,type:"FeatureCollection",features:n},t);e(o)})}):{data:a,queryString:s}},_=function(e,t){var r,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;if(o.layer&&"vector"===o.layer.type)return M(e,t,o,a);var i=M(e,t,o,a),l=i.data,s=i.queryString,u=(0,E.WZ)((null===(r=o.layer)||void 0===r||null===(r=r.security)||void 0===r?void 0:r.sourceId)||(null===(n=o.security)||void 0===n?void 0:n.sourceId));return m().Observable.defer(function(){return b.A.post(s,l,{timeout:6e4,responseType:"arraybuffer",headers:R({Accept:"application/xml","Content-Type":"application/xml"},u)})})},W=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(r.layer&&"vector"===r.layer.type)return M(e,t,r);var n=M(e,t,r),o=n.data,a=n.queryString;return m().Observable.defer(function(){return b.A.post(a,o,R({timeout:6e4,headers:{Accept:"application/json","Content-Type":"application/xml"}},null==r?void 0:r.requestOptions))}).let(O.m9).map(function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.totalFeatures,r=e.features,n=C(e,j),o=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).startIndex,a=arguments.length>2?arguments[2]:void 0;return a>t&&a===o+r.length&&t===r.length?R(R({},n),{},{features:r,totalFeatures:a}):R(R({},n),{},{features:r,totalFeatures:t})}(e.data,function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).pagination||!c()(e.startIndex)&&!c()(e.maxFeatures)&&{startIndex:e.startIndex,maxFeatures:e.maxFeatures}}(t,r),r.totalFeatures)})},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.search,r=void 0===t?{}:t,n=e.url,o=e.name,a=e.security,l=arguments.length>1?arguments[1]:void 0,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=u.sortOptions,p=u.propertyName,d=C(u,P);return W(r.url||n,l&&"object"===x(l)?R(R({},l),{},{typeName:o||l.typeName}):N(L(o,[].concat(A(c?[k(c.sortBy,c.sortOrder)]:[]),A(p?[G(p)]:[]),A(l?s()(l):[]))),d),R({security:a},d)).catch(function(e){if("OGCError"===e.name&&"NoApplicableCode"===e.code&&!c&&p&&p[0])return W(r.url||n,l&&"object"===x(l)?R(R({},l),{},{typeName:o||l.typeName}):N(L(o,[k(i()(p)?p[0]:p)].concat(A(p?[G(p)]:[]),A(l?s()(l):[]))),d),d);throw e})},V=function(e){var t,r=e.layer,n=(0,E.WZ)(null==r||null===(t=r.security)||void 0===t?void 0:t.sourceId);return m().Observable.defer(function(){return b.A.get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.search,n=void 0===r?{}:r,a=e.url,i=e.describeFeatureTypeURL,l=o().parse((0,S.t)(i||n.url||a),!0);return o().format(R(R({},l),{},{search:void 0,query:R(R({},l.query),{},{service:"WFS",version:"1.1.0",typeName:t,outputFormat:"application/json",request:"DescribeFeatureType"})}))}(r),{headers:n})}).let(O.m9)},U=function(e){var t,r=e.layer,n=(0,E.WZ)(null==r||null===(t=r.security)||void 0===t?void 0:t.sourceId);return m().Observable.defer(function(){return b.A.get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.search,n=void 0===r?{}:r,a=e.url,i=(0,g.wk)({name:t,url:n&&n.url||a}),l=o().parse(i,!0);return o().format(R(R({},l),{},{search:void 0,query:R(R({},l.query),{},{service:"WFS",version:"1.1.1",request:"GetCapabilities"})}))}(r),{headers:n})}).let(O.m9).switchMap(function(e){return m().Observable.bindNodeCallback(function(e,t){return(0,y.parseString)(e,{tagNameProcessors:[v.stripPrefix],explicitArray:!1,mergeAttrs:!0},t)})(e.data)})}},909309:(e,t,r)=>{"use strict";r.d(t,{l:()=>l});var n=r(45388),o=r(995531),a=r(492312),i=r(325177),l=function(e,t){return n.Observable.defer(function(){return o.A.get((0,i.Sd)(e,{version:"1.0.0",REQUEST:"DescribeProcess",IDENTIFIER:t}),{timeout:5e3,headers:{Accept:"application/json","Content-Type":"application/xml"}})}).let(a.m9)}},571534:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>zt});var n={};r.r(n),r.d(n,{checkExportDataEntriesEpic:()=>xt,closeExportDownload:()=>Ft,fetchFormatsWFSDownload:()=>Pt,openDownloadTool:()=>jt,resetExportDataResultsOnLogout:()=>Dt,serializeCookieOnExportDataChange:()=>Ct,setExportDataResultsOnLoginSuccessAndMapConfigLoaded:()=>Rt,startFeatureExportDownload:()=>At});var o=r(273517),a=r.n(o),i=r(811668),l=r(801081),s=r(61173),u=r(415392),c=r(904059),p=r(509092),d=r(806653),f=r(307679),m=r(286447),y=r(401631),v=r(605556),b=r.n(v),w=r(324713),g=r.n(w),O=r(400912),h=r.n(O),S=r(8117),E=r(750042),j=r.n(E),P=r(275705),A=r(711520),F=r(406250),x=r(8571),C=r(3162),D=r(192016),R=r(858156),T=r.n(R),I=r(223805),N=r.n(I),L=r(962193),k=r.n(L),G=r(302404),M=r.n(G),_=r(168995),W=r(185015),q=r.n(W),V=r(348317);function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const H=function(e){var t,r,n=e.advancedOptionsVisible,i=void 0===n||n,l=e.cropDataSetVisible,s=void 0!==l&&l,u=e.cropDataSetEnabled,c=void 0!==u&&u,p=e.downloadFilteredVisible,d=void 0!==p&&p,f=e.downloadFilteredEnabled,m=void 0!==f&&f,y=e.rasterOptionsVisibile,v=void 0!==y&&y,b=e.compressionOptions,w=void 0===b?["Deflate","JPEG","PackBits","LZW","CCITT RLE","ZLib"]:b,g=e.selectedCompression,O=e.tileWidth,E=e.tileHeight,j=e.quality,P=e.placeholders,A=void 0===P?{tileWidth:"256",tileHeight:"256",quality:"0.75"}:P,F=e.srsList,C=e.selectedSrs,R=e.onChange,T=void 0===R?function(){}:R,I=(t=(0,o.useState)(!1),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],s=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,r)||function(e,t){if(e){if("string"==typeof e)return U(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?U(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),N=I[0],L=I[1];return(0,o.useEffect)(function(){T("compression",g||h()(w))},[]),a().createElement(a().Fragment,null,i&&a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-options"},a().createElement(S.$n,{className:"no-border",onClick:function(){return L(!N)}},a().createElement(S.e6,{glyph:"chevron-".concat(N?"down":"right")}),"   ",a().createElement(x.A,{msgId:"layerdownload.advancedOptions"}))),N&&i&&a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced"},a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement("label",null,a().createElement(x.A,{msgId:"layerdownload.srs"})),a().createElement(D.Ay,{clearable:!1,value:C,onChange:function(e){return T("selectedSrs",e.value)},options:F.map(function(e){return{value:e.name,label:e.label||e.name}})}))),s&&a().createElement(a().Fragment,null,a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(V.A,{checked:c,onClick:function(e){return T("cropDataSet",e)}}),a().createElement(x.A,{msgId:"layerdownload.cropDataSet"})))),d&&a().createElement(a().Fragment,null,a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(V.A,{checked:m,onClick:function(e){return T("downloadFilteredDataSet",e)}}),a().createElement(x.A,{msgId:"layerdownload.downloadFilteredDataSet"})))),v&&a().createElement(a().Fragment,null,a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement(x.A,{msgId:"layerdownload.compression"}),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(D.Ay,{clearable:!1,value:g,options:w.map(function(e){return q()(e)?{value:e,label:e}:e}),onChange:function(e){return T("compression",null==e?void 0:e.value)}}))),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement(x.A,{msgId:"layerdownload.quality"}),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(S.MJ,{placeholder:A.quality,type:"number",size:"4",min:"0",max:"1",step:"0.1",value:j||"",onChange:function(e){return T("quality",e.target.value)}}))),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement(x.A,{msgId:"layerdownload.tileWidth"}),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(S.MJ,{placeholder:A.tileWidth,type:"number",size:"4",min:"0",value:O||"",onChange:function(e){return T("tileWidth",e.target.value&&e.target.value.length>0?"".concat(parseInt(e.target.value,10)):"")}}),a().createElement("span",null,"px"))),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement(x.A,{msgId:"layerdownload.tileHeight"}),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(S.MJ,{placeholder:A.tileHeight,type:"number",size:"4",min:"0",value:E||"",onChange:function(e){return T("tileHeight",e.target.value&&e.target.value.length>0?"".concat(parseInt(e.target.value,10)):"")}}),a().createElement("span",null,"px"))))))};function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J(n.key),n)}}function z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(z=function(){return!!e})()}function Y(e){return Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Y(e)}function K(e,t){return K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},K(e,t)}function Z(e,t,r){return(t=J(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J(e){var t=function(e){if("object"!=X(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=X(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==X(t)?t:t+""}var Q=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Z(r=function(e,t,r){return t=Y(t),function(e,t){if(t&&("object"==X(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,z()?Reflect.construct(t,r||[],Y(e).constructor):t.apply(e,r))}(this,t,[e]),"componentDidMount",function(){r.props.onClearDownloadOptions(r.props.service||r.props.defaultSelectedService);var e=T()(r.props,"downloadOptions.selectedFormat")||T()(h()(r.props.formats),"name"),t=T()(r.props,"downloadOptions.selectedSrs")||T()(r.props,"defaultSrs")||T()(h()(r.props.srsList),"name"),n=T()(r.props,"layer.layerFilter"),o=N()(n)&&!k()(n)||r.props.filterObj;r.props.onChange("selectedFormat",e),r.props.onChange("selectedSrs",t),r.props.onChange("downloadFilteredDataSet",o),r.props.formatOptionsFetch(r.props.layer)}),Z(r,"componentWillReceiveProps",function(e){if(!M()(r.props.formats,e.formats)){var t=T()(e,"downloadOptions.selectedFormat")||T()(h()(e.formats),"name");e.onChange("selectedFormat",t)}if(M()(r.props.service,e.service)||e.formatOptionsFetch(e.layer),!M()(r.props.layer,e.layer)){var n=T()(e,"layer.layerFilter"),o=N()(n)&&!k()(n)||e.filterObj;e.onChange("downloadFilteredDataSet",o)}if(!M()(r.props.srsList,e.srsList)){var a=T()(e,"downloadOptions.selectedSrs")||T()(e,"defaultSrs")||T()(h()(e.srsList),"name");e.onChange("selectedSrs",a)}}),Z(r,"componentWillUnmount",function(){r.props.onClearDownloadOptions(r.props.defaultSelectedService)}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e,t,r=this,n=this.props.formats.some(function(e){return"raster"===e.type});return a().createElement("form",null,!this.props.hideServiceSelector&&this.props.wpsAvailable&&this.props.wfsAvailable&&a().createElement("div",{className:"mapstore-downloadoptions downloadMode"},a().createElement("label",null,a().createElement(x.A,{msgId:"layerdownload.downloadMode"})),a().createElement("div",{className:"mapstore-downloadoptions-row"},a().createElement(D.Ay,{clearable:!1,value:this.props.service,onChange:function(e){return r.props.onSetService(e.value)},options:this.props.services})," ",a().createElement(_.A,{text:a().createElement(x.A,{msgId:"layerdownload.services.".concat(this.props.service,".tooltip")})}))),a().createElement("div",{className:"mapstore-downloadoptions"},a().createElement("label",null,a().createElement(x.A,{msgId:"layerdownload.format"})),a().createElement(D.Ay,{clearable:!1,isLoading:this.props.formatsLoading,onOpen:function(){return r.props.formatOptionsFetch(r.props.layer)},value:null===(e=this.props.downloadOptions)||void 0===e?void 0:e.selectedFormat,noResultsText:a().createElement(x.A,{msgId:"layerdownload.format"}),onChange:function(e){return r.props.onChange("selectedFormat",e.value)},options:this.props.formats.map(function(e){return{value:e.name,label:e.label||e.name}})})),a().createElement(H,{srsList:this.props.srsList,selectedSrs:null===(t=this.props.downloadOptions)||void 0===t?void 0:t.selectedSrs,cropDataSetVisible:this.props.cropDataSetVisible,advancedOptionsVisible:!0,wpsOptionsVisible:!0,rasterOptionsVisibile:n,downloadFilteredVisible:this.props.downloadFilteredVisible,downloadFilteredEnabled:this.props.downloadOptions.downloadFilteredDataSet,cropDataSetEnabled:this.props.downloadOptions.cropDataSet,selectedCompression:this.props.downloadOptions.compression,quality:this.props.downloadOptions.quality,tileWidth:this.props.downloadOptions.tileWidth,tileHeight:this.props.downloadOptions.tileHeight,onChange:this.props.onChange}),this.props.virtualScroll?null:a().createElement(S.Sc,{checked:this.props.downloadOptions.singlePage,onChange:function(){return r.props.onChange("singlePage",!r.props.downloadOptions.singlePage)}},a().createElement(x.A,{msgId:"layerdownload.downloadonlycurrentpage"})))}}])&&B(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);Z(Q,"propTypes",{cropDataSetVisible:b().bool,defaultSelectedService:b().bool,defaultSrs:b().string,downloadFilteredVisible:b().bool,downloadOptions:b().object,formatOptionsFetch:b().func,formats:b().array,formatsLoading:b().bool,filterObj:b().object,hideServiceSelector:b().bool,layer:b().object,onChange:b().func,onClearDownloadOptions:b().func,onSetService:b().func,service:b().string,services:b().arrayOf(b().object),srsList:b().array,virtualScroll:b().bool,wfsAvailable:b().bool,wpsAdvancedOptionsVisible:b().bool,wpsAvailable:b().bool,wpsOptionsVisible:b().bool}),Z(Q,"defaultProps",{cropDataSetVisible:!0,wpsAvailable:!1,wfsAvailable:!0,downloadOptions:{},formats:[],onChange:function(){},onClearDownloadOptions:function(){},formatOptionsFetch:function(){},formatsLoading:!1,srsList:[],wpsOptionsVisible:!1,wpsAdvancedOptionsVisible:!1,downloadFilteredVisible:!1,virtualScroll:!0,services:[{value:"wps",label:a().createElement(x.A,{msgId:"layerdownload.services.wps.title"})},{value:"wfs",label:a().createElement(x.A,{msgId:"layerdownload.services.wfs.title"})}],hideServiceSelector:!1});const $=Q;var ee=r(711030),te=r(525859),re=r(738805),ne=r(692114),oe=r(909309);function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ie=function(e){var t,r,n,i,l,s,u=e.attributes,c=e.checkingWPSAvailability,p=e.closeGlyph,d=e.cropDataSetVisible,f=e.customAttributeSettings,m=e.defaultSelectedService,y=e.defaultSrs,v=e.downloadLayer,b=e.downloadOptions,w=e.enabled,O=e.filterObj,E=e.formats,D=e.formatsLoading,R=e.hideServiceSelector,T=e.loading,I=e.mapLayer,N=e.onClearDownloadOptions,L=e.onClose,k=e.onDownloadOptionChange,G=e.onExport,M=e.onFormatOptionsFetch,_=e.onSetService,W=e.onSetWPSAvailability,q=e.service,V=e.srsList,U=e.virtualScroll,H=e.wfsFormats,X=e.wpsAvailable,B=I||v||{},z=(l=(0,o.useState)(!1),s=2,function(e){if(Array.isArray(e))return e}(l)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],s=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(l,s)||function(e,t){if(e){if("string"==typeof e)return ae(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ae(e,t):void 0}}(l,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),Y=z[0],K=z[1];(0,o.useEffect)(function(){var e,t;w&&(N(m),e=B,t=m,K(!0),(0,oe.l)(e.url,"gs:DownloadEstimator,gs:Download").toPromise().then(function(e){return new Promise(function(t,r){return(0,re.parseString)(e.data,{tagNameProcessors:[ne.stripPrefix]},function(e,n){return e?r(e):t(n)})})}).then(function(r){var n,o,a,i=[null==r||null===(n=r.ProcessDescriptions)||void 0===n||null===(n=n.ProcessDescription)||void 0===n||null===(n=n[0])||void 0===n||null===(n=n.Identifier)||void 0===n?void 0:n[0],null==r||null===(o=r.ProcessDescriptions)||void 0===o||null===(o=o.ProcessDescription)||void 0===o||null===(o=o[1])||void 0===o||null===(o=o.Identifier)||void 0===o?void 0:o[0]],l=g()(i,function(e){return"gs:DownloadEstimator"===e})>-1&&g()(i,function(e){return"gs:Download"===e})>-1,s=null===(a=e.search)||void 0===a?void 0:a.url,u=l&&("wps"===t||!s);_(u?"wps":"wfs"),W(u)}).catch(function(){_("wfs"),W(!1)}).finally(function(){K(!1)}))},[w,B,m]);var Z=function(e){return E.filter(function(t){var r,n,o=t.validServices,a=t.type,i=void 0===a?"vector":a;return(!o||g()(o,function(t){return t===e})>-1)&&("vector"===i&&(null==B||null===(r=B.search)||void 0===r?void 0:r.url)||"raster"===i&&!(null!=B&&null!==(n=B.search)&&void 0!==n&&n.url))})},J=Z("wfs"),Q=Z("wps"),ie=J.length>0?J.filter(function(e){return H.find(function(t){return t.name.toLowerCase()===e.name.toLowerCase()})}):H,le=Boolean(null==B||null===(t=B.search)||void 0===t?void 0:t.url),se="wfs"===q?ie:Q,ue=!le&&!X;return w?a().createElement(F.A,null,a().createElement(A.A,{id:"mapstore-export",draggable:!1,modal:!0},a().createElement("span",{role:"header"},a().createElement("span",{className:"modal-title  about-panel-title"},a().createElement(x.A,{msgId:"layerdownload.title"})),a().createElement("button",{onClick:L,className:"settings-panel-close close"},p?a().createElement(S.e6,{glyph:p}):a().createElement("span",null,"×"))),a().createElement("div",{role:"body"},Y?a().createElement(P.A,{size:100,style:{margin:"0 auto"}}):ue?a().createElement(C.A,{title:a().createElement(x.A,{msgId:"layerdownload.noSupportedServiceFound"})}):a().createElement($,{attributes:u,cropDataSetVisible:d,customAttributesSettings:f,defaultSelectedService:m,defaultSrs:y,downloadFilteredVisible:!(null==B||!B.layerFilter)||!(null==O||null===(r=O.filterFields)||void 0===r||!r.length)||(null==O||null===(n=O.spatialFields)||void 0===n?void 0:n.length),downloadOptions:b,filterObj:O,formatOptionsFetch:"wfs"===q?M:function(){},formats:se,formatsLoading:D,hideServiceSelector:R,layer:B,onChange:k,onClearDownloadOptions:N,onSetService:_,service:q,srsList:V,virtualScroll:U,wfsAvailable:le,wpsAdvancedOptionsVisible:!(null!=B&&null!==(i=B.search)&&void 0!==i&&i.url),wpsAvailable:X})),!c&&!ue&&a().createElement("div",{role:"footer"},a().createElement(ee.A,{bsStyle:"primary",className:"download-button",disabled:D||0===E.length,onClick:function(){var e=b&&b.selectedSrs||y||(h()(V)||{}).name,t=(0,te.Eo)(u,f);G(null==B?void 0:B.url,O,Object.assign({},b,{selectedSrs:e},{propertyName:t}))}},T?a().createElement("div",{style:{float:"left"}},a().createElement(j(),{spinnerName:"circle",noFadeIn:!0})):a().createElement(S.e6,{glyph:"download"})," ",a().createElement(x.A,{msgId:"layerdownload.export"}))))):null};ie.propTypes={attributes:b().array,checkingWPSAvailability:b().bool,closeGlyph:b().string,cropDataSetVisible:b().bool,customAttributeSettings:b().object,defaultSelectedService:b().string,defaultSrs:b().string,downloadLayer:b().object,downloadOptions:b().object,enabled:b().bool,filterObj:b().object,formats:b().array,formatsLoading:b().bool,hideServiceSelector:b().bool,loading:b().bool,mapLayer:b().object,onCheckWPSAvailability:b().func,onClearDownloadOptions:b().func,onClose:b().func,onDownloadOptionChange:b().func,onExport:b().func,onFormatOptionsFetch:b().func,onSetService:b().func,onSetWPSAvailability:b().func,service:b().string,srsList:b().array,virtualScroll:b().bool,wfsFormats:b().array,wpsAvailable:b().bool},ie.defaultProps={onExport:function(){},onClose:function(){},onCheckWPSAvailability:function(){},onSetService:function(){},onSetWPSAvailability:function(){},onDownloadOptionChange:function(){},onClearDownloadOptions:function(){},onFormatOptionsFetch:function(){},checkingWPSAvailability:!1,closeGlyph:"1-close",wpsAvailable:!1,service:"wfs",defaultSelectedService:"wps",wfsFormats:[],formats:[{name:"image/tiff",label:"TIFF",type:"raster",validServices:["wps"]},{name:"application/arcgrid",label:"ArcGrid",type:"raster",validServices:["wps"]},{name:"application/json",label:"GeoJSON",type:"vector",validServices:["wps"]},{name:"application/zip",label:"Shapefile",type:"vector",validServices:["wps"]},{name:"text/csv",label:"CSV",type:"vector",validServices:["wps"]},{name:"application/wfs-collection-1.0",label:"GML2",type:"vector",validServices:["wps"]},{name:"application/wfs-collection-1.1",label:"GML3",type:"vector",validServices:["wps"]}],formatsLoading:!1,srsList:[{name:"native",label:"Native"},{name:"EPSG:4326",label:"WGS84"}],virtualScroll:!0,downloadOptions:{},hideServiceSelector:!1};const le=ie;var se=r(908714),ue=r(926560),ce=r(628304),pe=(0,ue.A)(ce.A),de=r(45388),fe=r.n(de),me=r(269843),ye=r.n(me),ve=r(907309),be=r.n(ve),we=r(244383),ge=r.n(we),Oe=r(318938),he=r.n(Oe),Se=r(499084),Ee=r.n(Se),je=r(791936),Pe=r(541033),Ae=r.n(Pe),Fe=r(980971),xe=r(654456),Ce=r(883832),De=r(754364),Re=r(538704),Te=r(130711),Ie=r(131127),Ne=r(501719),Le=r(545567),ke=r(395950),Ge=r.n(ke),Me=r(590179),_e=r.n(Me),We=r(325177),qe=r(264053);function Ve(e){return Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ve(e)}function Ue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function He(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(r),!0).forEach(function(t){Xe(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ue(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Xe(e,t,r){return(t=function(e){var t=function(e){if("object"!=Ve(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ve(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ve(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Be(e){return function(e){if(Array.isArray(e))return Ye(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ze(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ze(e,t){if(e){if("string"==typeof e)return Ye(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ye(e,t):void 0}}function Ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Ke=function(e){var t=e.type,r=e.data;return"TEXT"===t?(0,We.oW)((0,We.Xs)((0,We.Gr)(r.data),r.mimeType)):(0,We.Nj)(r.mimeType,r.href,r.method,(0,We.Gr)(r.requestBodyData))},Ze=function(e,t,r){if(e&&t){var n=(0,qe.p4)(e,(l=(i={layerName:t.layerName,ROI:t.ROI,roiCRS:t.roiCRS,dataFilter:t.dataFilter,targetCRS:t.targetCRS}).layerName,s=i.ROI,u=i.roiCRS,c=i.dataFilter,p=i.targetCRS,(0,qe.Yy)("gs:DownloadEstimator",[(0,We.XH)("layerName",(0,We.oW)((0,We.mC)(l)))].concat(Be(s?[(0,We.XH)("ROI",Ke(s))]:[]),Be(u?[(0,We.XH)("RoiCRS",(0,We.oW)((0,We.mC)(u)))]:[]),Be(c?[(0,We.XH)("filter",Ke(c))]:[]),Be(p?[(0,We.XH)("targetCRS",(0,We.oW)((0,We.mC)(p)))]:[])))),{outputsExtractor:(0,qe.$t)(qe.J7)}),o=t.resultOutput||t.outputFormat||"application/zip",a=(0,qe.p4)(e,function(e){var t=e.layerName,r=e.dataFilter,n=e.outputFormat,o=e.targetCRS,a=e.roiCRS,i=e.ROI,l=e.cropToROI,s=e.asynchronous,u=e.outputAsReference,c=e.resultOutput,p=e.writeParameters;return(0,qe.Yy)("gs:Download",[(0,We.XH)("layerName",(0,We.oW)((0,We.mC)(t))),(0,We.XH)("outputFormat",(0,We.oW)((0,We.mC)(n)))].concat(Be(i?[(0,We.XH)("ROI",Ke(i))]:[]),Be(r?[(0,We.XH)("filter",Ke(r))]:[]),Be(o?[(0,We.XH)("targetCRS",(0,We.oW)((0,We.mC)(o)))]:[]),Be(a?[(0,We.XH)("RoiCRS",(0,We.oW)((0,We.mC)(a)))]:[]),[(0,We.XH)("cropToROI",(0,We.oW)((0,We.mC)(l?"true":"false")))],Be(p&&Ge()(p).length>0?[(0,We.Xk)(he()(p).map(function(e){var t,r,n=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],s=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,r)||ze(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],a=n[1];return(0,We._y)(o,a)}).join(""))]:[])),(0,We.mk)(s?(0,We.ru)(!0,!0,u?(0,We.Xi)(c,!0,"result"):(0,We.Cs)("result",c)):(0,We.Cs)("result",c)))}(He(He({},_e()(t,"notifyDownloadEstimatorSuccess","attribute")),{},{outputAsReference:!!t.asynchronous&&t.outputAsReference,resultOutput:o})),r,{headers:{"Content-Type":"application/xml",Accept:"application/xml, ".concat(o)}});return n.catch(function(){throw new Error("DownloadEstimatorException")}).mergeMap(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length>0&&"result"===e[0].identifier&&"true"===e[0].data)return t.notifyDownloadEstimatorSuccess?de.Observable.of("DownloadEstimatorSuccess").concat(a):a;throw new Error("DownloadEstimatorFailed")})}var i,l,s,u,c,p;return de.Observable.empty()},Je=r(102685),Qe=r(564116),$e=r(112585),et=r(764932),tt=r(492312),rt=r(193275),nt=r(184435),ot=r(112206);function at(e){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},at(e)}function it(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function lt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?it(Object(r),!0).forEach(function(t){st(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):it(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function st(e,t,r){return(t=function(e){var t=function(e){if("object"!=at(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=at(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==at(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ut(e){return function(e){if(Array.isArray(e))return pt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ct(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(e,t){if(e){if("string"==typeof e)return pt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pt(e,t):void 0}}function pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var dt={gml3:"GML3.1",GML2:"GML2","DXF-ZIP":"DXF-ZIP","application/vnd.google-earth.kml+xml":"KML","OGR-CSV":"OGR-CSV","OGR-FileGDB":"OGR-GeoDatabase","OGR-GPKG":"OGR-GeoPackage","OGR-KML":"OGR-KML","OGR-MIF":"OGR-MIF","OGR-TAB":"OGR-TAB","SHAPE-ZIP":"Shapefile",gml32:"GML3.2","application/json":"GeoJSON",csv:"CSV","application/x-gpkg":"GeoPackage",excel:"excel",excel2007:"excel2007"},ft=(0,rt.A)({wfsVersion:"1.1.0"}),mt=ft.getFeature,yt=ft.query,vt=ft.sortBy,bt=ft.propertyName,wt=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=null!==(e=null==t?void 0:t.params)&&void 0!==e?e:{};return null==r?void 0:r[Object.keys(r).find(function(e){return"cql_filter"===(null==e?void 0:e.toLowerCase())})]},gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.filterObj,n=void 0===r?{}:r,o=e.layerFilter,a=e.layer,i=e.downloadOptions,l=void 0===i?{}:i,s=e.options,u=s.sortOptions,c=s.propertyNames,p=wt(a),d=(0,Je.o2)({ogcVersion:"1.1.0",addXmlnsToRoot:!0,xmlnsToAdd:['xmlns:ogc="http://www.opengis.net/ogc"','xmlns:gml="http://www.opengis.net/gml"']},l.downloadFilteredDataSet?o:{},l.downloadFilteredDataSet?n:{},p);return(0,Le.o0)(t,mt(yt(n.featureTypeName,[].concat(ut(u?[vt(u.sortBy,u.sortOrder)]:[]),ut(c?[bt(c)]:[]),ut(d?Ee()(d):[])),{srsName:l.selectedSrs})),s,l.selectedFormat)},Ot=function(e){var t=T()(e,"filterObj.featureTypeName")||"suca",r=(0,Qe.ic)(T()(e,"downloadOptions.selectedFormat"));return r&&r.extension?t+"."+r.extension:t},ht=function(e){return e.query&&e.query.featureTypes&&e.query.featureTypes[e.query.typeName]&&e.query.featureTypes[e.query.typeName].attributes&&e.query.featureTypes[e.query.typeName].attributes[0]&&e.query.featureTypes[e.query.typeName].attributes[0].attribute||null},St=function(e){switch(e.code){case"ProcessFailed":return{msgId:"layerdownload.wpsExecuteError.processFailed",msgParams:{exceptionReport:e.message}};case"NoStatusLocation":case"NoExecutionId":case"UnexpectedProcessStatus":return{msgId:"layerdownload.wpsExecuteError.badResponse",msgParams:{eCode:e.code}};case"ExecuteProcessXHRFailed":return{msgId:"layerdownload.wpsExecuteError.executeProcessXhrFailed"};case"GetExecutionStatusXHRFailed":return{msgId:"layerdonwload.wpsExecuteError.getExecutionStatusXhrFailed"};default:return{msgId:"layerdownload.wpsExecuteError.unexpectedError"}}},Et=function(e){var t=(0,Ne.dt)(e);if(null!=t&&t.id){var r=document.cookie.split(";").filter(function(e){return e.indexOf("exportDataResults_".concat(t.id,"="))>-1})[0];if(r){var n=JSON.parse(decodeURIComponent(r.split("=")[1])).results;return fe().Observable.of((0,s.D5)(n.filter(function(e){return"pending"!==e.status})))}}return fe().Observable.empty()},jt=function(e){return e.ofType(c.dC).switchMap(function(e){var t;return fe().Observable.from([(0,u.KP)("layerdownload"),(0,s.Nw)("singlePage",!1)].concat(ut(null!==(t=e.layer.search)&&void 0!==t&&t.url?[(0,xe.VZ)(e.layer.url,{featureTypeName:e.layer.name})]:[])))})},Pt=function(e){return e.ofType(s.cl).switchMap(function(e){return(0,Le.EV)(e).map(function(e){return(0,s.Ur)(function(e){var t=T()(e,"WFS_Capabilities.OperationsMetadata.Operation"),r=be()(t,function(e){return"GetFeature"===e.name}),n=T()(r,"Parameter"),o=be()(n,function(e){return"outputFormat"===e.name}).Value,a=ge()(dt,o);return he()(a).map(function(e){var t,r,n=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],s=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,r)||ct(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{name:n[0],label:n[1]}})}(e))})})},At=function(e,t){return e.ofType(s.Ne).switchMap(function(r){var n,o,a,i,l,c,y,v,b=t.getState(),w=(b.featuregrid||{}).virtualScroll,g=void 0!==w&&w,O=(0,p.TH)(b),h=(0,f.ZT)(b),S=(0,p.RF)(b),E=h||S,j=(0,Ie.HC)(b),P=(0,m.Pd)(b),A=r.downloadOptions.propertyName?[(0,ot.Dh)((0,d.uT)(b,E.name))].concat(ut(r.downloadOptions.propertyName)):null,F=E.layerFilter;return"wps"===O?(o=!(null===(n=E.search)||void 0===n||!n.url),a=r.downloadOptions.cropDataSet&&!!j&&!!j.bounds,i=wt(E),l=(0,Je.o2)({ogcVersion:"1.1.0",addXmlnsToRoot:!0,xmlnsToAdd:['xmlns:ogc="http://www.opengis.net/ogc"','xmlns:gml="http://www.opengis.net/gml"']},E.layerFilter,r.filterObj,i),c={layerName:E.name,outputFormat:r.downloadOptions.selectedFormat,asynchronous:!0,outputAsReference:!0,targetCRS:r.downloadOptions.selectedSrs&&"native"!==r.downloadOptions.selectedSrs?r.downloadOptions.selectedSrs:void 0,cropToROI:a,dataFilter:r.downloadOptions.downloadFilteredDataSet&&!k()(l)?{type:"TEXT",data:{mimeType:"text/xml; subtype=filter/1.1",data:l}}:void 0,ROI:a?{type:"TEXT",data:{mimeType:"application/wkt",data:(0,nt.U)((0,et.bboxToFeatureGeometry)(j.bounds))}}:void 0,roiCRS:a?j.crs||"EPSG:4326":void 0,writeParameters:lt(lt(lt({},r.downloadOptions.tileWidth?{tilewidth:r.downloadOptions.tileWidth}:{}),r.downloadOptions.tileHeight?{tileheight:r.downloadOptions.tileHeight}:{}),r.downloadOptions.compression?lt({compression:r.downloadOptions.compression},r.downloadOptions.quality?{quality:r.downloadOptions.quality}:{}):{}),notifyDownloadEstimatorSuccess:!0,attribute:o&&A?A:void 0},y={id:Ae()(),layerName:E.name,layerTitle:E.title,status:"pending"},v={outputsExtractor:(0,qe.$t)(qe.$V)},Ze(r.url,c,v).takeUntil(e.ofType(s.jK).filter(function(e){return e.id===y.id}).take(1)).flatMap(function(e){var t;return"DownloadEstimatorSuccess"===e?fe().Observable.of((0,s.ZL)(lt(lt({},y),{},{startTime:(new Date).getTime()})),(0,Ce.pq)({position:"tc",message:"layerdownload.exportResultsMessages.newExport"}),(0,s.iR)(),(0,u.KP)("layerdownload","enabled")):(t=fe().Observable).of.apply(t,ut(e&&e.length>0&&e[0].href?[(0,s.q9)(y.id,{status:"completed",result:e[0].href}),(0,Ce.kX)({position:"tc",message:"layerdownload.exportResultsMessages.exportSuccess",values:{layerTitle:(0,$e.ez)(E,P)}})]:[(0,s.q9)(y.id,{status:"failed",result:{msgId:"layerdonwload.exportResultsMessages.invalidHref"}}),(0,Ce.z3)({position:"tc",message:"layerdownload.exportResultsMessages.exportFailure",values:{layerTitle:(0,$e.ez)(E,P)},autoDismiss:5})]))}).catch(function(e){var t;return(t=fe().Observable).of.apply(t,ut(e.message&&e.message.indexOf("DownloadEstimator")>-1?[(0,Ce.z3)({error:e,position:"tc",title:"layerdownload.error.downloadEstimatorTitle",message:"layerdownload.error.downloadEstimatorFailed",autoDismiss:5}),(0,s.iR)()]:[(0,s.q9)(y.id,{status:"failed",result:St(e)}),(0,Ce.z3)({position:"tc",message:"layerdownload.exportResultsMessages.exportFailure",values:{layerTitle:(0,$e.ez)(E,P)},autoDismiss:5})]))})):gt({url:r.url,downloadOptions:r.downloadOptions,filterObj:ye()(r.filterObj)?{}:r.filterObj,layer:E,layerFilter:F,options:{pagination:!g&&T()(r,"downloadOptions.singlePage")?r.filterObj&&r.filterObj.pagination:null,propertyNames:A}}).do(function(e){var t=e.data;if("application/xml"===e.headers["content-type"]){var r=String.fromCharCode.apply(null,new Uint8Array(t));if(0===r.indexOf("<ows:ExceptionReport"))throw r}}).catch(function(){return gt({url:r.url,downloadOptions:r.downloadOptions,filterObj:r.filterObj,layer:E,layerFilter:F,options:{pagination:!g&&T()(r,"downloadOptions.singlePage")?r.filterObj&&r.filterObj.pagination:null,sortOptions:(e=ht(t.getState()),e?{sortBy:e,sortOrder:"A"}:{}),propertyNames:r.downloadOptions.propertyName?[].concat(ut(r.downloadOptions.propertyName),[(0,ot.Dh)((0,d.uT)(b,E.name))]):null}}).do(function(e){var t=e.data,n=e.headers;if("application/xml"===n["content-type"]){var o=String.fromCharCode.apply(null,new Uint8Array(t));if(0===o.indexOf("<ows:ExceptionReport"))throw o}(0,je.saveAs)(new Blob([t],{type:n&&n["content-type"]}),Ot(r))});var e}).do(function(e){var t=e.data,n=e.headers;(0,je.saveAs)(new Blob([t],{type:n&&n["content-type"]}),Ot(r))}).map(function(){return(0,s.iR)()}).catch(function(e){return fe().Observable.of((0,Ce.z3)({error:e,title:"layerdownload.error.title",message:"layerdownload.error.invalidOutputFormat",autoDismiss:5,position:"tr"}),(0,s.iR)())})})},Ft=function(e,t){return e.ofType(u.x7).filter(function(e){return"queryPanel"===e.control&&!(0,Te.sY)(t.getState())&&(0,Te.sl)(t.getState())}).switchMap(function(){return fe().Observable.of((0,u.KP)("layerdownload"))})},xt=function(e,t){return e.ofType(s._m).exhaustMap(function(){var e=t.getState(),r=((0,p.kI)(e)||[]).filter(function(e){return"completed"===e.status});return r.length>0?fe().Observable.forkJoin(r.map(function(e){var t=e.result,r=t.indexOf("executionId="),n=t.slice(r),o=n.indexOf("&"),a=(o>-1?n.slice(0,o):n).slice(12),i=t.indexOf("?"),l=t.slice(0,i);return(0,qe.HN)(l,a).let(tt.m9).catch(function(){return fe().Observable.of(null)}).map(function(t){return t?null:e.id})})).flatMap(function(e){return fe().Observable.of((0,s.FJ)(e.filter(function(e){return!!e})),(0,s.X8)(),(0,s.VO)(!1))}).startWith((0,s.VO)(!0)):fe().Observable.empty()})},Ct=function(e,t){return e.ofType(s.W2,s.jK,s.m8,s.kT).filter(function(){return(0,Ne.M3)(t.getState())}).do(function(){var e=t.getState(),r=(0,p.kI)(e),n=(0,Ne.dt)(e).id,o=JSON.stringify({results:r});document.cookie="exportDataResults_".concat(n,"=").concat(encodeURIComponent(o))}).flatMap(function(){return fe().Observable.empty()})},Dt=function(e){return e.ofType(Re.mO).switchMap(function(){return e.ofType(De.T_).switchMap(function(){return fe().Observable.of((0,s.D5)([]))}).takeUntil(e.ofType(Fe.LK))})},Rt=function(e,t){return e.ofType(Re.mO).switchMap(function(){return Et(t.getState()).concat(e.ofType(De._x).switchMap(function(){return Et(t.getState())}).takeUntil(e.ofType(Fe.LK)))})};function Tt(e){return Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tt(e)}function It(e){return function(e){if(Array.isArray(e))return Nt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Nt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Nt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function kt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(r),!0).forEach(function(t){Gt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lt(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Gt(e,t,r){return(t=function(e){var t=function(e){if("object"!=Tt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Tt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Mt=r(393149);function _t(e){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_t(e)}var Wt=["onClick","selectedNodes","status","itemComponent","statusTypes"];function qt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Vt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qt(Object(r),!0).forEach(function(t){Ut(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qt(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ut(e,t,r){return(t=function(e){var t=function(e){if("object"!=_t(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=_t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_t(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ht(){return Ht=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ht.apply(null,arguments)}var Xt=(0,i.connect)(function(){return{}},{onClick:c.RG})(function(e){var t,r=e.onClick,n=e.selectedNodes,o=e.status,i=e.itemComponent,l=e.statusTypes,s=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,Wt),u=i,c=null==n||null===(t=n[0])||void 0===t?void 0:t.node;return![l.LAYER].includes(o)||!("wms"===(null==c?void 0:c.type)||null!=c&&c.search)||null!=c&&c.error?null:a().createElement(u,Ht({},s,{glyph:"download",tooltipId:"toc.toolDownloadTooltip",onClick:function(){var e;return r({url:(null===(e=c.search)||void 0===e?void 0:e.url)||c.url,name:c.name,id:c.id})}}))}),Bt=(0,i.connect)(null,{onClick:c.RG})(function(e){var t=e.onClick,r=e.itemComponent,n=e.layer,o=e.widgetId,i=r;return a().createElement(i,{glyph:"download",textId:"widgets.widget.menu.downloadData",onClick:function(){return t(Vt(Vt({},n),{},{widgetId:o}))}})});const zt=(0,Mt.i1)("LayerDownload",{component:(0,i.connect)((0,l.j8)({filterObj:p._V,enabled:p.lI,downloadOptions:p.Cg,loading:p.Uc,wfsFormats:p.Cb,formatsLoading:p.uy,mapLayer:f.ZT,downloadLayer:p.RF,wpsAvailable:p.hz,service:p.TH,checkingWPSAvailability:p.B_,virtualScroll:function(e){return e&&e.featuregrid&&e.featuregrid.virtualScroll},customAttributeSettings:y.b0,attributes:d.NY}),{onExport:s._n,onSetService:s._1,onSetWPSAvailability:s.yV,onDownloadOptionChange:s.Nw,onClearDownloadOptions:s.q_,onFormatOptionsFetch:s.$1,onClose:function(){return(0,u.KP)("layerdownload")}})(le),containers:{Widgets:{doNotHide:!0,name:"LayerDownload",target:"table-menu-download",position:11,Component:Bt},Dashboard:{doNotHide:!0,name:"LayerDownload",target:"table-menu-download",position:11,Component:Bt},TOC:{doNotHide:!0,name:"LayerDownload",target:"toolbar",Component:Xt,position:11},FeatureEditor:{doNotHide:!0,name:"LayerDownload",position:20,target:"toolbar",Component:(0,i.connect)((0,l.j8)({isDownloadOpen:function(e){var t;return null==e||null===(t=e.controls)||void 0===t||null===(t=t.layerdownload)||void 0===t?void 0:t.enabled}}),{onClick:function(){return(0,u.KP)("layerdownload")}})(function(e){var t=e.disabled,r=e.results,n=void 0===r?[]:r,o=e.mode,i=e.isDownloadOpen,l=e.onClick,s=void 0===l?function(){}:l;return a().createElement(pe,{id:"download-grid",keyProp:"download-grid",tooltipId:"featuregrid.toolbar.downloadGridData",disabled:t||0===n.length,active:i,visible:"VIEW"===o,onClick:s,glyph:"download"})})},BrandNavbar:{doNotHide:!0,name:"LayerDownload",target:"right-menu",position:-1,Component:(0,i.connect)((0,l.j8)({active:p.M1,checkingExportDataEntries:p.gL,results:p.kI,currentLocale:m.Pd}),{onToggle:u.KP.bind(null,"exportDataResults","enabled"),onActive:s.HS,onRemoveResult:s.WL})(se.A)}},epics:n,reducers:{layerdownload:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{downloadOptions:{singlePage:!0}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.dC:return kt(kt({},e),{},{downloadLayer:t.layer});case s.Ne:return kt(kt({},e),{},{loading:!0});case s.VA:return kt(kt({},e),{},{downloadOptions:kt(kt({},e.downloadOptions),{},Gt({},t.key,t.value))});case s.GD:return kt(kt({},e),{},{downloadOptions:{singlePage:!0},service:t.defaultSelectedService});case s.cl:return kt(kt({},e),{},{layer:t.layer,wfsFormats:[],formatsLoading:!0});case s.eK:return kt(kt({},e),{},{loading:!1});case s.vp:return kt(kt({},e),{},{wfsFormats:t.wfsFormats,formatsLoading:!1});case s.Vz:return kt(kt({},e),{},{service:t.service});case s.WR:return kt(kt({},e),{},{wpsAvailable:t.value});case s.Ex:return kt(kt({},e),{},{checkingWPSAvailability:t.checking});case s.qp:return kt(kt({},e),{},{results:t.results});case s.W2:return kt(kt({},e),{},{results:[].concat(It(e.results||[]),[t.result])});case s.m8:var r=g()(e.results||[],{id:t.id});return kt(kt({},e),{},{results:r>-1?[].concat(It(e.results.slice(0,r)),[kt(kt({},e.results[r]),t.newProps||{})],It(e.results.slice(r+1))):e.results});case s.jK:return kt(kt({},e),{},{results:(e.results||[]).filter(function(e){return e.id!==t.id})});case s.GS:return kt(kt({},e),{},{results:(e.results||[]).filter(function(e){return-1===g()(t.ids,function(t){return t===e.id})})});case s.mf:return kt(kt({},e),{},{checkingExportDataEntries:t.checking});default:return e}}}})},564116:(e,t,r)=>{"use strict";r.d(t,{Ud:()=>i,ic:()=>s,x9:()=>a});var n=r(400912),o=r.n(n),a={json:"ext-json",wmc:"ext-wmc"},i={json:"JSON",wmc:"WMC"},l=[{outputFormat:"shape-zip",extension:"zip"},{outputFormat:"csv",extension:"csv"},{outputFormat:"excel",extension:"xls"},{outputFormat:"excel2007",extension:"xlsx"},{outputFormat:"dxf",extension:"dxf"},{outputFormat:"dxf-zip",extension:"zip"},{outputFormat:"application/vnd.google-earth.kml+xml",extension:"kml"},{outputFormat:"application/json",extension:"json"},{outputFormat:"gml3",extension:"gml"},{outputFormat:"GML2",extension:"gml"},{outputFormat:"application/vnd.googlxml",extension:"kml"},{outputFormat:"OGR-CSV",extension:"csv"},{outputFormat:"OGR-FileGDB",extension:"gdb"},{outputFormat:"OGR-GPKG",extension:"gpkg"},{outputFormat:"OGR-KML",extension:"kml"},{outputFormat:"OGR-MIF",extension:"mif"},{outputFormat:"OGR-TAB",extension:"tab"},{outputFormat:"SHAPE-ZIP",extension:"zip"},{outputFormat:"gml32",extension:"gml"},{outputFormat:"application/x-gpk",extension:"gpk"}],s=function(e){return o()(l.filter(function(t){return t.outputFormat===e}))||function(e){var t=e.split(/[^\w]/)[1];return t?{outputFormat:e,extension:t.toLowerCase()}:void 0}(e)}},913195:e=>{var t=Math.floor,r=Math.random;e.exports=function(e,n){return e+t(r()*(n-e+1))}},258253:(e,t,r)=>{var n=r(913195),o=r(936800),a=r(217400),i=parseFloat,l=Math.min,s=Math.random;e.exports=function(e,t,r){if(r&&"boolean"!=typeof r&&o(e,t,r)&&(t=r=void 0),void 0===r&&("boolean"==typeof t?(r=t,t=void 0):"boolean"==typeof e&&(r=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=a(e),void 0===t?(t=e,e=0):t=a(t)),e>t){var u=e;e=t,t=u}if(r||e%1||t%1){var c=s();return l(e+c*(t-e+i("1e-"+((c+"").length-1))),t)}return n(e,t)}}}]);