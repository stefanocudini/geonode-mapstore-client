(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[75690],{270871:(e,t,n)=>{"use strict";n.d(t,{$7:()=>o,W0:()=>i,WU:()=>a,_O:()=>r,jD:()=>c});var r="MAP_EDITOR:SHOW",o="MAP_EDITOR:HIDE",i="MAP_EDITOR:SAVE",a=function(e,t){return{type:r,owner:e,map:t}},c=function(e){return{type:o,owner:e}}},636989:(e,t,n)=>{"use strict";n.d(t,{$7:()=>p,$W:()=>T,Cj:()=>W,FK:()=>R,Hq:()=>z,Iy:()=>O,Jr:()=>d,NO:()=>U,Se:()=>C,Sl:()=>I,WU:()=>L,Wk:()=>l,_8:()=>m,_O:()=>v,aQ:()=>P,an:()=>w,bk:()=>_,cA:()=>f,dt:()=>N,fk:()=>D,jD:()=>j,jM:()=>a,jr:()=>B,lE:()=>E,l_:()=>b,m5:()=>h,mL:()=>k,ml:()=>M,nN:()=>y,on:()=>x,pd:()=>c,sg:()=>s,tJ:()=>S,u3:()=>g,up:()=>F,xL:()=>A,yP:()=>u});var r=n(223805),o=n.n(r),i=n(723630),a="MEDIA_EDITOR:ADDING_MEDIA",c="MEDIA_EDITOR:CHOOSE_MEDIA",l="MEDIA_EDITOR:EDITING_MEDIA",u="GEOSTORY:EDIT_MEDIA",s="MEDIA_EDITOR:LOAD_MEDIA",f="MEDIA_EDITOR:LOAD_MEDIA_SUCCESS",p="MEDIA_EDITOR:HIDE",d="MEDIA_EDITOR:SAVE_MEDIA",y="MEDIA_EDITOR:SET_MEDIA_TYPE",m="MEDIA_EDITOR:SET_MEDIA_SERVICE",b="MEDIA_EDITOR:SELECT_ITEM",v="MEDIA_EDITOR:SHOW",g="MEDIA_EDITOR:UPDATE_ITEM",h="MEDIA_EDITOR:IMPORT_IN_LOCAL",O="MEDIA_EDITOR:REMOVE_MEDIA",w="MEDIA_EDITOR:LOADING_SELECTED_MEDIA",E="MEDIA_EDITOR:LOADING_MEDIA_LIST",S="MEDIA_EDITOR:MEDIA_TYPE_DISABLE",P=function(e){return{type:c,resource:e}},j=function(){return{type:p}},T=function(e,t,n){return{type:s,params:e,mediaType:t,sourceId:n}},I=function(e){var t=e.mediaType,n=e.sourceId,r=e.params,o=e.resultData;return{type:f,mediaType:t,sourceId:n,params:r,resultData:o}},C=function(e){var t=e.type,n=e.source,r=e.data;return{type:d,mediaType:t,source:n,data:r}},A=function(e){return{type:"MEDIA_EDITOR:SAVE_MEDIA_SUCCESS",mediaType:e.mediaType,source:e.source,data:e.data,id:e.id}},k=function(e){return{type:b,id:e}},D=function(e){return{type:g,item:e,mode:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"merge"}},M=function(e){return{type:a,adding:e}},x=function(e){return{type:m,id:o()(e)?e.value:e}},R=function(e){return{type:y,mediaType:e}},N=function(e){return{type:l,editing:e}},L=function(e,t){return{type:v,owner:e,settings:t}},_=function(e,t){var n=e.path,r=e.owner;return{type:u,path:n,owner:void 0===r?"geostory":r,sectionType:t}},F=function(e){var t=e.resource,n=e.sourceType,r=void 0===n?i.N.GEOSTORY:n,o=e.owner;return{type:h,resource:t,sourceType:r,owner:void 0===o?"geostory":o}},z=function(e){return{type:O,mediaType:e,owner:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"geostory"}},W=function(e){return{type:w,loading:e}},B=function(){return{type:E}},U=function(){return{type:S,mediaTypes:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}}},276318:(e,t,n)=>{"use strict";n.d(t,{A:()=>j,v:()=>P});var r=n(273517),o=n.n(r),i=n(7235),a=n(223805),c=n.n(a),l=n(987021),u=n.n(l),s=n(8117),f=n(711030),p=n(596006),d=n(348317),y=n(8571),m=n(595535),b=n(164045),v=["boxShadow","MozBoxShadow","WebkitBoxShadow"];function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return(t=function(e){var t=function(e){if("object"!=g(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==g(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=(0,b.A)(f.A);function S(e){var t=e.themeStyle,n=e.disableBackgroundPicker,a=void 0!==n&&n,c=e.disableBackgroundAlpha,l=e.disableTextColor,f=e.disableShadow,b=e.onChange,g=void 0===b?function(){}:b,h=e.onOpen,w=void 0===h?function(){}:h,S=e.placement,P=(0,r.useRef)(),j=null==t?void 0:t.backgroundColor,T=null==t?void 0:t.color,I=!l&&j&&T&&!u().isReadable(T,j)?u().mostReadable(j,[T,"#000000","#ffffff"],{includeFallbackColors:!0}).toHexString():null;return o().createElement(o().Fragment,null,!a&&o().createElement("div",{className:"ms-custom-theme-picker-field"},o().createElement("div",null,o().createElement(y.A,{msgId:"geostory.customizeTheme.backgroundColorLabel"})),o().createElement("div",null,o().createElement(i.A,{placement:S,key:j,onOpen:w,color:j,format:c?"hex":"rgb",disableAlpha:c,presetColors:[],onChangeColor:function(e){var n=u()(e).isLight()?u()(e).darken(10).toHexString():u()(e).lighten(15).toHexString(),r=!l&&!(null!=t&&t.color)&&{color:u().mostReadable(e,["#000000","#ffffff"],{includeFallbackColors:!0}).toHexString()};g(O(O({},t),{},{backgroundColor:e,borderColor:n},!l&&r))}}))),!l&&o().createElement("div",{className:"ms-custom-theme-picker-field"},o().createElement("div",null,o().createElement("div",null,o().createElement(y.A,{msgId:"geostory.customizeTheme.textColorLabel"})),o().createElement(p.A,{className:"ms-custom-theme-picker-popover",ref:function(e){e&&(P.current=e.trigger)},placement:"top",content:o().createElement(o().Fragment,null,o().createElement(m.A,{msgId:"geostory.customizeTheme.alternativeTextColorPopover",msgParams:{color:I}}),o().createElement(E,{bsSize:"xs",bsStyle:"primary",style:{margin:"auto",display:"block"},onClick:function(){var e,n;g(O(O({},t),{},{color:I})),null===(e=P.current)||void 0===e||null===(n=e.hide)||void 0===n||n.call(e)}},o().createElement(y.A,{msgId:"geostory.customizeTheme.useAlternativeTextColor"})))},I&&o().createElement(E,{className:"square-button-md no-border",style:{display:I?"block":"none"}},o().createElement(s.e6,{glyph:"exclamation-mark"}))||o().createElement("div",null))),o().createElement("div",null,o().createElement(i.A,{placement:S,key:T,color:T,onOpen:w,format:"hex",disableAlpha:!0,presetColors:[],onChangeColor:function(e){g(O(O({},t),{},{color:e}))}}))),!f&&o().createElement("div",{className:"ms-custom-theme-picker-field"},o().createElement("div",null,o().createElement(y.A,{msgId:"geostory.customizeTheme.shadowLabel"})),o().createElement("div",null,o().createElement(d.A,{checked:null==t?void 0:t.boxShadow,onChange:function(){var e=t||{},n=e.boxShadow,r=(e.MozBoxShadow,e.WebkitBoxShadow,function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,v));g(n?O({},r):O(O({},r),{},{boxShadow:"0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22)"}))}}))))}function P(e){var t=e.selected,n=e.value,r=e.storyTheme,i=e.onUpdate,a=e.onActive,l=e.disableBackgroundAlpha,u=e.disableTextColor,f=e.disableShadow,p=function(e,r){var o=c()(t)&&t;return i("theme",O(O({},o),{},r?w({value:e},n,O({},r)):{value:e}))},d=r||{},m=d.color,b=d.backgroundColor,v=b&&{backgroundColor:b},g=O(O({},!u&&m&&{color:m}),v),h=(null==t?void 0:t.value)===n,P=(null==t?void 0:t[n])||g;return o().createElement(o().Fragment,null,h?o().createElement("div",{className:"ms-custom-theme-picker-menuitem-header"},o().createElement("div",null,o().createElement(y.A,{msgId:"geostory.contentToolbar.customizeThemeLabel"})),o().createElement(E,{tooltipId:"geostory.contentToolbar.customizeThemeRemoveLabel",className:"square-button-md no-border",onClick:function(e){e.stopPropagation(),p("")}},o().createElement(s.e6,{glyph:"trash"}))):o().createElement(o().Fragment,null,o().createElement(s.Dr,{active:h,onClick:function(){return p(n,P)}},o().createElement(y.A,{msgId:"geostory.contentToolbar.customizeThemeLabel"}))),h&&o().createElement("div",{className:"ms-custom-theme-picker-menuitem"},o().createElement(S,{disableBackgroundAlpha:l,disableTextColor:u,disableShadow:f,themeStyle:P,onChange:function(e){return p(n,e)},onOpen:a})))}const j=S},596006:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var r=n(273517),o=n.n(r),i=n(605556),a=n.n(i),c=n(8117),l=n(779893);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(f=function(){return!!e})()}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function y(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}var b=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return y(e=function(e,t,n){return t=p(t),function(e,t){if(t&&("object"==u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,f()?Reflect.construct(t,n||[],p(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"getContainerNode",(function(t){return t?document.body:e.parentNode||document.querySelector("."+(l.Ay.getConfigProp("themePrefix")||"ms2")+" > div")||document.body})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this,t=this.getContainerNode(this.props.useBody);return o().createElement("div",{ref:function(t){e.parentNode=t&&t.parentNode},className:this.props.className,style:this.props.style},o().createElement(c.N,{ref:function(t){e.trigger=t},trigger:["click"],container:t,placement:this.props.placement,rootClose:!0,overlay:o().createElement(c.AM,{id:this.props.id,title:this.props.title,className:this.props.popoverClassName},this.props.content)},this.props.children))}}])&&s(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o().Component);y(b,"propTypes",{id:a().string,style:a().object,className:a().string,popoverClassName:a().string,placement:a().string,title:a().node,content:a().node,useBody:a().bool}),y(b,"defaultProps",{id:"",useBody:!1});const v=b},441614:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var r=n(273517),o=n(110188);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return(t=function(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return f(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const p=function(e){var t,n=e.direction,i=void 0===n?"horizontal":n,a=e.deltaScroll,p=e.width,d=e.height,y=e.transition,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],b=u((0,r.useState)(0),2),v=b[0],g=b[1],h=u((0,r.useState)(0),2),O=h[0],w=h[1],E=(0,r.useRef)({x:0,y:0}),S=u((0,r.useState)(!1),2),P=S[0],j=S[1],T=u((0,r.useState)("start"),2),I=T[0],C=T[1],A=u((0,r.useState)(),2),k=A[0],D=A[1],M=(0,r.useRef)(),x=(0,r.useRef)({});function R(e,t){D("move:start");var n=M.current,r=n.parentNode,o=n.getBoundingClientRect(),a=r.getBoundingClientRect();if("horizontal"===i){var c=e+o.width;e<0&&c>a.width?(g(e),E.current.x=e,C("center")):e>=0?(g(0),E.current.x=0,C("start")):c<=a.width&&(g(a.width-o.width),E.current.x=a.width-o.width,C("end"))}if("vertical"===i){var l=t+o.height;t<0&&l>a.height?(w(t),E.current.y=t,C("center")):t>=0?(w(0),E.current.y=0,C("start")):l<=a.height&&(w(a.height-o.height),E.current.y=a.height-o.height,C("end"))}setTimeout((function(){D("move:end")}),y)}function N(){var e=M.current,t=e.parentNode,n=e.getBoundingClientRect(),r=t.getBoundingClientRect();return!("horizontal"===i&&r.width>=n.width||"vertical"===i&&r.height>=n.height)}(0,r.useEffect)((function(){function e(e){e.preventDefault();var t=N();return j(N()),t?R(E.current.x-(e.deltaY>0?a:-a),E.current.y-(e.deltaY>0?a:-a)):null}var t=N();j(t);var n=M.current.parentNode;return t&&R(E.current.x,E.current.y),t&&n&&n.addEventListener&&n.addEventListener("wheel",e),function(){t&&n&&n.removeEventListener&&n.removeEventListener("wheel",e)}}),[p,d].concat(function(e){if(Array.isArray(e))return f(e)}(t=m)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()));var L=(0,o.uh)({onSwiping:function(e){e.event.stopPropagation();var t=N();return j(N()),t?R(v-e.deltaX*e.velocity,O-e.deltaY*e.velocity):null},trackTouch:!0,trackMouse:!0});function _(e){var t=x.current[e];if(t){var n=M.current,r=(n&&n.parentNode).getBoundingClientRect(),o=t.getBoundingClientRect();if("horizontal"===i){var a=r.width,c=r.left,l=o.width,u=o.left,s=c+a,f=u+l;return c<=u&&s>=u||c<=f&&s>=f}}return!1}return{status:k,canSwipe:P,isStartControlActive:P&&("end"===I||"center"===I),isEndControlActive:P&&("start"===I||"center"===I),positionLabel:I,coordinates:{x:v,y:O},containerPropsHandlers:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).style,t=void 0===e?{}:e;return c(c({},L),{},{style:c({position:"relative",overflow:"hidden",width:"100%",height:"100%"},t)})},contentPropsHandlers:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).style,t=void 0===e?{}:e;return{ref:M,style:c(c(c(c({position:"absolute",display:"flex"},y&&{transition:"transform ".concat(y,"ms ease 0s")}),{},{flexDirection:"horizontal"===i?"row":"column"},P&&"horizontal"===i&&{transform:"translateX(".concat(v,"px)")}),P&&"vertical"===i&&{transform:"translateY(".concat(O,"px)")}),t)}},itemPropsHandlers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.onClick;return c({key:t,ref:function(e){return e&&function(e,t){x.current=c(c({},x.current),{},l({},e,t))}(t,e)}},n?{onClick:n,tabindex:_(t)?0:-1,onKeyDown:function(e){"Enter"===e.key&&n()}}:{tabindex:-1})},updateCoordinates:R,moveItemInViewById:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).margin,n=void 0===t?0:t,r=x.current[e];if(r){var o=M.current,a=(o&&o.parentNode).getBoundingClientRect(),c=r.getBoundingClientRect();if("horizontal"===i){var l=a.width,u=a.left,s=c.width,f=c.left;u<=f&&u+l>=f+s||R(-(f-o.getBoundingClientRect().left)+n,void 0)}}},moveToDeltaSize:function(e){R(v+e,O+e)}}}},154150:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var r=n(273517),o=n.n(r);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return(t=function(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const u=function(e){var t=e.id,n=e.children,r=e.header,i=e.footer,a=e.columns,l=e.height,u=e.style,s=void 0===u?{}:u,f=e.className,p=e.bodyClassName,d=void 0===p?"ms2-border-layout-body":p;return o().createElement("div",{id:t,className:f,style:c({display:"flex",flexDirection:"column",width:"100%",height:"100%",overflow:"hidden"},s)},r,o().createElement("div",{className:d,style:{display:"flex",flex:1,overflowY:"auto"}},o().createElement("div",{className:"ms2-border-layout-content",style:{flex:1,overflowX:"hidden"}},l?o().createElement("div",{style:{height:l}},n):n),l?o().createElement("div",{style:{height:l}},a):a),i)}},50173:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var r=n(273517),o=n.n(r),i=n(444003);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(null,arguments)}const c=function(e){return function(t){var n;return o().createElement(e,a({mapType:(0,i.Jq)(null==t||null===(n=t.map)||void 0===n?void 0:n.visualizationMode)},t))}}},437430:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var r=n(273517),o=n.n(r),i=n(605556),a=n.n(i),c=n(6683);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return(t=function(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(e){return function(t){var n,i,a,l=(null==t||null===(n=t.map)||void 0===n?void 0:n.projection)||"EPSG:3857",u=(null==t||null===(i=t.map)||void 0===i||null===(i=i.mapOptions)||void 0===i||null===(i=i.view)||void 0===i?void 0:i.DPI)||null,f=null==t||null===(a=t.map)||void 0===a||null===(a=a.mapOptions)||void 0===a||null===(a=a.view)||void 0===a?void 0:a.scales,p=(0,r.useMemo)((function(){return f?(0,c.C$)(f,l,u):null}),[f,l,u]),d=p?s(s({},t),{},{map:s(s({},t.map),{},{mapOptions:s(s({},t.map.mapOptions),{},{view:s(s({},t.map.mapOptions.view),{},{resolutions:p})})})}):t;return o().createElement(e,d)}};p.propTypes={Component:a().element};const d=p},743799:(e,t,n)=>{"use strict";n.d(t,{A:()=>w});var r=n(273517),o=n.n(r),i=n(605556),a=n.n(i),c=n(8571),l=n(496463),u=n(231666),s=n(750354);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(null,arguments)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(y=function(){return!!e})()}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}function v(e,t,n){return(t=g(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}var h={FORMAT:o().createElement(c.A,{msgId:"map.errorFormat"}),SIZE:o().createElement(c.A,{msgId:"map.errorSize"})},O=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return v(e=function(e,t,n){return t=m(t),function(e,t){if(t&&("object"==f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,y()?Reflect.construct(t,n||[],m(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"state",{}),v(e,"getThumbnailUrl",(function(){return e.props.map&&e.props.map.newThumbnail&&"NODATA"!==e.props.map.newThumbnail?decodeURIComponent(e.props.map.newThumbnail):null})),v(e,"getDataUri",(function(e,t){var n=e;if(n&&n.length>0){var r=n[0],o=new FileReader;return o.onload=function(e){return t(e.target.result,r.size)},o.readAsDataURL(r)}return t(null)})),v(e,"getThumbnailDataUri",(function(t){e.getDataUri(e.files,t)})),v(e,"generateUUID",(function(){var e=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+(0,u.H)(16))%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))})),v(e,"processUpdateThumbnail",(function(t,n,r){var o=e.generateUUID(),i="THUMBNAIL";!e.props.map||r||!e.props.map.thumbnail||e.refs.imgThumbnail||n||e.deleteThumbnail(e.props.map.thumbnail,e.props.map.id,!0),e.props.map&&!r&&e.props.map.newThumbnail&&!e.refs.imgThumbnail&&n&&(e.deleteThumbnail(e.props.map.thumbnail,e.props.map.id,!1),e.props.onSaveAll(t,n,o,r,i,e.props.map.id)),e.props.map.newThumbnail&&r&&e.refs.imgThumbnail&&(e.deleteThumbnail(e.props.map.thumbnail,null,!1),e.props.onSaveAll(t,n,o,r,i,e.props.map.id)),e.props.map.newThumbnail&&!r&&e.refs.imgThumbnail&&e.props.onSaveAll(t,n,o,r,i,e.props.map.id),e.props.map.newThumbnail||r||e.refs.imgThumbnail||(e.props.map.thumbnail&&n&&e.deleteThumbnail(e.props.map.thumbnail,e.props.map.id,!1),e.props.onSaveAll(t,n,o,r,i,e.props.map.id))})),v(e,"updateThumbnail",(function(t,n){e.props.map.errors&&e.props.map.errors.length||e.getDataUri(e.files,(function(r){return e.processUpdateThumbnail(t,n,r),r}))})),v(e,"deleteThumbnail",(function(t,n){if(t&&-1!==t.indexOf("geostore")){var r=(0,l.s)(t);r&&e.props.onDeleteThumbnail(r,n)}})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(t,e),n=t,(r=[{key:"renderThumbnailErrors",value:function(){return this.props.thumbnailErrors&&this.props.thumbnailErrors.length>0?o().createElement("div",{className:"dropzone-errorBox alert-danger"},o().createElement("p",null,o().createElement(c.A,{msgId:"map.error"})),this.props.thumbnailErrors.map((function(e){return o().createElement("div",{id:"error"+e,key:"error"+e,className:"error"+e},h[e])}))):null}},{key:"render",value:function(){var e=this;return o().createElement(s.A,p({ref:"imgThumbnail",thumbnail:this.getThumbnailUrl(),className:null,checkOriginalFileSize:this.props.checkOriginalFileSize,dropZoneProps:{className:"dropzone alert alert-info",rejectClassName:"alert-danger"},loading:this.props.loading,maxFileSize:this.props.maxFileSize,style:{pointerEvents:this.props.map.saving?"none":"auto"},label:this.props.withLabel&&o().createElement("label",{className:"control-label"},o().createElement(c.A,{msgId:"map.thumbnail"})),ù:!0,message:o().createElement(o().Fragment,null,this.props.message,o().createElement("br",null),this.props.suggestion),error:this.renderThumbnailErrors(),onUpdate:function(t,n){var r;e.props.onError([],e.props.map.id),e.files=n,e.props.onUpdate(t,null==n||null===(r=n[0])||void 0===r?void 0:r.preview)},onError:function(t,n){e.props.onError(t,e.props.map.id),e.files=n,e.props.onUpdate(null,null)},onRemove:function(){e.files=null,e.props.onUpdate(null,null),e.props.onRemoveThumbnail(),e.props.onError([],e.props.map.id)}},this.props.thumbnailOptions&&{thumbnailOptions:this.props.thumbnailOptions}))}}])&&d(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o().Component);v(O,"propTypes",{glyphiconRemove:a().string,style:a().object,thumbnailErrors:a().array,loading:a().bool,withLabel:a().bool,map:a().object,maxFileSize:a().number,thumbnailOptions:a().object,onDrop:a().func,onError:a().func,onUpdate:a().func,onSaveAll:a().func,onCreateThumbnail:a().func,onDeleteThumbnail:a().func,onRemoveThumbnail:a().func,message:a().oneOfType([a().string,a().element]),suggestion:a().oneOfType([a().string,a().element]),checkOriginalFileSize:a().bool}),v(O,"contextTypes",{messages:a().object}),v(O,"defaultProps",{loading:!1,withLabel:!0,glyphiconRemove:"remove-circle",maxFileSize:5e5,onDrop:function(){},onError:function(){},onUpdate:function(){},onSaveAll:function(){},onRemoveThumbnail:function(){},onCreateThumbnail:function(){},onDeleteThumbnail:function(){},message:o().createElement(c.A,{msgId:"map.message"}),suggestion:o().createElement(c.A,{msgId:"map.suggestion"}),map:{},thumbnailErrors:[],thumbnailOptions:null});const w=O},267224:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var r=n(273517),o=n.n(r),i=n(8117),a=n(553493),c=n(551783),l=["debounceTime"],u=["fallbackValue"];function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(null,arguments)}function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var y=(0,a.A)("onChange","value")((0,c.A)("placeholder")((function(e){e.debounceTime;var t=d(e,l);return o().createElement(i.MJ,p({},t,{onChange:function(e){return t.onChange(e.target.value)}}))})));const m=function(e){var t,n,i=e.fallbackValue,a=d(e,u),c=s((0,r.useState)(null!==(t=a.value)&&void 0!==t?t:i),2),l=c[0],f=c[1],m=s((0,r.useState)(null!==(n=a.value)&&void 0!==n?n:i),2),b=m[0],v=m[1],g=s((0,r.useState)(0),2),h=g[0],O=g[1],w=(0,r.useRef)(!1),E=(0,r.useRef)();function S(e){var t=!isNaN(parseFloat(e));return t&&void 0!==a.min&&e<a.min?{changed:!0,value:a.min}:t&&void 0!==a.max&&e>a.max?{changed:!0,value:a.max}:{changed:!1,value:t?parseFloat(e):e}}return E.current=l,(0,r.useEffect)((function(){var e;E.current!==a.value&&f(null!==(e=a.value)&&void 0!==e?e:i)}),[a.value]),o().createElement(y,p({},a,{key:h,value:l,onChange:function(e){if(w.current){var t=e,n=!0;if("number"===a.type){var r=S(t).changed;(""===t||r)&&(n=!1)}f(t),n&&a.onChange(t)}},onChangeNoDebounce:v,onBlur:function(){if("number"===a.type)if(""===b)a.onChange(void 0),f(i),O((function(e){return e+1}));else{var e=S(b).value;a.onChange(e),O((function(e){return e+1})),f(e)}w.current=!1},onFocus:function(){w.current=!0}}))}},859797:(e,t,n)=>{"use strict";n.d(t,{A:()=>E});var r=n(273517),o=n.n(r),i=n(605556),a=n.n(i),c=n(415120),l=n(192016),u=n(8117),s=n(551258);function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var p=function(e){var t,n,i=e.text,a=e.placement,c=e.bsStyle,l=e.left,p=e.top,d=e.title,y=e.glyph,m=e.id,b=(0,r.useRef)(),v=(t=(0,r.useState)(!1),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),g=v[0],h=v[1];return o().createElement("span",{className:"mapstore-info-popover",onMouseLeave:function(){return h(!1)}},o().createElement(u.e6,{onMouseEnter:function(){h(!0)},ref:function(e){b.current=e},className:"text-".concat(c),glyph:y}),o().createElement(s.A,{placement:a,show:g,target:function(){return b.current}},o().createElement(u.AM,{id:m,placement:a,positionLeft:l,positionTop:p,title:d},o().createElement("div",{style:{display:"flex"}},i))))};p.propTypes={id:a().string,title:a().string,text:a().string,glyph:a().string,bsStyle:a().string,placement:a().string,left:a().number,top:a().number,trigger:a().oneOfType([a().array,a().bool])},p.defaultProps={id:"",title:"",text:"",placement:"right",left:200,top:50,glyph:"question-sign",bsStyle:"info"};const d=p;var y=n(595535),m=n(421027);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v.apply(null,arguments)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return(t=function(e){var t=function(e){if("object"!=b(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==b(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){var t=e.id,n=e.label,r=e.infoFormat,i=e.availableInfoFormat,a=e.popoverMessage,s=e.disabled,f=e.onInfoFormatChange,p=e.selectProps,b=Object.keys(i).reduce((function(e,t){var n=i[t]===m.iv;return Object.keys(e).map((function(t){return e[t]})).some((function(e){return e===i[t]}))||n?e:h(h({},e),{},O({},t,i[t]))}),{}),g=Object.keys(b).map((function(e){return{value:b[e],label:(0,c.UK)(b[e])||e}})),w=o().createElement(o().Fragment,null,"   ",a&&o().createElement(d,{text:o().createElement(y.A,{msgId:a})}),o().createElement(l.Ay,v({},p,{id:t,value:r,clearable:!1,disabled:s,options:g,onChange:function(e){return f(null==e?void 0:e.value)}})));return n?o().createElement(u.gE,{bsSize:"small"},o().createElement(u.mq,null,n),w):w}w.propTypes={id:a().string,label:a().oneOfType([a().func,a().string,a().object]),availableInfoFormat:a().object,infoFormat:a().string,popoverMessage:a().string,onInfoFormatChange:a().func,disabled:a().bool,selectProps:a().object},w.defaultProps={id:"mapstore-feature-format-selector",availableInfoFormat:(0,c.hm)(),infoFormat:(0,c.yM)(),popoverMessage:"",onInfoFormatChange:function(){},selectProps:{}};const E=w},715275:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var r=n(273517),o=n.n(r),i=n(711520),a=n(8117);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}var l=["show","style","modal","draggable","closeGlyph","closable","onClose","title","header","footer","children"];function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(null,arguments)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return(t=function(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const d=function(e){var t=e.show,n=e.style,r=void 0===n?{}:n,c=e.modal,s=e.draggable,p=void 0!==s&&s,d=e.closeGlyph,y=void 0===d?"1-close":d,m=e.closable,b=void 0===m||m,v=e.onClose,g=void 0===v?function(){}:v,h=e.title,O=e.header,w=e.footer,E=e.children,S=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,l);return t?o().createElement(i.A,u({modal:c,onClickOut:b&&c?function(){return g()}:null,style:f(f({},r),{},{display:t?"block":"none"}),draggable:p},S),o().createElement("span",{role:"header"},h||O||o().createElement("span",null," "),b?o().createElement("button",{onClick:function(){return g()},className:"settings-panel-close close"},o().createElement(a.e6,{glyph:y})):null),o().createElement("span",{role:"body"},E),w?o().createElement("span",{role:"footer"},w):null):null}},876456:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var r=n(273517),o=n.n(r),i=n(917987),a=n(916589),c=["connectDragSource","connectDragPreview","connectDropTarget","isDragging","isOver"];function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(null,arguments)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e,t,n){return(t=function(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p={beginDrag:function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e)}};const d=(0,a.branch)((function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).isDraggable}),(0,a.compose)((0,i.I4)("row",p,(function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging(),draggingItem:t.getItem()||null}})),(0,i.Tl)("row",{drop:function(e,t){var n=t.getItem();n.sortId!==e.sortId&&e.onSort(e.sortId,n.sortId,{id:e.id,containerId:e.containerId},{id:n.id,containerId:n.containerId})}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}})),(function(e){return function(t){var n=t.connectDragSource,r=t.connectDragPreview,i=t.connectDropTarget,a=t.isDragging,l=t.isOver,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,c),f=s.draggingItem&&s.draggingItem.sortId<s.sortId,p=s.draggingItem&&s.draggingItem.containerId===s.containerId,d=p&&a?" ms-dragging":"",y=p&&l?" ms-over":"",m=p&&f?" ms-above":" ms-below";return r(i(o().createElement("div",{className:"ms-dragg".concat(d).concat(y," ").concat(m)},o().createElement("div",null,o().createElement(e,u({},s,{connectDragSource:n,isDragging:a,isOver:l,onDrop:function(e){return e.stopPropagation()}}))))))}})))},382544:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var r=n(273517),o=n.n(r),i=n(916589);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}var c=["onSort","isDraggable","items","containerId"];function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(null,arguments)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return(t=function(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const p=(0,i.compose)((0,i.branch)((function(e){var t=e.isDraggable;return void 0===t||t}),(function(e){return function(t){var n=t.onSort,r=t.isDraggable,i=t.items,a=void 0===i?[]:i,u=t.containerId,f=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,c),p=a.map((function(e,t){return s(s({},e),{},{onSort:n,isDraggable:r,sortId:t,key:e.id||t,containerId:u})}));return o().createElement(e,l({},s(s({},f),{},{isDraggable:r}),{items:p}))}})))},191080:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var r=n(605556),o=n.n(r),i=n(499084),a=n.n(i),c=n(916589),l=n(628017),u=["locale"];function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return(t=function(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const y=function(e){return(0,c.compose)((0,c.getContext)({locale:o().string}),(0,c.mapProps)((function(t){var n=t.locale,r=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,u);return p(p({},r),a()(e).reduce(function(e,t){return function(){var n=arguments.length>1?arguments[1]:void 0;return p(p({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),{},d({},n,e[n]&&(0,l.zH)(t,e[n])))}}(r,n),{}))})))}},531888:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(916589);const o=function(e,t,n){return(0,r.branch)((function(){return!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})[t]}),(0,r.withState)(e,t,n))}},348317:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var r=n(273517),o=n.n(r),i=n(605556),a=n.n(i);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function u(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(u=function(){return!!e})()}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}var y=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){return t=s(t),function(e,t){if(t&&("object"==c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,u()?Reflect.construct(t,n||[],s(e).constructor):t.apply(e,n))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this;return o().createElement("label",{className:"mapstore-switch-btn ".concat(this.props.className)},o().createElement("input",{type:"checkbox",disabled:this.props.disabled,checked:this.props.checked,onChange:function(){return e.props.onChange(!e.props.checked)}}),o().createElement("span",{onClick:function(){return e.props.onClick(!e.props.checked)},className:"m-slider"}))}}])&&l(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o().Component);p(y,"propTypes",{disabled:a().bool,className:a().string,checked:a().bool,onChange:a().func,onClick:a().func}),p(y,"defaultProps",{className:"",checked:!1,onChange:function(){},onClick:function(){}});const m=y},814915:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var r=n(223805),o=n.n(r),i=n(273517),a=n.n(i),c=n(8117),l=n(8571),u=n(164045),s=n(444003);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}var p=["settings","element","tabs","activeTab","width","groups","isLocalizedLayerStylesEnabled","setActiveTab","onUpdateParams","onRetrieveLayerData","realtimeUpdate"];function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(null,arguments)}var y=(0,u.A)(c.CI);const m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.settings,n=e.element,r=void 0===n?{}:n,i=e.tabs,u=void 0===i?[]:i,m=e.activeTab,b=e.width,v=e.groups,g=e.isLocalizedLayerStylesEnabled,h=e.setActiveTab,O=void 0===h?function(){}:h,w=e.onUpdateParams,E=void 0===w?function(){}:w,S=e.onRetrieveLayerData,P=void 0===S?function(){}:S,j=e.realtimeUpdate,T=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,p);return a().createElement(c.fI,{key:"ms-toc-settings-navbar",className:"ms-row-tab"},a().createElement(c.fv,{xs:12},a().createElement(c.so,{bsStyle:"tabs",activeKey:m,justified:!0},u.map((function(e){return a().createElement(y,{key:"ms-tab-settings-"+e.id,tooltip:a().createElement(l.A,{msgId:e.tooltipId}),eventKey:e.id,onClick:function(){return O(e.id)}},a().createElement(c.e6,{glyph:e.glyph}))})))),a().createElement(c.fv,{xs:12},u.filter((function(e){return e.id&&e.id===m})).filter((function(e){return e.Component})).map((function(e){var n,i;return a().createElement(e.Component,d({},T,{key:"ms-tab-settings-body-"+e.id,containerWidth:b,element:r,groups:v,nodeType:t.nodeType,settings:t,retrieveLayerData:P,isLocalizedLayerStylesEnabled:g,projection:null===(n=T.map)||void 0===n?void 0:n.projection,isCesiumActive:(null===(i=T.map)||void 0===i?void 0:i.visualizationMode)===s.Hd._3D,onChange:function(e,t){return o()(e)?E(e,j):E((n={},i=t,(r=function(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}(r=e))in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n),j);var n,r,i}}))}))))}},734068:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var r=n(273517),o=n.n(r),i=n(916589),a=n(814585),c=n(674336);function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onSelect,n=e.selectedNodes,r=e.updateMapEntries,i=void 0===r?function(){}:r,c=e.map;return o().createElement(a.A,{map:c,selectedNodes:n,onSelectNode:t,config:{hideOpacitySlider:!1,showFullTitle:!0,showOpacityTooltip:!0,showTitleTooltip:!0,sortable:!0,visualizationMode:null==c?void 0:c.visualizationMode,layerOptions:{legendOptions:{projection:null==c?void 0:c.projection,mapSize:null==c?void 0:c.size,mapBbox:null==c?void 0:c.bbox,WMSLegendOptions:"forceLabels:on",scaleDependent:!0,legendWidth:12,legendHeight:12},hideLegend:!1}},onChangeMap:function(e){i({layers:null==e?void 0:e.layers,groups:null==e?void 0:e.groups},"replace")}})}const u=(0,i.compose)(c.A)((function(e){return o().createElement(l,e)}))},674336:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(499084),o=n.n(r),i=n(324713),a=n.n(i),c=n(916589),l=n(112585),u=function(e){return"".concat(e.mapId?"maps[".concat(e.mapId,"]"):"map")};const s=(0,c.withHandlers)({changeLayerProperty:function(e){var t=e.onChange,n=void 0===t?function(){}:t,r=e.map,o=void 0===r?{}:r;return function(e,t,r){var i=a()(o.layers||[],{id:e});n("".concat(u(o),".layers[").concat(i,"].").concat(t),r)}},changeLayerPropertyByGroup:function(e){var t=e.onChange,n=void 0===t?function(){}:t,r=e.map,o=void 0===r?{}:r;return function(e,t,r){return o.layers.filter((0,l.lo)(e)).map((function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id;return a()(o.layers||[],{id:e})})).filter((function(e){return e>=0})).map((function(e){return n("".concat(u(o),".layers[").concat(e,"].").concat(t),r)}))}},changeGroupProperty:function(e){var t=e.onChange,n=void 0===t?function(){}:t,r=e.map,i=void 0===r?{}:r;return function(e,t,r){var c,l=i.groups?o()(i.groups):[],s=a()(l,(function(t){return e===t.id})),f=-1===s?l.length:s;"expanded"!==t||null!=l&&null!==(c=l[f])&&void 0!==c&&c.id||n("".concat(u(i),".groups[").concat(f,"].id"),e),n("".concat(u(i),".groups[").concat(f,"].").concat(t),r)}},updateMapEntries:function(e){var t=e.onChange,n=void 0===t?function(){}:t,r=e.map,o=void 0===r?{}:r;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object.keys(e).map((function(r){return n("".concat(u(o),"[").concat(r,"]"),e[r],t)}))}}})},757104:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var r=n(916589),o=n(112585);function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const c=(0,r.compose)((0,r.withStateHandlers)((function(){return{selectedLayers:[],selectedGroups:[]}}),{onNodeSelect:function(e){var t=e.selectedLayers,n=void 0===t?[]:t,r=e.selectedGroups,a=void 0===r?[]:r;return function(e,t,r){var c=(0,o.BL)([].concat(i(n),i(a)),e,r),l="layer"===t?[].concat(i(n),[e]):n,u="group"===t?[].concat(i(a),[e]):a;return{selectedLayers:c.filter((function(e){return l.includes(e)})),selectedGroups:c.filter((function(e){return u.includes(e)}))}}}}),(0,r.withProps)((function(e){var t=e.selectedLayers,n=e.selectedGroups;return{selectedNodes:[].concat(i(t),i(n))}})))},4814:(e,t,n)=>{"use strict";n.d(t,{A:()=>J});var r=n(858156),o=n.n(r),i=n(916589),a=n(112585),c=n(531888),l=n(548951),u=n(304995),s=n(875912),f=n(324713),p=n.n(f),d=n(605556),y=n.n(d),m=n(273517),b=n.n(m),v=n(8117),g=n(192016),h=n(711030),O=n(8571);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,I(r.key),r)}}function S(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(S=function(){return!!e})()}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function T(e,t,n){return(t=I(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){var t=function(e){if("object"!=w(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==w(t)?t:t+""}var C=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return T(e=function(e,t,n){return t=P(t),function(e,t){if(t&&("object"==w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,S()?Reflect.construct(t,n||[],P(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"renderLegend",(function(){return null})),T(e,"renderItemLabel",(function(e){return b().createElement("div",null,b().createElement("div",{key:"item-title"},e.title||e.name),b().createElement("div",null,b().createElement("small",{className:"text-muted",key:"item-key-description"},e.name)))})),T(e,"renderError",(function(){return e.props.element&&e.props.element.capabilities&&e.props.element&&e.props.element.capabilities.error?b().createElement(v.Fc,{bsStyle:"danger"},b().createElement(O.A,{msgId:"layerProperties.styleListLoadError"})):null})),T(e,"updateEntry",(function(t,n){var r=n.target.value;e.props.onChange(t,r)})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this,t=[{label:"Default Style",value:""}].concat((this.props.element.availableStyles||[]).map((function(t){return{label:e.renderItemLabel(t),value:t.name}})));return(this.props.element.style&&this.props.element.availableStyles&&p()(this.props.element.availableStyles,(function(t){return t.name===e.props.element.style})))>=0||!this.props.element.style||t.push({label:this.props.element.style,value:this.props.element.style}),b().createElement(v.xA,{fluid:!0,style:{paddingTop:15,paddingBottom:15}},b().createElement("form",{ref:"style"},b().createElement(g.Ay.Creatable,{key:"styles-dropdown",options:t,isLoading:this.props.element&&this.props.element.capabilitiesLoading,value:this.props.element.style||"",onOpen:function(){!e.props.element||e.props.element.capabilities&&e.props.element.availableStyles||e.props.retrieveLayerData(e.props.element)},promptTextCreator:function(e){return b().createElement(O.A,{msgId:"layerProperties.styleCustom",msgParams:{value:e}})},onChange:function(t){e.updateEntry("style",{target:{value:t&&t.value||""}})}}),b().createElement("br",null),this.renderLegend(),this.renderError(),b().createElement(h.A,{bsStyle:"primary",style:{float:"right"},onClick:function(){return e.props.retrieveLayerData(e.props.element)}},b().createElement(v.e6,{glyph:"refresh"})," ",b().createElement(O.A,{msgId:"layerProperties.stylesRefreshList"})),b().createElement("br",null)))}}])&&E(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(b().Component);T(C,"propTypes",{retrieveLayerData:y().func,onChange:y().func,element:y().object,groups:y().array}),T(C,"defaultProps",{element:{},retrieveLayerData:function(){},onChange:function(){}});const A=C;var k=n(674336);const D=(0,i.withProps)((function(e){var t,n,r,o=e.map;return{nodes:(t=(0,a.u1)(o),n=t.layers,r=void 0===n?{}:n,(0,a.PR)(r.flat||[],r.groups||[]).groups)}}));var M=n(45388),x=n.n(M),R=n(434164),N=n(142974);function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z(e,t,n){return(t=function(e){var t=function(e){if("object"!=L(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=L(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==L(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const W=(0,i.mapPropsStream)((function(e){var t=(0,i.createEventHandler)(),n=t.stream,r=t.handler;return e.pluck("element").distinctUntilChanged((function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id===e.id})).switchMap((function(){return n.switchMap((function(e){return(0,R.aF)(e).map((function(e){return F(F({},(0,N.e9)(e)),{},{capabilitiesLoading:null})})).startWith({capabilitiesLoading:!0})})).catch((function(e){return x().Observable.of({capabilitiesLoading:null,capabilities:{error:"error getting capabilities",details:e},description:null})}))})).startWith({}).combineLatest(e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return F(F({},t),{},{retrieveLayerData:r,element:F(F({},t.element),e)})}))}));var B=n(815425),U=n.n(B);function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}var q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;for(var r in e)null!==e[r]&&"object"===V(e[r])&&(U()(e[r],t)&&n.apply(void 0,[e[r]]),q(e[r],t,n))};const H=(0,i.withProps)((function(e){var t=e.nodes,n=void 0===t?{}:t,r=e.editNode,o={};return r&&q(n,{id:r},(function(e){o=e})),{selectedNode:o}}));function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){Z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Z(e,t,n){return(t=function(e){var t=function(e){if("object"!=G(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==G(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var K=W(A),Y=(0,i.withProps)((function(e){return{tabs:(e.tabs||[{id:"general",titleId:"layerProperties.general",tooltipId:"layerProperties.general",glyph:"wrench",visible:!0,Component:s.A},{id:"display",titleId:"layerProperties.display",tooltipId:"layerProperties.display",glyph:"eye-open",visible:e.settings&&"layers"===e.settings.nodeType,Component:u.A},{id:"style",titleId:"layerProperties.style",tooltipId:"layerProperties.style",glyph:"dropper",visible:e.settings&&"layers"===e.settings.nodeType&&e.element&&"wms"===e.element.type,Component:K}]).filter((function(e){return!!e.visible}))}}));const J=(0,i.compose)(D,H,(0,i.withState)("settings","onUpdateSettings",{}),(0,i.withProps)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.map,n=void 0===t?{}:t,r=e.selectedNode,i=e.settings,c=void 0===i?{}:i;return{element:r,settings:$($({},c),{},{nodeType:r&&r.nodes?"groups":"layers",options:{opacity:c.opacity>=0?c.opacity:r.opacity>=0?r.opacity:1}}),projection:n.projection,mapSize:n.size,mapBbox:n.bbox,groups:o()((0,a.u1)(n),"layers.groups")}})),(0,i.compose)(k.A,(0,i.withHandlers)({onUpdateNode:function(e){var t=e.changeLayerProperty,n=void 0===t?function(){}:t,r=e.changeGroupProperty,o=void 0===r?function(){}:r,i=e.editNode;return function(e,t,r){"layers"===t&&Object.keys(r).map((function(e){return n(i,e,r[e])})),"groups"===t&&Object.keys(r).map((function(e){return o(i,e,r[e])}))}}}),(0,i.withHandlers)({onUpdateParams:function(e){var t=e.settings,n=void 0===t?{}:t,r=e.onUpdateNode,o=void 0===r?function(){}:r;return function(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&o(n.node,n.nodeType,$($({},n.props),e))}}})),l.s$,(0,c.A)("activeTab","setActiveTab","general"),Y)},434164:(e,t,n)=>{"use strict";n.d(t,{Cc:()=>g,aF:()=>v});var r=n(23412),o=n.n(r),i=(n(400912),n(155584)),a=n(45388),c=n(375482),l=n(995531),u=(n(764932),n(112585)),s=n(492312),f=n(584153),p=n(79738);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return(t=function(e){var t=function(e){if("object"!=d(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==d(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}i.default;var v=function(e){return a.Observable.defer((function(){return c.Ay.getCapabilities((0,u.wk)(e))})).let(s.m9).map((function(t){return c.Ay.parseLayerCapabilities(t,e)}))},g=function(e){return function(e){return a.Observable.defer((function(){return l.A.get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.search,r=void 0===n?{}:n,i=e.url,a=o().parse((0,p.t)(r.url||i),!0);return o().format(m(m({},a),{},{search:void 0,query:m(m({},a.query),{},{service:"WMS",version:c.j0,layers:t,outputFormat:"application/json",request:"DescribeLayer"})}))}(e))})).let(s.m9)}(e).map((function(e){var t=e.data,n=void 0===t?{}:t;return n&&n.layerDescriptions[0]})).map((function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).owsURL;return m(m({},e),{},{params:{},search:t?{type:"wfs",url:(0,f.o_)(t)}:void 0})}))}},472857:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ec});var r={};n.r(r),n.d(r,{cleanUpEmptyStoryContainers:()=>ve,closeShareOnGeostoryChangeMode:()=>Ee,editMediaForBackgroundEpic:()=>ye,editWebPageComponent:()=>fe,exportGeostory:()=>Ce,handlePendingGeoStoryChanges:()=>Se,hideCarouselItemsOnUpdateCurrentPage:()=>Oe,importGeostory:()=>Ae,inlineEditorEditMap:()=>we,loadGeostoryEpic:()=>me,loadStoryOnHistoryPop:()=>Te,openMediaEditorForNewMedia:()=>le,openWebPageComponentCreator:()=>se,reloadGeoStoryOnLoginLogout:()=>be,saveGeoStoryResource:()=>pe,scrollOnLoad:()=>je,scrollSideBar:()=>Ie,scrollToContentEpic:()=>de,setFocusOnMapEditing:()=>he,sortContentEpic:()=>ge,urlUpdateOnScroll:()=>Pe});var o=n(273517),i=n.n(o),a=n(811668),c=n(801081),l=n(315371),u=n.n(l),s=n(393149),f=n(276901),p=n(628017),d=n(958722),y=n(958496),m=n(636989),b=n(45388),v=n(400912),g=n.n(v),h=n(611741),O=n.n(h),w=n(185015),E=n.n(w),S=n(269843),P=n.n(S),j=n(823629),T=n.n(j),I=n(466645),C=n.n(I),A=n(858156),k=n.n(A),D=n(956449),M=n.n(D),x=n(962193),R=n.n(x),N=n(980971),L=n(541033),_=n.n(L),F=n(995531),z=n(622795),W=n(415392),B=n(883832),U=n(754364),V=n(501719),q=n(183083),H=n(306364),G=n(233999),X=n(750929),$=n(723630),Z=n(270871);function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}var Y=["status","statusText","data","message"],J=["data","isStatic"];function Q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||ie(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return(t=function(e){var t=function(e){if("object"!=K(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=K(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==K(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function re(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function oe(e){return function(e){if(Array.isArray(e))return ae(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ie(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e,t){if(e){if("string"==typeof e)return ae(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ae(e,t):void 0}}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ce=function(e,t,n){return function(r){return r.ofType(m.pd).switchMap((function(r){var o=r.resource,i=void 0===o?{}:o,a=[],c=e.getState(),l=(0,H.L8)(c),u=(0,H.S0)(c),s=g()((0,q.Zl)(c).filter((function(e){return e.data&&(u!==$.N.GEOSTORY&&e.data.id||e.id)===i.id}))),p=i.id;s?p=s.id:R()(i)?a=[].concat(oe(a),[(0,y.TF)("".concat(t)),(0,m.jD)()]):(p=i.id||_()(),a=[].concat(oe(a),[(0,y.Mt)(p,l,i.data?i.data:i)]));var d=l===f.mI.MAP?{resourceId:p,type:l,map:void 0}:{resourceId:p,type:l},v=[(0,y.yo)("".concat(t),d,"merge")];return n===f.Fq.CAROUSEL&&v.push((0,y.yo)("".concat(t,".map"),{mapInfoControl:!0},"merge")),a=[].concat(oe(a),v,[(0,m.jD)()]),b.Observable.from(a)}))}},le=function(e,t){return e.ofType(y.gj).filter((function(e){var t=e.element,n=void 0===t?{}:t;return n.type===f.Py.MEDIA||(0,f.oo)(n)})).switchMap((function(n){var r=n.path,o=n.element,i="";(0,f.oo)(o)&&"sections"===r&&(i=".contents[0].contents[0]");var a="".concat(r,'[{"id":"').concat(o.id,'"}]').concat(i),c=(0,q.hQ)(t.getState());return b.Observable.of((0,m.WU)("geostory",c)).merge(e.let(ce(t,a)),e.ofType(m.$7).switchMap((function(){return b.Observable.of((0,y.TF)(a))})).takeUntil(e.ofType(y.q6))).takeUntil(e.ofType(m.yP))}))},ue=function(e){return function(t){return t.ofType(y.$c).switchMap((function(t){var n=t.src;return b.Observable.of((0,y.yo)("".concat(e),{src:n,editURL:!1},"merge"))}))}},se=function(e){return e.ofType(y.gj).filter((function(e){var t=e.element,n=void 0===t?{}:t;return n.type===f.Py.WEBPAGE&&!1!==n.editURL||(0,f.Rs)(n)})).switchMap((function(t){var n=t.path,r=t.element,o="";(0,f.Rs)(r)&&"sections"===n&&(o=".contents[0].contents[0]");var i="".concat(n,'[{"id":"').concat(r.id,'"}]').concat(o);return b.Observable.of((0,y.yo)(i,{editURL:!0},"merge")).merge(e.let(ue(i))).takeUntil(e.ofType(y.x9))}))},fe=function(e){return e.ofType(y.x9).switchMap((function(t){var n=t.path;return b.Observable.of((0,y.yo)(n,{editURL:!0},"merge")).merge(e.let(ue(n))).takeUntil(e.ofType(y.gj))}))},pe=function(e){return e.ofType(y.W0).exhaustMap((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.resource,n=e.delay,r=void 0===n?1e3:n;return(t.id?(0,z.Uh)(t):(0,z.Zg)(t)).switchMap((function(e){return b.Observable.of((0,y.v1)(e),(0,y.qI)(f.H2.SHOW_SAVE,!1),t.id?(0,y.Rf)(e):(0,N.VC)("/geostory/".concat(e))).merge(b.Observable.of((0,B.WU)({id:"STORY_SAVE_SUCCESS",title:"saveDialog.saveSuccessTitle",message:"saveDialog.saveSuccessMessage"})).delay(t.id?0:r))})).let((0,G.TC)((0,y.tk)(!0,"loading"),(0,y.tk)(!1,"loading"))).catch((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.status,n=e.statusText,r=e.data,o=e.message,i=re(e,Y);return b.Observable.of((0,y.A7)(t?{status:t,statusText:n,data:r}:o||i),(0,y.tk)(!1,"loading"))}))}))},de=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState,n=void 0===t?function(){}:t;return e.ofType(y.gj).switchMap((function(e){var t=e.path,r=e.element;return b.Observable.of(r).switchMap((function(){if(document.getElementById(r.id)){var e=(0,f.py)(t).sectionId,o=(0,q.NZ)(e)(n())?e:r.id;return(0,f.oS)(o,{behavior:"auto",block:"center"}),b.Observable.empty()}throw new Error("Item not mounted yet")})).retryWhen((function(e){return e.delay(200).take(10)}))}))},ye=function(e,t){return e.ofType(m.yP).switchMap((function(n){var r=n.path,o=n.owner,i=n.sectionType,a=(0,q.n0)(r)(t.getState()),c=(0,q.EN)(a)(t.getState());return b.Observable.of((0,H.L8)(t.getState())).filter((function(e){return c&&c.type!==e})).map((function(){return(0,m.FK)(c.type)})).merge(b.Observable.of((0,m.WU)(o,(0,q.hQ)(t.getState())),(0,m.mL)(a),(0,m.NO)(i===f.Fq.CAROUSEL?["image","video"]:[])).merge(e.let(ce(t,r,i)).takeUntil(e.ofType(m.$7,y.gj))))}))},me=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.GC).switchMap((function(e){var t=e.id;return b.Observable.defer((function(){return t&&O()(parseInt(t,10))?F.A.get("configs/".concat(t,".json")).then((function(e){var t=e.data,n=t.sections,r=M()(n)&&n.map((function(e){return te(te({},e),{},{id:_()()})}));return{data:r.length?te(te({},t),{},{sections:r}):t,isStatic:!0,canCopy:!0}})):(0,z.hZ)(t)})).do((function(e){if(!e.data)throw Error("Wrong data format");return!0})).switchMap((function(e){var n=e.data,o=e.isStatic,i=void 0!==o&&o,a=re(e,J),c=r(),l=(0,V.Cv)(c),u=(0,V.M3)(c),s=E()(n)?JSON.parse(n):n;if(!u&&O()(parseInt(t,10)))return b.Observable.of((0,y.Xq)({status:403}));var p=(0,q.XU)(c)===f.dX.EDIT;return b.Observable.from([].concat(oe(i||p?[(0,y.Df)(a&&(a.canEdit||a.canCopy)||l)]:[]),[(0,y.Q4)(t),(0,y.B)(s),(0,y.Hc)(a)]))})).let((0,G.TC)((0,y.tk)(!0,"loading"),(0,y.tk)(!1,"loading"),(function(e){var t=(0,f.MW)(),n=t+".errors.loading.unknownError";return 403===e.status?(n=t+".errors.loading.pleaseLogin",((0,V.M3)(r())||(0,q.HR)(r()))&&(n=t+".errors.loading.geostoryNotAccessible")):404===e.status?n=t+".errors.loading.geostoryDoesNotExist":P()(e.status)&&(n=e.message),b.Observable.of((0,B.z3)({title:t+".errors.loading.title",message:n}),(0,y.B)({}),(0,y.Xq)(te(te({},e),{},{messageId:n})))}))).startWith((0,y.B)({}))}))},be=function(e){return e.ofType(y.GC).switchMap((function(t){var n=t.id;return e.ofType(U._x,U.T_).switchMap((function(){return b.Observable.of((0,y.Rf)(n)).delay(500)})).takeUntil(e.ofType(N.LK))}))},ve=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.t2).switchMap((function(e){var t=e.path,n=(0,f.DS)(t,(0,q.E_)(r())),o=T()(n,"contents");if(o>0){var i=n.splice(0,o),a=(0,q.Hy)(i.join("."))(r());if(a&&a.contents&&0===a.contents.length)return b.Observable.of((0,y.TF)(i.join(".")))}return b.Observable.empty()}))},ge=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.i2).switchMap((function(e){var t=e.source,n=e.target,o=e.position,i=r(),a=(0,q.Hy)(t)(i);return b.Observable.from([(0,y.TF)(t),(0,y.WQ)(n,o,a)])}))},he=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.q6).filter((function(e){var t=e.path;return(void 0===t?"":t).endsWith("editMap")})).switchMap((function(e){var t=e.path,n=e.element,o=(0,f.zk)(t,(0,q.E_)(r())),i=o.flatPath,a=o.path,c=1===i.length,l=c?i[0]:i.pop(),u=c?i[0]:i.shift(),s="background"===a[a.length-2],p=s&&"#".concat(u.id," .ms-section-background-container")||"#".concat(l.id);return(0,f.oS)(l.id),b.Observable.from([(0,y.pO)(n,l,p,s,t.replace(".editMap",""))])}))},Oe=function(e,t){var n=t.getState;return e.ofType(y.q6).filter((function(e){var t=e.path,n=e.element;return t&&t.endsWith("carouselToggle")&&n})).switchMap((function(e){var t=e.path,r=(0,f.py)(t)||{},o=r.sectionId,i=r.contentId,a=(0,q.Ig)(o)(n())||[];return i&&!R()(a)?b.Observable.from([(0,y.r5)(o,i)]).concat(b.Observable.of((0,y.yo)(t,!1))):b.Observable.empty()}))},we=function(e,t){var n=t.getState;return e.ofType(Z._O).filter((function(e){var t=e.owner,n=e.map;return"inlineEditor"===t&&!!n})).switchMap((function(){return e.ofType(Z.W0).switchMap((function(t){var r=t.map,o=(0,q.Uj)(n()).path;return b.Observable.of((0,y.yo)("".concat(o,".map"),r,"merge"),(0,y.yo)("".concat(o,".editMap"),!1),(0,Z.jD)()).takeUntil(e.ofType(Z.$7))}))}))},Ee=function(e){return e.ofType(y.jn).switchMap((function(){return b.Observable.of((0,W.fN)("share","enabled",!1))}))},Se=function(e){return b.Observable.merge(e.ofType(y.GC).switchMap((function(){return e.ofType(y.sb)}))).switchMap((function(){return e.ofType(y.gj,y.q6,y.t2,y.J4,y.oS,y.vG).take(1).switchMap((function(){return b.Observable.of((0,y.p1)(!0)).concat(e.ofType(y.MX,N.LK,U.T_).filter((function(e){var t;return!(e.type===N.LK&&"REPLACE"===(null==e||null===(t=e.payload)||void 0===t?void 0:t.action))})).take(1).switchMap((function(){return b.Observable.of((0,y.p1)(!1))})))}))}))},Pe=function(e,t){var n=t.getState;return e.ofType(y.Ck).let(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e};return function(r){return r.withLatestFrom(e.startWith(t)).filter((function(e){var t=Q(e,2)[1];return n(t)})).map((function(e){return Q(e,1)[0]}))}}(e.ofType(y.lp).map((function(e){return!e.status})).startWith(!0))).debounceTime(50).switchMap((function(e){var t=e.sectionId,r=e.columnId;if("edit"!==(0,q.XU)(n())&&(r||t)&&(0,q.kT)(n())){var o,i=k()(n(),"geostory.resource.id"),a=(0,f.xi)(window.location.href,null===(o=window)||void 0===o||null===(o=o.location)||void 0===o?void 0:o.hash,i,t,r);a&&history.pushState(null,"",a)}return b.Observable.empty()}))},je=function(e){return e.ofType(y.RJ).switchMap((function(e){var t,n=e.delay,r=void 0===n?2e3:n,o=null===(t=window)||void 0===t||null===(t=t.location)||void 0===t||null===(t=t.hash)||void 0===t?void 0:t.split("/");return b.Observable.of(o).do((function(){var e;null!==(e=window)&&void 0!==e&&null!==(e=e.location)&&void 0!==e&&null!==(e=e.hash)&&void 0!==e&&e.includes("shared")?(0,f.oS)(o[7]||o[5],{block:"start",behavior:"auto"}):o.length>5?(0,f.oS)(o[6],{block:"start",behavior:"auto"}):5===o.length&&(0,f.oS)(o[4],{block:"start",behavior:"auto"})})).ignoreElements().startWith((0,y.u3)(!0)).concat(b.Observable.of((0,y.u3)(!1)).delay(r))}))},Te=function(e){return e.ofType(N.LK).switchMap((function(e){var t,n=e.payload;if((null==n||null===(t=n.location)||void 0===t?void 0:t.pathname.includes("/geostory/"))&&"POP"===n.action&&!n.isFirstRendering){var r,o=C()(null==n||null===(r=n.location)||void 0===r?void 0:r.pathname);return o.find((function(e){return"shared"===e}))?b.Observable.of((0,y.Rf)(o[2])).delay(500):b.Observable.of((0,y.Rf)(o[1])).delay(500)}return b.Observable.empty()}))},Ie=function(e,t){var n=t.getState;return e.ofType(y.Ck).filter((function(e){var t=e.columnId,r=e.sectionId;return!("edit"!==(0,q.XU)(n())||!t&&!r)})).debounceTime(50).switchMap((function(){return b.Observable.of(Array.from(document.querySelectorAll(".ms-geostory-builder .mapstore-side-card.ms-highlight")).pop()).filter((function(e){return!!e})).withLatestFrom(b.Observable.of(document.querySelector(".ms-geostory-builder .ms2-border-layout-body")).filter((function(e){return!!e}))).map((function(e){var t=Q(e,2),n=t[0],r=t[1];return function(){var e=n.getBoundingClientRect(),t=e.top,o=e.bottom,i=r.getBoundingClientRect(),a=i.top,c=i.bottom;t<a?r.scrollBy({top:t-a-10,behavior:"smooth"}):o>c&&r.scrollBy({top:o-c+10,behavior:"smooth"})}})).do((function(e){return window.requestAnimationFrame(e)})).ignoreElements()}))},Ce=function(e){return e.ofType(y.K5).switchMap((function(e){var t=e.data,n=e.fileName;return b.Observable.of([JSON.stringify(te({},t)),n,"application/json"]).do((function(e){return X.RG.apply(void 0,oe(e))})).map((function(){return(0,y.qI)("export",!1)}))}))},Ae=function(e){return e.ofType(y.Jc).switchMap((function(e){var t=e.file;return b.Observable.defer((function(){return(0,X.Vh)(t[0]).then((function(e){return e}))})).switchMap((function(e){return b.Observable.of((0,y.B)(e),(0,y.qI)("import",!1))})).catch((function(e){return b.Observable.of((0,B.z3)({title:"dashboard.errors.loading.title"}),(0,y.Xq)(te({},e)))}))}))},ke=n(286447),De=n(537920),Me=n(154150),xe=n(993456),Re=n(916589),Ne=n(245528);function Le(e){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le(e)}function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){ze(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ze(e,t,n){return(t=function(e){var t=function(e){if("object"!=Le(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Le(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function We(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}(0,Re.setObservableConfig)(Ne.A);var Be=(0,Re.compose)((0,Re.mapPropsStream)((function(e){var t=(0,Re.createEventHandler)(),n=t.handler,r=t.stream,o="EMPTY",i="EMPTY";return b.Observable.combineLatest(e,r.filter((function(e){var t=e.columnId,n=e.sectionId;return t&&o!==t?(o=t,!0):!(!n||i===n||(i=n,0))})).withLatestFrom(e.pluck("updateCurrentPage")).do((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return We(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?We(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];return i&&i(o)})).ignoreElements().startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Fe(Fe({},t.reduce((function(){var e=arguments.length>1?arguments[1]:void 0;return Fe(Fe({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),e)}),{})),{},{updateCurrentPage:n})}))}))),Ue=n(563864),Ve=n(136533),qe=n.n(Ve);function He(e){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},He(e)}function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach((function(t){$e(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $e(e,t,n){return(t=function(e){var t=function(e){if("object"!=He(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=He(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==He(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(0,Re.setObservableConfig)(Ne.A);const Ze=(0,Re.compose)((0,Re.mapPropsStream)((function(e){var t=(0,Re.createEventHandler)(),n=t.handler,r=t.stream;return b.Observable.combineLatest(e,function(e,t){return t.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{interceptorTime:e.interceptorTime,updateCurrentPage:e.updateCurrentPage}})).distinctUntilKeyChanged("interceptorTime").switchMap((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.interceptorTime,r=void 0===n?100:n,o=t.updateCurrentPage;return e.scan((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.visible,o=t.entry;return Xe(Xe({},e),{},$e({},n,{visible:r,entry:o}))}),{}).debounceTime(r).map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return qe()(Object.keys(e),(function(t){return e[t].visible?k()(e[t],"entry.boundingClientRect.top"):1/0}))})).do((function(e){o&&o({sectionId:e})})).ignoreElements()}))}(r,e).startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Xe(Xe({},t.reduce((function(){var e=arguments.length>1?arguments[1]:void 0;return Xe(Xe({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),e)}),{})),{},{onVisibilityChange:n})}))})));var Ke=n(605556),Ye=n.n(Ke),Je=n(432060),Qe=n(920327),et=n(715275),tt=n(8117),nt=n(711030),rt=n(8571),ot=n(406250),it=(0,Re.branch)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.viewHeight,o=e.size;return!n||!r||!o}),(0,Ue.A)((function(){return!0}),(function(){return{glyph:"code"}})));const at=(0,Re.compose)(it)((function(e){var t=e.src,n=e.size,r=e.viewHeight;return i().createElement("div",{className:"ms-webpage-wrapper"},i().createElement("iframe",{src:t,height:"".concat((0,f.ED)(n,r),"px")}))}));var ct=n(79738),lt=n(832838),ut=n(738221),st=n.n(ut);function ft(e){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ft(e)}function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){yt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yt(e,t,n){return(t=function(e){var t=function(e){if("object"!=ft(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ft(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ft(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var bt=function(e){var t,n,r=e.id,a=e.onLoad,c=e.loading,l=e.debounceTime,u=e.children,s=e.loaderComponent,f=e.loaderStyle,p=(t=(0,lt.Wx)(),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return mt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mt(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=p[0],y=p[1],m=(0,o.useRef)(null),b=s;return(0,o.useEffect)((function(){return m.current=st()((function(e){a(e)}),l),function(){m.current.cancel()}}),[]),(0,o.useEffect)((function(){y&&c&&m.current(r),!y&&c&&m.current.cancel()}),[y,c,r]),i().createElement("div",{ref:d,className:"ms-visibility-container"},c?b?i().createElement(b,{style:dt({},f)}):null:(0,o.cloneElement)(u,{inView:y}))};bt.propTypes={id:Ye().string,debounceTime:Ye().number,loading:Ye().bool,onLoad:Ye().func,loaderComponent:Ye().oneOfType([Ye().element,Ye().func])},bt.defaultProps={id:"",debounceTime:300,loading:!0,onLoad:function(){},loaderComponent:null};const vt=bt;var gt=n(275705);function ht(e){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(e)}function Ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,jt(r.key),r)}}function wt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(wt=function(){return!!e})()}function Et(e){return Et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Et(e)}function St(e,t){return St=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},St(e,t)}function Pt(e,t,n){return(t=jt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jt(e){var t=function(e){if("object"!=ht(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ht(t)?t:t+""}var Tt=function(){return i().createElement("div",{className:"ms-media-loader"},i().createElement(gt.A,{size:52}))},It=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Pt(e=function(e,t,n){return t=Et(t),function(e,t){if(t&&("object"==ht(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,wt()?Reflect.construct(t,n||[],Et(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"state",{url:e.props.src||"",error:!1,loading:!0}),Pt(e,"updateURL",(function(t){var n=t.target.value;e.setState({url:n})})),Pt(e,"save",(function(){var t=e.state.url,n=!(0,ct.Gz)(t);e.setState({error:n}),n||e.props.onChange(t)})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&St(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.editURL,o=this.state,a=o.url,c=o.error;return i().createElement(i().Fragment,null,i().createElement(ot.A,null,i().createElement(et.A,{modal:!0,show:r,onClickOut:function(e){return e.preventDefault()&&e.stopPropagation()},title:i().createElement(rt.A,{msgId:"geostory.webPageCreator.title"}),onClose:n,id:"web-page-creator",footer:i().createElement(nt.A,{bsSize:"small",onClick:this.save},i().createElement(rt.A,{msgId:"geostory.webPageCreator.saveButton"}))},c&&i().createElement("div",{className:"dropzone-errorBox alert-danger"},i().createElement(rt.A,{msgId:"geostory.webPageCreator.error"})),i().createElement(tt.gE,{controlId:"WEBPAGE_URL",validationState:c&&"error"},i().createElement(tt.mq,null,i().createElement(rt.A,{msgId:"geostory.webPageCreator.url.label"})),i().createElement(tt.MJ,{label:"URL",type:"text",value:a,onChange:this.updateURL,required:!0})))),this.props.lazy?i().createElement(vt,{key:this.props.id,id:this.props.id,debounceTime:this.props.debounceTime,loading:this.state.loading,onLoad:function(){return e.setState({loading:!1})},loaderComponent:Tt},i().createElement(at,this.props)):i().createElement(at,this.props))}}],r&&Ot(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().PureComponent);Pt(It,"propTypes",{editURL:Ye().bool,onClose:Ye().func,onChange:Ye().func,src:Ye().string,id:Ye().string,debounceTime:Ye().number,lazy:Ye().bool}),Pt(It,"defaultProps",{lazy:!0});var Ct=(0,Re.compose)((0,Re.withHandlers)({onClose:function(e){var t=e.update,n=void 0===t?function(){}:t;return function(){return n("editURL",!1,"merge")}}}))(It);const At=(0,a.connect)(null,{onChange:y.vL})(Ct);var kt=["type"];function Dt(){return Dt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Dt.apply(null,arguments)}var Mt=(0,Je.A)()((0,o.lazy)((function(){return Promise.all([n.e(50953),n.e(15096),n.e(95451),n.e(95232)]).then(n.bind(n,795232))}))),xt=function(e){var t=e.type;return i().createElement("div",{className:"ms-content ms-content-unknown"},'warning: unknown content type "'.concat(t,'"'))};const Rt=function(e){var t=e.type,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,kt),r=function(e){switch(e){case f.Py.TEXT:return Mt;case f.Py.MEDIA:case f.mI.IMAGE:case f.mI.MAP:case f.mI.VIDEO:return Qe.Ay;case f.Py.WEBPAGE:return At;default:return xt}}(t);return i().createElement(r,Dt({type:t},n))};var Nt=n(596006),Lt=n(256951),_t=["onClick"];function Ft(e){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ft(e)}function zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(n),!0).forEach((function(t){Ht(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Gt(r.key),r)}}function Ut(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ut=function(){return!!e})()}function Vt(e){return Vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vt(e)}function qt(e,t){return qt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qt(e,t)}function Ht(e,t,n){return(t=Gt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gt(e){var t=function(e){if("object"!=Ft(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ft(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ft(t)?t:t+""}var Xt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){return t=Vt(t),function(e,t){if(t&&("object"==Ft(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ut()?Reflect.construct(t,n||[],Vt(e).constructor):t.apply(e,n))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qt(e,t)}(t,e),n=t,r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){!this.trigger||e.containerWidth===this.props.containerWidth&&e.containerHeight===this.props.containerHeight||this.trigger.hide()}},{key:"render",value:function(){var e=this;return i().createElement(Nt.A,{className:"add-bar",popoverClassName:"add-bar-popover",content:i().createElement(Lt.A,{btnDefaultProps:{className:"square-button btn-tray"},buttons:this.props.buttons.map((function(t){var n=t.onClick,r=void 0===n?function(){}:n;return Wt(Wt({},function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,_t)),{},{onClick:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];r.apply(void 0,n),e.trigger.hide(),n[0]&&n[0].preventDefault&&n[0].preventDefault()}})}))}),ref:function(t){t&&(e.trigger=t.trigger)},placement:"top"},i().createElement(nt.A,{className:this.props.addButtonClassName},i().createElement(tt.e6,{glyph:"plus"})))}}],r&&Bt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);Ht(Xt,"propTypes",{id:Ye().string,type:Ye().string,buttons:Ye().array,containerWidth:Ye().oneOfType([Ye().number,Ye().string]),containerHeight:Ye().oneOfType([Ye().number,Ye().string]),addButtonClassName:Ye().string}),Ht(Xt,"defaultProps",{id:"",type:"",buttons:[],containerWidth:0,containerHeight:0,addButtonClassName:""});const $t=Xt;function Zt(e){return Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zt(e)}var Kt=["id"];function Yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(n),!0).forEach((function(t){en(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function en(e,t,n){return(t=function(e){var t=function(e){if("object"!=Zt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Zt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Zt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tn(){return tn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tn.apply(null,arguments)}const nn=function(e){var t=e.viewWidth,n=e.viewHeight,r=e.className,o=e.contentProps,a=void 0===o?{}:o,c=e.addButtons,l=void 0===c?[]:c,u=e.tools,s=void 0===u?[]:u,p=e.contents,d=void 0===p?[]:p,y=e.ContentComponent,m=void 0===y?Rt:y,b=e.mode,v=e.sectionType,g=e.editMedia,h=void 0===g?function(){}:g,O=e.editWebPage,w=void 0===O?function(){}:O,E=e.add,S=void 0===E?function(){}:E,P=e.update,j=void 0===P?function(){}:P,T=e.remove,I=void 0===T?function(){}:T,C=e.bubblingTextEditing,A=void 0===C?function(){}:C,k=e.storyTheme,D=e.sections,M=void 0===D?[]:D,x=e.storyFonts,R=e.innerRef;return i().createElement("div",{ref:R,className:r},d.reduce((function(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1?arguments[1]:void 0,c=o.id,u=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(o,Kt),p=[i().createElement(m,tn({id:c,key:"".concat(c,"-content"),mode:b,viewWidth:t,sectionType:v,viewHeight:n,editMedia:function(e){for(var t=e.path,n=void 0===t?"":t,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return h.apply(void 0,[{path:'contents[{"id": "'.concat(c,'"}]')+n}].concat(o))},editWebPage:function(e){for(var t=e.path,n=void 0===t?"":t,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return w.apply(void 0,[{path:'contents[{"id": "'.concat(c,'"}]')+n}].concat(o))},add:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return S.apply(void 0,['contents[{"id": "'.concat(c,'"}].')+e].concat(n))},update:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return j.apply(void 0,['contents[{"id": "'.concat(c,'"}].')+e].concat(n))},remove:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return I.apply(void 0,['contents[{"id": "'.concat(c,'"}]')+(e?"."+e:"")].concat(n))}},a,u,{storyTheme:k,storyFonts:x,bubblingTextEditing:A,tools:s&&s[u.type],sections:M}))];return b===f.dX.EDIT&&l.length>0&&p.push(i().createElement($t,{key:"".concat(c,"-content-add-buttons"),containerWidth:t,containerHeight:n,buttons:l.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Qt(Qt({},e),{},{onClick:function(){return S("contents",c,e.template)}})}))})),[].concat(function(e){if(Array.isArray(e))return Yt(e)}(e=r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Yt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),p)}),[]))};n(695127);var rn=["onVisibilityChange","rootSelector"],on=["intersectionObserverOptions","onVisibilityChange"];function an(){return an=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},an.apply(null,arguments)}function cn(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const ln=function(e){return(0,Re.compose)((0,Re.withHandlers)({onVisibilityChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.onVisibilityChange,r=void 0===n?function(){}:n;return function(e,n){return r({id:t,visible:e,entry:n})}}}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onVisibilityChange,n=(e.rootSelector,cn(e,rn));return function(e){return function(r){var o=r.intersectionObserverOptions,a=void 0===o?{}:o,c=r.onVisibilityChange,l=cn(r,on),u=t||c;return i().createElement(lt.pL,an({},n,a,{onChange:u}),(function(t){var n=t.inView,r=t.ref,o=t.entry;return i().createElement(e,an({},l,{inView:n,inViewRef:r,inViewEntry:o}))}))}}}(e))};var un=n(629559),sn=n(881137),fn=n(907309),pn=n.n(fn),dn=n(501882),yn=n.n(dn),mn=n(302404),bn=n.n(mn);function vn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return gn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var hn=(0,sn.A)(tt.gf);function On(e){var t=e.value,n=e.options,r=void 0===n?[]:n,a=e.onSelect,c=void 0===a?function(){}:a,l=e.glyph,u=void 0===l?"":l,s=e.tooltipId,f=e.pullRight,p=void 0!==f&&f,d=e.className,y=void 0===d?"square-button-md no-border":d,m=e.disabled,b=e.noTooltipWhenDisabled,v=void 0!==b&&b,g=e.hideMenuItem,h=void 0===g?function(){return!1}:g,O=e.shouldClose,w=e.showSelectionInTitle,E=void 0===w||w,S=vn((0,o.useState)(!1),2),j=S[0],T=S[1],I=vn((0,o.useState)(!1),2),C=I[0],A=I[1],k=(pn()(r,(function(e){return bn()(e.value,t)}))||{}).glyph;return(0,o.useEffect)((function(){m&&T(!1)}),[m]),i().createElement(hn,{noCaret:!0,open:j,noTooltipWhenDisabled:v,tooltipId:s,pullRight:p,className:y,disabled:m,title:i().createElement(tt.e6,{glyph:E&&k||u}),onToggle:function(e,n,r){return C||"select"===(null==r?void 0:r.source)||O&&!O(t,n)?null:T(e)}},r.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(null==e?void 0:e.Component)||tt.Dr;return h(t,e)?null:i().createElement(n,{key:e.value,selected:t,value:e.value,active:yn()(null==e?void 0:e.isActive)&&e.isActive(t)||!P()(t)&&t===e.value,onClick:null!=e&&e.Component?c:function(){return c(e.value)},onActive:function(e){return A(e)}},e.label)})))}var wn=n(694838),En=n(276318),Sn=n(223805),Pn=n.n(Sn);function jn(e){return jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jn(e)}function Tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function In(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tn(Object(n),!0).forEach((function(t){Cn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Cn(e,t,n){return(t=function(e){var t=function(e){if("object"!=jn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=jn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==jn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function An(){return An=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},An.apply(null,arguments)}function kn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Dn=(0,wn.A)(un.A),Mn={primary:"btn-primary",default:"btn-default"},xn=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.align,o=e.sectionType,a=e.size,c=e.update,l=void 0===c?function(){}:c,u=e.filterOptions,s=e.pullRight,f=e.sizeType,p=function(e,t){var n,r,o="horizontal",i="",a=(n=e&&e.split(",")||[],r=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(n,r)||function(e,t){if(e){if("string"==typeof e)return kn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kn(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=a[0],l=a[1],u=e,s="resize-horizontal";return t===o?(i="h-",u=c):"vertical"===t&&(i="v-",u=l,s="resize-vertical"),{sizeProp:function(e){return t?"".concat(t===o?e:c,",").concat("vertical"===t?e:l):e},pre:i,_size:u,glyph:s}}(a,f),d=p.pre,y=p._size,m=p.glyph,b=p.sizeProp;return i().createElement(On,An({value:y,noTooltipWhenDisabled:!0,disabled:n,glyph:m,pullRight:s||("right"===r||y==="".concat(d,"full")||y==="".concat(d,"large"))&&!o,tooltipId:"geostory.contentToolbar.contentSize",options:[{value:"".concat(d,"small"),glyph:"size-small",label:i().createElement(rt.A,{msgId:"geostory.contentToolbar.smallSizeLabel"})},{value:"".concat(d,"medium"),glyph:"size-medium",label:i().createElement(rt.A,{msgId:"geostory.contentToolbar.mediumSizeLabel"})},{value:"".concat(d,"large"),glyph:"size-large",label:i().createElement(rt.A,{msgId:"geostory.contentToolbar.largeSizeLabel"})},{value:"".concat(d,"full"),glyph:"size-extra-large",label:i().createElement(rt.A,{msgId:"geostory.contentToolbar.fullSizeLabel"})}].filter((function(e){return!u||u(e)})),onSelect:function(e){return l("size",b(e))}},f&&{showSelectionInTitle:!1}))},Rn=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.align,o=e.sectionType,a=e.size,c=e.update,l=void 0===c?function(){}:c;return i().createElement(On,{value:r,noTooltipWhenDisabled:!0,disabled:"full"===a||n,glyph:"align-center",pullRight:("right"===r||"full"===a||"large"===a)&&!o,tooltipId:"geostory.contentToolbar.contentAlign",options:[{value:"left",label:i().createElement(rt.A,{msgId:"geostory.contentToolbar.leftAlignLabel"}),glyph:"align-left"},{value:"center",label:i().createElement(rt.A,{msgId:"geostory.contentToolbar.centerAlignLabel"}),glyph:"align-center"},{value:"right",label:i().createElement(rt.A,{msgId:"geostory.contentToolbar.rightAlignLabel"}),glyph:"align-right"}],onSelect:function(e){return l("align",e)}})},Nn=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.theme,o=e.storyTheme,a=e.align,c=e.sectionType,l=e.update,u=void 0===l?function(){}:l,s=e.themeProps,f=e.size;return i().createElement(On,{value:r,noTooltipWhenDisabled:!0,pullRight:("right"===a||"full"===f||"large"===f)&&!c,glyph:"dropper",tooltipId:"geostory.contentToolbar.contentTheme",disabled:n,shouldClose:function(e,t){var n,r;return Pn()(e)&&"ms-color-picker-cover"!==(null==t||null===(n=t.target)||void 0===n||null===(r=n.getAttribute)||void 0===r?void 0:r.call(n,"class"))||E()(e)||void 0===e},hideMenuItem:function(e,t){return"custom"===(null==e?void 0:e.value)&&"custom"!==(null==t?void 0:t.value)},options:[{value:"",isActive:function(e){return void 0===e||""===e||Pn()(e)&&(void 0===e.value||""===e.value)},label:i().createElement(rt.A,{msgId:"geostory.contentToolbar.defaultThemeLabel"})},{value:"bright",isActive:function(e){return"bright"===(null==e?void 0:e.value)||"bright"===e},label:i().createElement(rt.A,{msgId:"geostory.contentToolbar.brightThemeLabel"})},{value:"dark",isActive:function(e){return"dark"===(null==e?void 0:e.value)||"dark"===e},label:i().createElement(rt.A,{msgId:"geostory.contentToolbar.darkThemeLabel"})},{value:"custom",Component:function(e){return i().createElement(En.v,An({},e,{disableBackgroundAlpha:null==s?void 0:s.disableBackgroundAlpha,disableShadow:null==s?void 0:s.disableShadow,disableTextColor:null==s?void 0:s.disableTextColor,onUpdate:u,storyTheme:o}))}}],onSelect:function(e){return u("theme",In(In({},Pn()(r)&&r),{},{value:e}))}})},Ln=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.forceDelBtnDisable,o=void 0!==r&&r,a=e.path,c=e.remove,l=void 0===c?function(){}:c,u=e.bsStyle;return i().createElement(Dn,{glyph:"trash",visible:!0,noTooltipWhenDisabled:!0,disabled:n||o,className:"".concat("square-button-md no-border"," ").concat(u&&Mn[u]),tooltipId:"geostory.contentToolbar.remove",confirmTitle:i().createElement(rt.A,{msgId:"geostory.contentToolbar.removeConfirmTitle"}),confirmContent:i().createElement(rt.A,{msgId:"geostory.contentToolbar.removeConfirmContent"}),onClick:function(){l(a)}})},_n=n(668414),Fn=n.n(_n);function zn(e){return zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zn(e)}var Wn=["editMap","map","update"],Bn=["tools","children"];function Un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Un(Object(n),!0).forEach((function(t){qn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Un(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qn(e,t,n){return(t=function(e){var t=function(e){if("object"!=zn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=zn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==zn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hn(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Gn={size:function(e){return{renderButton:i().createElement(xn,e)}},align:function(e){return{renderButton:i().createElement(Rn,e)}},theme:function(e){return{renderButton:i().createElement(Nn,e)}},fit:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.fit,o=e.update,i=void 0===o?function(){}:o;return{value:r,glyph:"contain"===r?"fit-cover":"fit-contain",disabled:n,visible:!0,tooltipId:"contain"===r?"geostory.contentToolbar.cover":"geostory.contentToolbar.fit",onClick:function(){return i("fit","contain"===r?"cover":"contain")}}},cover:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.cover,o=e.updateSection,i=void 0===o?function(){}:o;return{value:r,glyph:r?"height-auto":"height-view",visible:!0,disabled:n,tooltipId:r?"geostory.contentToolbar.contentHeightAuto":"geostory.contentToolbar.contentHeightView",onClick:function(){return i({cover:!r},"merge")}}},editMedia:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.path,o=e.editMedia,i=void 0===o?function(){}:o,a=e.sectionType;return{glyph:"pencil","data-button":"pencil",visible:!0,disabled:n,tooltipId:"geostory.contentToolbar.editMedia",onClick:function(){i({path:r},r?a:"")}}},remove:function(e){return{renderButton:i().createElement(Ln,e)}},editMap:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.map,o=e.update,i=void 0===o?function(){}:o,a=Hn(e,Wn);return{glyph:"map-edit",visible:!0,disabled:n,bsStyle:n?"success":"default",tooltipId:"geostory.contentToolbar.editMap",onClick:function(){var e=null!=r?r:a,t=e.center,o=e.zoom,c=e.resolution;i("editMap",!n),!n&&i("map",{center:t,zoom:o,mapStateSource:Fn()(),resolution:c,resetPanAndZoom:!1},"merge")}}},editURL:function(e){var t=e.editURL,n=void 0!==t&&t,r=e.path,o=e.editWebPage,i=void 0===o?function(){}:o;return{glyph:"pencil",visible:!0,disabled:n,bsStyle:n?"success":"default",tooltipId:"geostory.contentToolbar.editURL",onClick:function(){i({path:r})}}},muted:function(e){var t=e.update,n=e.muted;return{glyph:n?"muted":"audio",visible:!0,active:!n,tooltipId:n?"geostory.contentToolbar.enableAudio":"geostory.contentToolbar.disableAudio",onClick:function(){t("muted",!n)}}},autoplay:function(e){var t=e.update,n=e.autoplay;return{glyph:"play-circle",visible:!("cover"===e.fit),active:n,tooltipId:n?"geostory.contentToolbar.disableAutoplay":"geostory.contentToolbar.enableAutoplay",onClick:function(){t("autoplay",!n)}}},loop:function(e){var t=e.update,n=e.loop;return{glyph:"loop",visible:!("cover"===e.fit),active:n,tooltipId:n?"geostory.contentToolbar.disableLoop":"geostory.contentToolbar.enableLoop",onClick:function(){t("loop",!n)}}},showCaption:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.update,o=e.showCaption,i=e.caption,a=e.description;return{glyph:"caption",visible:!(!i&&!a),disabled:n,active:!(!o||n),tooltipId:o?"geostory.contentToolbar.hideCaption":"geostory.contentToolbar.showCaption",onClick:function(){r("showCaption",!o)}}},add:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.addDisabled,o=void 0!==r&&r,i=e.add,a=void 0===i?function(){}:i,c=e.bsStyle;return{glyph:"plus",visible:!0,bsStyle:void 0===c?"default":c,tooltipId:"geostory.contentToolbar.add",disabled:n||o,onClick:a}},edit:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.edit,o=void 0===r?function(){}:r,i=e.bsStyle;return{glyph:"pencil",visible:!0,bsStyle:void 0===i?"default":i,tooltipId:"geostory.contentToolbar.edit",disabled:n,onClick:o}},marker:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.markerDisabled,o=void 0!==r&&r,i=e.marker,a=void 0===i?function(){}:i,c=e.bsStyle;return{glyph:"map-marker",visible:!0,tooltipId:"geostory.contentToolbar.marker",bsStyle:void 0===c?"default":c,disabled:n||o,onClick:a}},closeDraw:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.bsStyle,o=void 0===r?"default":r,i=e.update,a=void 0===i?function(){}:i,c=e.onEnableDraw,l=void 0===c?function(){}:c;return{glyph:"1-close",visible:!0,tooltipId:"geostory.contentToolbar.closeMapEditing",bsStyle:o,disabled:!n,onClick:function(){l(null),a("editMap",!n)}}}};function Xn(e){var t=e.tools,n=void 0===t?[]:t,r=e.children,o=Hn(e,Bn);return i().createElement("div",{className:"ms-content-toolbar"},i().createElement(Lt.A,{btnDefaultProps:{className:"square-button-md no-border",noTooltipWhenDisabled:!0},buttons:n.filter((function(e){return(null==e?void 0:e.id)&&Gn[e.id]||Gn[e]})).map((function(e){return(null==e?void 0:e.id)&&Gn[e.id](Vn(Vn({},o),e))||Gn[e](o)}))}),r)}function $n(e){return $n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$n(e)}var Zn=["id","inViewRef","innerRef","children","type","contentWrapperStyle","contentToolbar","mode"];function Kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kn(Object(n),!0).forEach((function(t){Jn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jn(e,t,n){return(t=function(e){var t=function(e){if("object"!=$n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=$n(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==$n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Qn=function(e){var t=e.id,n=e.inViewRef,r=e.innerRef,o=e.children,a=e.type,c=e.contentWrapperStyle,l=e.contentToolbar,u=e.mode,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Zn),p=l||Xn;return i().createElement("div",{id:t,ref:n,style:Yn(Yn({},c),s.hideContent&&{display:"none"}),className:"ms-content ms-content-".concat(a).concat((0,f.kV)(s))},i().createElement("div",{className:"ms-content-body",ref:r,style:(0,f.j7)(s)},u===f.dX.EDIT&&i().createElement(p,s),o))};function er(e){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},er(e)}function tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nr(e,t,n){return(t=function(e){var t=function(e){if("object"!=er(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=er(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==er(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rr=(0,Re.compose)(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return Re.nest.apply(void 0,t.concat([e]))}}(Qn),(0,Re.setDisplayName)("ColumnContent"))(Rt),or=function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tr(Object(n),!0).forEach((function(t){nr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:"size",filterOptions:function(e){return"full"!==e.value},pullRight:e},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})};const ir=(0,Re.compose)((0,Re.branch)((function(e){var t=e.type,n=e.sectionType;return[f.Fq.IMMERSIVE,f.Fq.CAROUSEL].includes(n)&&t===f.Py.COLUMN}),ln({threshold:[0,.25,.5,.75]})),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return Re.nest.apply(void 0,t.concat([e]))}}(Qn),(0,Re.setDisplayName)("SectionContent"),(0,Re.branch)((function(e){return e.type===f.Py.COLUMN}),(0,Re.renderComponent)((function(e){var t=e.viewWidth,n=e.viewHeight,r=e.contents,o=void 0===r?[]:r,a=e.mode,c=e.add,l=void 0===c?function(){}:c,u=e.editMedia,s=void 0===u?function(){}:u,p=e.editWebPage,d=void 0===p?function(){}:p,y=e.update,m=void 0===y?function(){}:y,b=e.remove,v=void 0===b?function(){}:b,g=e.bubblingTextEditing,h=void 0===g?function(){}:g,O=e.expandable,w=e.mediaViewer,E=e.contentToolbar,S=e.sections,P=void 0===S?[]:S,j=e.sectionType,T=e.overrideTools,I=void 0===T?function(e){return e}:T,C=e.storyFonts;return i().createElement(nn,{className:"ms-column-contents",ContentComponent:rr,contents:o,mode:a,add:l,editMedia:s,editWebPage:d,update:m,remove:v,viewWidth:t,viewHeight:n,bubblingTextEditing:h,sectionType:j,contentProps:{expandable:O,mediaViewer:w,contentToolbar:E},sections:P,storyFonts:C,tools:I(nr(nr(nr(nr(nr({},f.Py.TEXT,["remove"]),f.mI.IMAGE,["editMedia",or(),"showCaption","remove"]),f.mI.MAP,["editMedia","editMap",or(!0),"showCaption","remove"]),f.Py.WEBPAGE,[or(!0,{sizeType:"horizontal"}),"editURL",or(!0,{sizeType:"vertical",filterOptions:function(e){return"v-full"!==e.value}}),"remove"]),f.mI.VIDEO,["editMedia","muted","autoplay","loop","showCaption","remove"])),addButtons:[{glyph:"sheet",tooltipId:"geostory.addTextContent",template:f.Py.TEXT},{glyph:"picture",tooltipId:"geostory.addMediaContent",template:f.Py.MEDIA},{glyph:"webpage",tooltipId:"geostory.addWebPageContent",template:f.Py.WEBPAGE}]})}))))(Rt),ar=(0,Re.compose)((0,Re.defaultProps)({ContentComponent:ir}),(0,Re.withHandlers)({editMedia:function(e){var t=e.editMedia,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=e.path,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return n.apply(void 0,[{path:'sections[{"id": "'.concat(r,'"}].')+t}].concat(i))}},editWebPage:function(e){var t=e.editWebPage,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=e.path,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return n.apply(void 0,[{path:'sections[{"id": "'.concat(r,'"}].')+t}].concat(i))}},add:function(e){var t=e.add,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}},update:function(e){var t=e.update,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}},remove:function(e){var t=e.remove,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}}}),(0,Re.setDisplayName)("SectionContents"))(nn);var cr=n(324713),lr=n.n(cr),ur=n(597551),sr=n.n(ur);function fr(e){return fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fr(e)}function pr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function dr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(n),!0).forEach((function(t){mr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mr(e,t,n){return(t=function(e){var t=function(e){if("object"!=fr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=fr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==fr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(0,Re.setObservableConfig)(Ne.A);var br=function(e,t){var n=lr()(e,{id:t});return e[-1!==n&&n?n:0]},vr=(0,Re.withProps)((function(e){var t=e.id,n=e.backgroundId,r=e.contents,o=br(void 0===r?[]:r,n)||{},i=o&&o.id;return{background:k()(o,"background")||{type:"none"},contentId:i,sectionId:t,path:'sections[{"id": "'.concat(t,'"}].contents[{"id": "').concat(i,'"}].background')}})),gr=(0,Re.withHandlers)({updateBackground:function(e){var t=e.sectionId,n=e.contentId,r=e.update,o=void 0===r?function(){}:r;return function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return o.apply(void 0,['sections[{"id": "'.concat(t,'"}].contents[{"id": "').concat(n,'"}].background.')+e].concat(i))}},updateSection:function(e){var t=e.sectionId,n=e.update,r=void 0===n?function(){}:n;return function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return r.apply(void 0,['sections[{"id": "'.concat(t,'"}]')].concat(n))}}}),hr=(0,Re.compose)(vr,gr),Or=(0,Re.mapPropsStream)((function(e){var t=(0,Re.createEventHandler)(),n=t.handler,r=t.stream;return b.Observable.combineLatest(e,function(e,t){var n=e.scan((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.visible,o=t.entry;return yr(yr({},e),{},mr({},n,{visible:r,entry:o}))}),{}).debounceTime(100).map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{maxItem:sr()(Object.keys(e),(function(t){return e[t].visible?k()(e[t],"entry.intersectionRatio"):-1/0})),items:e}}));return b.Observable.merge(n.pluck("maxItem").distinctUntilChanged().map((function(e){return{backgroundId:e}})),n.map((function(e){var t=e.maxItem,n=e.items;return 0===k()(n[t],"entry.intersectionRatio")?"EMPTY":t})).withLatestFrom(t.pluck("updateCurrentPage")).do((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return pr(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pr(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];return i&&i({columnId:o})})).ignoreElements())}(r,e).startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return yr(yr({},t.reduce((function(){var e=arguments.length>1?arguments[1]:void 0;return yr(yr({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),e)}),{})),{},{onVisibilityChange:n})}))}));const wr=(0,Re.compose)(Or,hr);var Er=n(419904);function Sr(e){return Sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sr(e)}function Pr(){return Pr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Pr.apply(null,arguments)}function jr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jr(Object(n),!0).forEach((function(t){Dr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Mr(r.key),r)}}function Cr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Cr=function(){return!!e})()}function Ar(e){return Ar=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ar(e)}function kr(e,t){return kr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},kr(e,t)}function Dr(e,t,n){return(t=Mr(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mr(e){var t=function(e){if("object"!=Sr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Sr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Sr(t)?t:t+""}var xr=n(409691),Rr=n(372401),Nr=n.n(Rr);function Lr(e){return Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lr(e)}function _r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_r(Object(n),!0).forEach((function(t){qr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zr(){return zr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zr.apply(null,arguments)}function Wr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Hr(r.key),r)}}function Br(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Br=function(){return!!e})()}function Ur(e){return Ur=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ur(e)}function Vr(e,t){return Vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Vr(e,t)}function qr(e,t,n){return(t=Hr(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hr(e){var t=function(e){if("object"!=Lr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Lr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Lr(t)?t:t+""}var Gr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){return t=Ur(t),function(e,t){if(t&&("object"==Lr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Br()?Reflect.construct(t,n||[],Ur(e).constructor):t.apply(e,n))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vr(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=(0,f.j7)(this.props),t=!this.props.disableToolbarPortal&&this.refs&&this.refs.div&&this.refs.div.parentNode,n=this.props.sectionType===f.Fq.TITLE?["editMedia","cover"]:["editMedia"],r=this.props.contentToolbar||Xn,o=i().createElement(r,zr({},this.props,{themeProps:{disableBackgroundAlpha:!0,disableTextColor:!0,disableShadow:!0},tools:this.props.tools&&this.props.type&&this.props.tools[this.props.type]||this.props.sectionType===f.Fq.BANNER&&[].concat(n,["cover","remove"])||n}),this.props.contentToolbarChildren),a="".concat(this.props.sectionId||"ms","-media-").concat(this.props.id||this.props.resourceId);return i().createElement("div",{ref:"div",className:"ms-section-background",style:Fr({},this.props.style)},i().createElement("div",{className:"ms-section-background-container".concat((0,f.kV)(this.props)),ref:this.props.innerRef,style:Fr(Fr({height:this.props.height},e),null!==Qe.Uf&&void 0!==Qe.Uf&&Qe.Uf[this.props.type]?{}:this.props.backgroundPlaceholder)},i().createElement(Qe.Ay,zr({id:a},this.props,{enableFullscreen:!1,descriptionEnabled:!1,mediaViewer:this.props.mediaViewer,containerInView:this.props.inView}),this.props.children),this.props.mode===f.dX.EDIT&&(t?i().createElement(xr.ZL,{container:t},o):o)))}}])&&Wr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o.Component);qr(Gr,"propTypes",{id:Ye().string,resourceId:Ye().string,sectionId:Ye().string,mode:Ye().string,fit:Ye().string,size:Ye().string,path:Ye().string,credits:Ye().string,description:Ye().string,height:Ye().number,width:Ye().number,tools:Ye().object,style:Ye().object,add:Ye().func,editMedia:Ye().func,update:Ye().func,updateSection:Ye().func,remove:Ye().func,type:Ye().oneOf(f.k8.MediaTypes),disableToolbarPortal:Ye().bool,backgroundPlaceholder:Ye().object,sectionType:Ye().string,src:Ye().string,theme:Ye().string,mediaViewer:Ye().func,contentToolbar:Ye().func,inView:Ye().bool,sections:Ye().array,innerRef:Ye().oneOfType([Ye().func,Ye().object]),contentToolbarChildren:Ye().node}),qr(Gr,"defaultProps",{height:0,size:"full",width:0,style:{},backgroundPlaceholder:{background:"url(".concat(Nr(),")"),backgroundSize:"256px auto"}});const Xr=($r=Gr,Zr=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Dr(e=function(e,t,n){return t=Ar(t),function(e,t){if(t&&("object"==Sr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Cr()?Reflect.construct(t,n||[],Ar(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"state",{style:{}}),Dr(e,"update",(function(t){if(e._stickybits){var n=document.querySelector(t);-1===e._stickybits.definePosition().indexOf("sticky")&&n&&(e._stickybits.update(),setTimeout((function(){var t=n.getBoundingClientRect(),r=t.top,o=t.left;e.setState({style:{top:r,left:o,width:n.scrollWidth-2}})})))}})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kr(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){this._stickybits=this._node&&(0,Er.A)(this._node,{scrollEl:this.props.scrollContainerSelector,noStyles:!0,useGetBoundingClientRect:!0}),this.update(this.props.scrollContainerSelector)}},{key:"componentWillReceiveProps",value:function(e){!this._stickybits||e.viewWidth===this.props.viewWidth&&e.viewHeight===this.props.viewHeight||this.update(e.scrollContainerSelector)}},{key:"componentWillUnmount",value:function(){this._stickybits&&this._stickybits.cleanup()}},{key:"render",value:function(){var e=this;return i().createElement($r,Pr({ref:function(t){t&&t.refs&&t.refs[e.props.refId]&&(e._node=t.refs[e.props.refId])},style:Tr({},this.state.style)},this.props),this.props.children)}}])&&Ir(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o.Component),Dr(Zr,"propTypes",{scrollContainerSelector:Ye().string,height:Ye().number,width:Ye().number,refId:Ye().string}),Dr(Zr,"defaultProps",{scrollContainerSelector:"body",height:0,width:0,refId:"div"}),Zr);var $r,Zr,Kr=n(855799),Yr=n.n(Kr);function Jr(e){return Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jr(e)}function Qr(){return Qr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Qr.apply(null,arguments)}function eo(e,t,n){return(t=function(e){var t=function(e){if("object"!=Jr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Jr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Jr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const to=(0,Re.compose)(wr,(0,Re.withStateHandlers)({textEditorActive:!1},{bubblingTextEditing:function(){return function(e){return{textEditorActiveClass:e?" ms-text-editor-active":""}}}}))((function(e){var t=e.add,n=void 0===t?function(){}:t,r=e.editMedia,o=void 0===r?function(){}:r,a=e.editWebPage,c=void 0===a?function(){}:a,l=e.onVisibilityChange,u=void 0===l?function(){}:l,s=e.update,p=void 0===s?function(){}:s,d=e.updateBackground,y=void 0===d?function(){}:d,m=e.updateCurrentPage,b=void 0===m?function(){}:m,v=e.remove,g=void 0===v?function(){}:v,h=e.id,O=e.background,w=void 0===O?{}:O,E=e.path,S=e.contents,P=void 0===S?[]:S,j=e.mode,T=e.sectionType,I=e.inViewRef,C=e.viewWidth,A=e.viewHeight,D=e.focusedContent,M=e.contentId,x=e.bubblingTextEditing,R=void 0===x?function(){}:x,N=e.textEditorActiveClass,L=void 0===N?"":N,_=e.expandableMedia,F=void 0!==_&&_,z=e.storyTheme,W=e.mediaViewer,B=e.contentToolbar,U=e.inView,V=e.sections,q=void 0===V?[]:V,H=e.storyFonts,G=D&&D.hideContent&&k()(D,"target.id")===M,X=G?"hidden":"visible",$=F&&w&&"map"===w.type?" ms-expandable-background":"",Z=(null==z?void 0:z.overlay)||{},K=(null==z?void 0:z.general)||{};return i().createElement("section",{className:"ms-section ms-section-immersive".concat($),id:h,ref:I},i().createElement(Xr,Qr({},w,{mode:j,disableToolbarPortal:!0,tools:eo(eo(eo({},f.mI.IMAGE,["editMedia","fit","size","align","theme"]),f.mI.MAP,["editMedia","editMap","size","align","theme"]),f.mI.VIDEO,["editMedia","fit","size","align","theme","muted","autoplay","loop"]),scrollContainerSelector:"#ms-sections-container",add:n,editMedia:o,expandable:F,path:E,update:y,updateCurrentPage:b,remove:g,sectionType:T,sectionId:h,backgroundId:w.id,key:w.id,width:C,height:A,backgroundPlaceholder:{background:"url(".concat(Yr(),")"),backgroundSize:"600px auto"},storyTheme:K,mediaViewer:W,contentToolbar:B,inView:U})),i().createElement(ar,{tools:eo({},f.Py.COLUMN,["size","align","theme"]),className:"ms-section-contents".concat(L),contents:P,mode:j,add:n,updateCurrentPage:b,editMedia:o,editWebPage:c,update:p,remove:g,sectionId:h,viewWidth:C,viewHeight:A,contentProps:{onVisibilityChange:u,contentWrapperStyle:{minHeight:A,visibility:X},expandable:F,mediaViewer:W,contentToolbar:B},focusedContent:D,bubblingTextEditing:R,sectionType:T,storyTheme:Z,sections:q,storyFonts:H}),j===f.dX.EDIT&&!G&&i().createElement($t,{containerWidth:C,containerHeight:A,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){n("sections",h,f.Fq.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){n("sections",h,f.Fq.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){n("sections",h,f.Fq.PARAGRAPH)}},{glyph:"story-immersive-content",tooltipId:"geostory.addImmersiveContent",onClick:function(){n('sections[{"id": "'.concat(h,'"}].contents'),void 0,f.Py.COLUMN,"geostory.builder.defaults.titleImmersiveContent")}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){n("sections",h,f.Fq.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){n("sections",h,f.Po.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){n("sections",h,f.Po.WEBPAGE)}}]}))}));function no(e){return no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},no(e)}function ro(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ro(Object(n),!0).forEach((function(t){io(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ro(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function io(e,t,n){return(t=function(e){var t=function(e){if("object"!=no(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=no(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==no(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ao=function(e){var t=e.id,n=e.contents,r=e.mode,o=e.add,a=void 0===o?function(){}:o,c=e.update,l=void 0===c?function(){}:c,u=e.editMedia,s=void 0===u?function(){}:u,p=e.editWebPage,d=void 0===p?function(){}:p,y=e.remove,m=void 0===y?function(){}:y,b=e.inViewRef,v=e.viewWidth,g=e.viewHeight,h=e.expandableMedia,O=e.mediaViewer,w=e.contentToolbar,E=e.sections,S=void 0===E?[]:E,P=e.sectionType,j=e.storyFonts;return i().createElement("section",{className:"ms-section ms-section-paragraph",id:t,ref:b},i().createElement(ar,{className:"ms-section-contents",contents:n,mode:r,add:a,editMedia:s,editWebPage:d,update:l,remove:m,sectionId:t,viewWidth:v,viewHeight:g,sectionType:P,contentProps:{expandable:h,mediaViewer:O,contentToolbar:w,overrideTools:function(e){return oo(oo({},e),{},io({},f.Py.TEXT,[{id:"size",filterOptions:function(e){return"full"!==e.value},pullRight:true},"remove"]))}},sections:S,storyFonts:j}),r===f.dX.EDIT&&i().createElement($t,{containerWidth:v,containerHeight:g,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){a("sections",t,f.Fq.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){a("sections",t,f.Fq.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){a("sections",t,f.Fq.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){a("sections",t,f.Fq.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){a("sections",t,f.Fq.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){a("sections",t,f.Po.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){a("sections",t,f.Po.WEBPAGE)}}]}))};var co=n(141265),lo=n.n(co);function uo(e){return uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uo(e)}function so(){return so=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},so.apply(null,arguments)}function fo(e,t,n){return(t=function(e){var t=function(e){if("object"!=uo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=uo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==uo(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const po=(0,Re.compose)(hr,(0,Re.withStateHandlers)({textEditorActive:!1},{bubblingTextEditing:function(){return function(e){return{textEditorActiveClass:e?" ms-text-editor-active":""}}}}))((function(e){var t=e.id,n=e.background,r=void 0===n?{}:n,o=e.contents,a=void 0===o?[]:o,c=e.mode,l=e.contentId,u=e.path,s=e.sectionType,p=e.cover,d=e.viewWidth,y=e.viewHeight,m=e.inViewRef,b=e.add,v=void 0===b?function(){}:b,g=e.update,h=void 0===g?function(){}:g,O=e.updateSection,w=void 0===O?function(){}:O,E=e.remove,S=void 0===E?function(){}:E,P=e.updateBackground,j=void 0===P?function(){}:P,T=e.editMedia,I=void 0===T?function(){}:T,C=e.focusedContent,A=e.bubblingTextEditing,D=void 0===A?function(){}:A,M=e.textEditorActiveClass,x=void 0===M?"":M,R=e.expandableMedia,N=void 0!==R&&R,L=e.storyTheme,_=e.mediaViewer,F=e.contentToolbar,z=e.inView,W=e.sections,B=void 0===W?[]:W,U=e.storyFonts,V=k()(C,"target.id")===l,q=V?"hidden":"visible",H=N&&r&&"map"===r.type?" ms-expandable-background":"",G=(null==L?void 0:L.overlay)||{},X=(null==L?void 0:L.general)||{};return i().createElement("section",{ref:m,className:"ms-section ms-section-title".concat(H),id:t},i().createElement(xe.A,null,(function(e){var t=e.height;return i().createElement(Xr,so({},r,{scrollContainerSelector:"#ms-sections-container",key:r.id,mode:c,id:l,path:u,update:j,add:v,editMedia:I,expandable:N,updateSection:w,cover:p,remove:S,width:d,sectionType:s,backgroundPlaceholder:{background:"url(".concat(p?Nr():lo(),")"),backgroundSize:"".concat(p?64:600,"px auto")},tools:fo(fo(fo({},f.mI.IMAGE,["editMedia","cover","fit","size","align","theme"]),f.mI.MAP,["editMedia","cover","editMap","size","align","theme"]),f.mI.VIDEO,["editMedia","cover","fit","size","align","theme","muted","autoplay","loop"]),height:t>=y?y:t,storyTheme:X,mediaViewer:_,contentToolbar:F,inView:z}))})),i().createElement(ar,{className:"ms-section-contents".concat(x),contents:a,mode:c,add:v,sectionType:s,update:h,remove:S,sectionId:t,contentProps:{contentWrapperStyle:p?{minHeight:y,visibility:q}:{visibility:q},mediaViewer:_,contentToolbar:F},tools:fo({},f.Py.TEXT,["size","align","theme","remove"]),focusedContent:C,bubblingTextEditing:D,storyTheme:G,sections:B,storyFonts:U}),c===f.dX.EDIT&&!V&&i().createElement($t,{containerWidth:d,containerHeight:y,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){v("sections",t,f.Fq.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){v("sections",t,f.Fq.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){v("sections",t,f.Fq.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){v("sections",t,f.Fq.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){v("sections",t,f.Fq.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){v("sections",t,f.Po.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){v("sections",t,f.Po.WEBPAGE)}}]}))}));function yo(e){return yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yo(e)}function mo(){return mo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mo.apply(null,arguments)}function bo(e,t,n){return(t=function(e){var t=function(e){if("object"!=yo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=yo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==yo(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const vo=(0,Re.compose)(hr,(0,Re.withStateHandlers)({textEditorActive:!1}))((function(e){var t=e.id,n=e.background,r=void 0===n?{}:n,o=e.mode,a=e.contentId,c=e.path,l=e.sectionType,u=void 0===l?f.Fq.BANNER:l,s=e.cover,p=e.viewWidth,d=e.viewHeight,y=e.inViewRef,m=e.add,b=void 0===m?function(){}:m,v=e.updateSection,g=void 0===v?function(){}:v,h=e.remove,O=void 0===h?function(){}:h,w=e.updateBackground,E=void 0===w?function(){}:w,S=e.editMedia,P=void 0===S?function(){}:S,j=e.focusedContent,T=e.expandableMedia,I=void 0!==T&&T,C=e.storyTheme,A=e.mediaViewer,D=e.contentToolbar,M=e.inView,x=k()(j,"target.id")===a,R=I&&r&&"map"===r.type?" ms-expandable-background":"",N=c.replace(".background","");return i().createElement("section",{ref:y,className:"ms-section ms-section-banner".concat(R),id:t},i().createElement(xe.A,null,(function(e){var t=e.height;return i().createElement(Xr,mo({},r,{scrollContainerSelector:"#ms-sections-container",key:r.id,mode:o,id:a,path:c,update:E,add:b,editMedia:P,expandable:I,updateSection:g,cover:s,remove:function(){return O(N)},width:p,sectionType:u,backgroundPlaceholder:{background:"url(".concat(s?Nr():lo(),")"),backgroundSize:"".concat(s?64:600,"px auto")},tools:bo(bo(bo({},f.mI.IMAGE,["editMedia","cover","fit","size","align","theme","remove"]),f.mI.MAP,["editMedia","cover","editMap","size","align","theme","remove"]),f.mI.VIDEO,["editMedia","cover","fit","size","align","theme","muted","autoplay","loop","remove"]),height:t>=d?d:t,storyTheme:C,mediaViewer:A,contentToolbar:D,inView:M}))})),i().createElement("div",{style:{minHeight:s?d:300,pointerEvents:"none"}}),o===f.dX.EDIT&&!x&&i().createElement($t,{containerWidth:p,containerHeight:d,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){b("sections",t,f.Fq.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){b("sections",t,f.Fq.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){b("sections",t,f.Fq.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){b("sections",t,f.Fq.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){b("sections",t,f.Fq.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){b("sections",t,f.Po.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){b("sections",t,f.Po.WEBPAGE)}}]}))}));var go=n(32485),ho=n.n(go),Oo=n(743799),wo=n(229710),Eo=n(551783);function So(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Po(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Po(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Po(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var jo=(0,Eo.A)("placeholder")(tt.MJ);const To=function(e){var t,n,r,a=So((0,o.useState)([]),2),c=a[0],l=a[1],u=So((0,o.useState)({data:null==e||null===(t=e.thumbnail)||void 0===t?void 0:t.image}),2),s=u[0],f=u[1],p=So((0,o.useState)(null==e?void 0:e.title),2),d=p[0],y=p[1];return i().createElement(wo.A,{fitContent:!0,title:i().createElement(rt.A,{msgId:e.editing?"geostory.carouselEditTitle":"geostory.carouselAddTitle"}),show:!0,fade:!0,clickOutEnabled:!1,bodyClassName:"ms-flex modal-properties-container background-dialog",onClose:e.onClose,buttons:e.loading?[]:[{text:i().createElement(rt.A,{msgId:e.editing?"save":"backgroundDialog.add"}),bsStyle:"primary",onClick:function(){e.update("thumbnail",{image:s.data}),e.update("title",d),e.onClose()}}]},i().createElement(tt.lV,{style:{width:"100%"}},(r={FORMAT:i().createElement(rt.A,{msgId:"map.errorFormat"}),SIZE:i().createElement(rt.A,{msgId:"map.errorSize"})},c.length>0?i().createElement("div",{className:"dropzone-errorBox alert-danger"},i().createElement("p",null,i().createElement(rt.A,{msgId:"map.error"})),c.map((function(e){return i().createElement("div",{id:"error"+e,key:"error"+e,className:"error"+e},r[e])}))):null),i().createElement(Oo.A,{onUpdate:function(e,t){return f({data:e,url:t})},onError:function(e){return l(e)},message:i().createElement(rt.A,{msgId:"backgroundDialog.imageUploadMessage"}),suggestion:"",map:{newThumbnail:k()(s,"url")||(null===(n=e.thumbnail)||void 0===n?void 0:n.image)||"NODATA"},thumbnailOptions:{contain:!1,width:128,height:128,quality:1,type:"image/jpeg"}}),i().createElement(tt.gE,null,i().createElement(tt.mq,null,i().createElement(rt.A,{msgId:"layerProperties.title"})),i().createElement(jo,{value:d,placeholder:"backgroundDialog.titlePlaceholder",onChange:function(e){return y(e.target.value)}}))))};var Io=n(876456),Co=n(382544),Ao=n(522131),ko=n.n(Ao),Do=n(595535);const Mo=function(e){return t=e.type,n="",r="","addMap"===t?(n="ms-carousel-map-info",r="geostory.carouselAddMapInfo"):"addMarker"===t?(n="ms-carousel-marker-info",r="geostory.carouselPlaceMarkerInfo"):(n="ms-carousel-add-info",r="geostory.carouselAddItemInfo"),i().createElement("div",{className:n},i().createElement(Do.A,{msgId:r}));var t,n,r};var xo=n(441614);function Ro(e){return Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ro(e)}var No=["title","thumbnail","index","isSelected"],Lo=["onSort","sectionId","contents","onEnableDraw","isEditMap","isDrawEnabled"];function _o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_o(Object(n),!0).forEach((function(t){zo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zo(e,t,n){return(t=function(e){var t=function(e){if("object"!=Ro(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ro(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ro(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wo(){return Wo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Wo.apply(null,arguments)}function Bo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Uo(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Uo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Uo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Vo(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var qo=(0,Io.A)((function(e){var t=e.title,n=e.thumbnail,r=e.index,o=e.isSelected,a=Vo(e,No),c=i().createElement("div",{className:ho()("ms-geo-carousel-item",{"ms-geo-carousel-item-selected":o}),onClick:a.onClick},i().createElement("div",{className:"ms-geo-carousel-item-inner-wrapper",style:{backgroundImage:"url(".concat((null==n?void 0:n.image)||ko(),")")}},i().createElement("span",{className:"ms-geo-carousel-item-inner"},t||"Item ".concat(r+1)),i().createElement("span",{className:"ms-geo-carousel-item-inner-index"},r+1)));return a.isDraggable&&a.connectDragSource?a.connectDragSource(c):c})),Ho=(0,Co.A)((function(e){var t=e.mode,n=e.add,r=e.update,a=void 0===r?function(){}:r,c=e.remove,l=e.sectionId,u=e.isMapBackground,s=e.contentId,p=e.items,d=e.contentToolbar,y=void 0===d?Xn:d,m=e.cardComponent,b=e.containerWidth,v=e.isDrawEnabled,g=e.onEnableDraw,h=e.isEditMap,O=e.innerRef,w=e.deltaSwipeSize,E=void 0===w?200:w,S=e.transition,P=void 0===S?300:S,j=e.style,T=e.controlStyle,I=Bo((0,o.useState)(!1),2),C=I[0],A=I[1],k=Bo((0,o.useState)(void 0),2),D=k[0],M=k[1],x=Bo((0,o.useState)(""),2),N=x[0],L=x[1],_=Bo((0,o.useState)({}),2),F=_[0],z=_[1],W=(0,xo.A)({direction:"horizontal",width:b,deltaScroll:E,transition:P},[p.length]),B=W.isStartControlActive,U=W.isEndControlActive,V=W.containerPropsHandlers,q=W.contentPropsHandlers,H=W.itemPropsHandlers,G=W.moveToDeltaSize,X=W.moveItemInViewById,$=t===f.dX.EDIT;(0,o.useEffect)((function(){s&&X(s,{margin:32})}),[s]);var Z=!(u&&!pn()(p,(function(e){var t;return 0===((null==e||null===(t=e.features)||void 0===t?void 0:t.length)||0)})));return i().createElement(i().Fragment,null,i().createElement("div",{ref:O,style:j,className:"ms-geo-carousel"},$&&1===p.length&&Z&&!h&&i().createElement(Mo,{type:"addInfo"}),h&&$&&v&&!!pn()(p,(function(e){var t;return e.id===s&&0===((null==e||null===(t=e.features)||void 0===t?void 0:t.length)||0)}))&&i().createElement(Mo,{type:"addMarker"}),$&&i().createElement(y,{addDisabled:Z,add:n,editMap:h,remove:function(){return c('sections[{"id":"'.concat(l,'"}]'))},tools:["add","remove"]}),i().createElement("div",Wo({},V(),{className:"ms-horizontal-menu"}),i().createElement("div",q(),p.map((function(e,t){var r=H({id:e.id,onClick:h?void 0:function(){a('sections[{"id":"'.concat(l,'"}].contents[{"id":"').concat(e.id,'"}].carouselToggle'),!0)}});return i().createElement("div",Wo({key:t},r,{className:"ms-geo-carousel-item-wrapper",style:h?{pointerEvents:"none"}:{}}),$&&i().createElement(y,{editMap:h,markerDisabled:!u||(null==e?void 0:e.id)!==s,edit:function(t){t.stopPropagation(),function(e){M(null==e?void 0:e.id),A(!0),z(null==e?void 0:e.thumbnail),L(null==e?void 0:e.title)}(e)},remove:function(){var n,r,o,i;return o=null==e?void 0:e.id,i=0===t&&p.length>0?null===(n=p[t+1])||void 0===n?void 0:n.id:null===(r=p[t-1])||void 0===r?void 0:r.id,c('sections[{"id":"'.concat(l,'"}].contents[{"id":"').concat(o,'"}]')),void(s===o&&a('sections[{"id":"'.concat(l,'"}].contents[{"id":"').concat(i,'"}].hideContent'),!1))},forceDelBtnDisable:(null==e?void 0:e.id)===s,add:n,marker:function(t){t.stopPropagation(),g(e)},tools:["edit","remove","marker"]}),i().createElement(m,Wo({key:t,index:t,items:p,update:a,sectionId:l,selectedId:s,isSelected:(null==e?void 0:e.id)===s},e)))}))),B&&i().createElement(nt.A,{className:"square-button-md no-border ms-geo-carousel-control",style:Fo(Fo({},T),{},{position:"absolute"}),onClick:function(){return G(E)}},i().createElement(tt.e6,{glyph:"chevron-left"})),U&&i().createElement(nt.A,{className:"square-button-md no-border ms-geo-carousel-control",style:Fo(Fo({},T),{},{position:"absolute",right:0}),onClick:function(){return G(-E)}},i().createElement(tt.e6,{glyph:"chevron-right"})))),C&&i().createElement(To,{title:N,thumbnail:F,update:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:D,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"replace",o=R()(e)?"":".".concat(e);a('sections[{"id":"'.concat(l,'"}].contents[{"id":"').concat(n,'"}]')+o,t,r)},onClose:function(){return A(!1)}}))}));const Go=function(e){var t=e.onSort,n=e.sectionId,r=e.contents,o=void 0===r?[]:r,a=e.onEnableDraw,c=void 0===a?function(){}:a,l=e.isEditMap,u=e.isDrawEnabled,s=Vo(e,Lo);return i().createElement(Ho,Wo({containerId:n,isDraggable:s.mode===f.dX.EDIT,onSort:function(e,r,o,i){if(o.containerId===i.containerId){var a='sections[{ "id": "'.concat(n,'" }].contents[{"id":"').concat(i.id,'"}]'),c='sections[{ "id": "'.concat(n,'" }].contents'),l=e,u=Fn()();t(a,c,l,u,'sections[{ "id": "'.concat(n,'" }].contents[{"id":"').concat(u,'"}]'))}}},Fo(Fo({},s),{},{sectionId:n}),{cardComponent:qo,items:o.map((function(e){var t=e.id,n=e.thumbnail;return{id:t,thumbnail:void 0===n?{}:n,features:e.features,title:e.title}})),isDrawEnabled:u,onEnableDraw:c,isEditMap:l}))};var Xo=n(92427),$o=n(643853);const Zo=function(e){var t=e.currentIndex,n=e.contents,r=void 0===n?[]:n,o=e.onTraverseCard,a=void 0===o?function(){}:o;return i().createElement(i().Fragment,null,i().createElement(nt.A,{className:"ms-carousel-slider left-arrow",disabled:0===t,onClick:function(){return a()}},i().createElement(tt.e6,{style:{fontSize:22},glyph:"chevron-left"})),i().createElement(nt.A,{className:"ms-carousel-slider right-arrow",onClick:function(){return a("right")},disabled:t===r.length-1},i().createElement(tt.e6,{style:{fontSize:22},glyph:"chevron-right"})))};function Ko(e){return Ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ko(e)}function Yo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Jo(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Qo(){return Qo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Qo.apply(null,arguments)}function ei(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ti(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ei(Object(n),!0).forEach((function(t){ni(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ei(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ni(e,t,n){return(t=function(e){var t=function(e){if("object"!=Ko(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ko(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ko(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ri=(0,Re.compose)(Or,(function(e){return function(t){var n=br(t.contents||[],t.backgroundId)||{},r=n&&n.id,o=yr(yr({},t),{},{contentId:r,sectionId:t.id,path:'sections[{"id": "'.concat(t.id,'"}].background')});return i().createElement(e,o)}}),(function(e){return function(t){var n=yr(yr({},t),{},{updateBackground:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return t.update.apply(t,['sections[{"id": "'.concat(t.sectionId,'"}].background.')+e].concat(r))},updateSection:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.update.apply(t,['sections[{"id": "'.concat(t.sectionId,'"}]')].concat(n))}});return i().createElement(e,n)}}),(function(e){return function(t){var n=Yo((0,o.useState)(""),2),r=n[0],a=n[1];return i().createElement(e,Qo({},t,{textEditorActiveClass:r,bubblingTextEditing:function(e){return a(e?" ms-text-editor-active":"")}}))}}))((function(e){var t,n=e.add,r=void 0===n?function(){}:n,a=e.editMedia,c=void 0===a?function(){}:a,l=e.editWebPage,u=void 0===l?function(){}:l,s=e.onVisibilityChange,p=void 0===s?function(){}:s,d=e.update,y=void 0===d?function(){}:d,m=e.updateBackground,b=void 0===m?function(){}:m,v=e.updateCurrentPage,g=void 0===v?function(){}:v,h=e.remove,O=void 0===h?function(){}:h,w=e.id,E=e.background,S=void 0===E?{}:E,P=e.path,j=e.contents,T=void 0===j?[]:j,I=e.mode,C=e.sectionType,A=e.inViewRef,D=e.viewWidth,M=e.viewHeight,x=e.focusedContent,R=e.contentId,N=e.bubblingTextEditing,L=void 0===N?function(){}:N,_=e.textEditorActiveClass,F=void 0===_?"":_,z=e.expandableMedia,W=void 0!==z&&z,B=e.storyTheme,U=e.mediaViewer,V=e.contentToolbar,q=e.inView,H=e.sections,G=void 0===H?[]:H,X=e.storyFonts,$=e.onSort,Z=void 0===$?function(){}:$,K=e.onEnableDraw,Y=void 0===K?function(){}:K,J=e.isDrawEnabled,Q=e.defaultMarkerStyle,ee=void 0===Q?{iconColor:"cyan",iconShape:"circle"}:Q,te=e.highlightedMarkerStyle,ne=void 0===te?{iconColor:"green",iconShape:"circle"}:te,re=(0,o.useRef)(),oe=(0,o.useRef)(),ie=(0,o.useRef)();function ae(e,t){return t-(e.left+e.right)<128?{top:0,left:0,bottom:0,right:0}:e}var ce=x&&x.hideContent&&k()(x,"target.id")===w,le=ce?"hidden":"visible",ue=W&&S&&"map"===S.type?" ms-expandable-background":"",se=ti(ti({},null==B?void 0:B.overlay),I===f.dX.VIEW&&{maxHeight:M-350,overflowY:"auto"})||{},fe=(null==B?void 0:B.general)||{},pe=M-(I===f.dX.EDIT?220:200),de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(pn()(T,{id:R})||{}).contents,n=void 0===t?[]:t;return e.filter((function(e){return f.Fq.CAROUSEL===C&&1===n.length?"remove"!==e:e}))},ye=(null==S?void 0:S.type)===f.mI.MAP,me=(T.find((function(e){return e.id===R}))||{}).features,be=void 0===me?[]:me,ve=lr()(T,(function(e){var t=e.id;return R===t})),ge=(0,f.jc)({id:w,contents:T.filter((function(e){return e.id!==R})),featureStyle:function(e){var t=e.content,n=e.feature;return(0,f.w4)(ee,T,t,R,n)}}),he=(0,f.jc)({id:"".concat(w,"-highlighted"),contents:T.filter((function(e){return e.id===R})),featureStyle:function(e){var t=e.content,n=e.feature;return(0,f.w4)(ne,T,t,R,n)}});return i().createElement("section",{className:"ms-section ms-section-carousel".concat(ue),id:w,ref:A},i().createElement(Xr,Qo({},S,{mode:I,innerRef:re,disableToolbarPortal:!0,tools:ni(ni(ni({},f.mI.IMAGE,["editMedia","fit","size","align","theme"]),f.mI.MAP,["editMedia","editMap","size","align","theme"].concat(J?"closeDraw":[])),f.mI.VIDEO,["editMedia","fit","size","align","theme","muted","autoplay","loop"]),scrollContainerSelector:"#ms-sections-container",add:r,editMedia:c,expandable:W,path:P,update:b,updateCurrentPage:g,remove:O,sectionType:C,sectionId:w,backgroundId:S.id,key:S.id,width:D,height:M,backgroundPlaceholder:{background:"url(".concat(Yr(),")"),backgroundSize:"600px auto"},storyTheme:fe,mediaViewer:U,contentToolbar:V,inView:q,layers:[ge,he],isDrawEnabled:J,onEnableDraw:Y,contentToolbarChildren:!ye&&I===f.dX.EDIT&&i().createElement(Mo,{type:"addMap"})}),i().createElement(Xo.A,{active:J,features:be,method:"Point",onChange:function(e,t){y('sections[{"id":"'.concat(w,'"}].contents[{"id":"').concat(R,'"}].features'),t)}}),i().createElement($o.A,{active:!(J||null!=S&&S.editMap),geometry:null==be||null===(t=be[0])||void 0===t||null===(t=t.geometry)||void 0===t?void 0:t.coordinates,padding:function(){var e={top:0,left:0,bottom:0,right:0},t=re.current&&re.current.querySelector(".ms-media-map"),n=oe.current&&oe.current.querySelector("[id='".concat(R,"']"));if(t&&n){var r=re.current.getBoundingClientRect()||{},o=t.getBoundingClientRect()||{},i=n.getBoundingClientRect()||{};if(ie.current){var a=ie.current.getBoundingClientRect()||{};e.bottom=r.height-(a.top-r.top)}var c=o.left-r.left,l=c+o.width,u=i.left-r.left,s=u+i.width;if(u>=c&&s<=l){var f=u-c,p=l-s;return p>=f?e.left=f+i.width:e.right=p+i.width,ae(e,o.width)}if(s>=c&&s<=l)return e.left=s-c,ae(e,o.width);if(u>=c&&u<=l)return e.right=l-u,ae(e,o.width)}return e}(),fixedZoom:!0,duration:300})),i().createElement(ar,{innerRef:oe,tools:ni({},f.Py.COLUMN,["size","align","theme"]),className:"ms-section-contents".concat(F),contents:T,mode:I,add:r,updateCurrentPage:g,editMedia:c,editWebPage:u,update:y,remove:O,sectionId:w,viewWidth:D,viewHeight:M,contentProps:{onVisibilityChange:p,contentWrapperStyle:{minHeight:pe,visibility:le},expandable:W,mediaViewer:U,contentToolbar:V,overrideTools:function(e){return Object.fromEntries(Object.entries(e).map((function(e){var t=Yo(e,2),n=t[0],r=t[1];return[n,de(r)]})))}},focusedContent:x,bubblingTextEditing:L,sectionType:C,storyTheme:se,sections:G,storyFonts:X}),i().createElement(Go,{innerRef:ie,style:null!=B&&B.overlay?ti({},B.overlay):{},controlStyle:fe?ti({},fe):{},sectionId:w,contentId:R,contents:T,update:y,remove:O,expandable:W,add:function(){return e=ti(ti({},(0,f.$$)(f.Py.COLUMN)),{},{title:"Item "+(T.length+1),background:{}}),r('sections[{"id": "'.concat(w,'"}].contents'),void 0,e,"geostory.builder.defaults.titleGeocarouselContent"),void y('sections[{"id":"'.concat(w,'"}].contents[{"id":"').concat(R,'"}].hideContent'),!0);var e},contentToolbar:V,mode:I,onSort:Z,isMapBackground:ye,isEditMap:null==S?void 0:S.editMap,containerWidth:D,isDrawEnabled:J,onEnableDraw:function(e){y('sections[{"id":"'.concat(w,'"}].background.editMap'),!0,"replace"),Y({contentId:e.id,sectionId:w})}}),I===f.dX.VIEW&&!W&&i().createElement(Zo,{currentIndex:ve,contents:T,onTraverseCard:function(){var e,t,n;e="left"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"left")?null==T||null===(t=T[0===ve?0:ve-1])||void 0===t?void 0:t.id:null==T||null===(n=T[ve===T.length-1?ve:ve+1])||void 0===n?void 0:n.id,y('sections[{"id":"'.concat(w,'"}].contents[{"id":"').concat(e,'"}].carouselToggle'),!0)}}),I===f.dX.EDIT&&!ce&&i().createElement($t,{containerWidth:D,containerHeight:M,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){r("sections",w,f.Fq.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){r("sections",w,f.Fq.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){r("sections",w,f.Fq.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){return r("sections",w,f.Fq.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){r("sections",w,f.Fq.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){r("sections",w,f.Po.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){r("sections",w,f.Po.WEBPAGE)}}]}))}));function oi(e){return oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oi(e)}function ii(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,si(r.key),r)}}function ai(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ai=function(){return!!e})()}function ci(e){return ci=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ci(e)}function li(e,t){return li=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},li(e,t)}function ui(e,t,n){return(t=si(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function si(e){var t=function(e){if("object"!=oi(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=oi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==oi(t)?t:t+""}var fi=ui(ui(ui(ui(ui(ui(ui(ui({},f.Fq.IMMERSIVE,to),f.Fq.CAROUSEL,ri),f.Fq.PARAGRAPH,ao),f.Po.MEDIA,ao),f.Po.WEBPAGE,ao),f.Fq.TITLE,po),f.Fq.BANNER,vo),"UNKNOWN",(function(e){var t=e.type,n=e.inViewRef;return i().createElement("div",{ref:n,className:"ms-section ms-section-unknown"},"WARNING: unknown session of type ",t)})),pi=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return ui(e=function(e,t,n){return t=ci(t),function(e,t){if(t&&("object"==oi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ai()?Reflect.construct(t,n||[],ci(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"state",{height:0}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&li(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=fi[this.props.type]||fi.UNKNOWN;return i().createElement(e,{sectionType:this.props.type,id:this.props.id,add:this.props.add,update:this.props.update,inViewRef:this.props.inViewRef,editMedia:this.props.editMedia,expandableMedia:this.props.expandableMedia,editWebPage:this.props.editWebPage,updateCurrentPage:this.props.updateCurrentPage,remove:this.props.remove,mode:this.props.mode,cover:this.props.cover,contents:this.props.contents,viewWidth:this.props.viewWidth,viewHeight:this.props.viewHeight,focusedContent:this.props.focusedContent,storyTheme:this.props.storyTheme,mediaViewer:this.props.mediaViewer,contentToolbar:this.props.contentToolbar,inView:this.props.inView,sections:this.props.sections,storyFonts:this.props.storyFonts,onSort:this.props.onSort,isDrawEnabled:this.props.isDrawEnabled,background:this.props.background,onEnableDraw:this.props.onEnableDraw,defaultMarkerStyle:this.props.defaultMarkerStyle,highlightedMarkerStyle:this.props.highlightedMarkerStyle})}}])&&ii(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);ui(pi,"propTypes",{id:Ye().string,type:Ye().oneOf(f.k8.SectionTypes),storyType:Ye().oneOf(f.k8.StoryTypes),add:Ye().func,update:Ye().func,editMedia:Ye().func,editWebPage:Ye().func,remove:Ye().func,updateCurrentPage:Ye().func,mode:Ye().oneOf(f.k8.Modes),contents:Ye().array,viewHeight:Ye().number,viewWidth:Ye().number,inViewRef:Ye().func,excludeClassName:Ye().string,cover:Ye().bool,focusedContent:Ye().object,expandableMedia:Ye().bool,storyTheme:Ye().object,mediaViewer:Ye().func,contentToolbar:Ye().func,inView:Ye().bool,sections:Ye().array,storyFonts:Ye().array,onSort:Ye().func,isDrawEnabled:Ye().bool,onEnableDraw:Ye().func,background:Ye().object,defaultMarkerStyle:Ye().object,highlightedMarkerStyle:Ye().object}),ui(pi,"defaultProps",{id:"",add:function(){},update:function(){},editMedia:function(){},editWebPage:function(){},updateCurrentPage:function(){},remove:function(){},onSort:function(){},storyType:f.n6.CASCADE,viewHeight:0,viewWidth:0,mode:f.dX.VIEW,expandableMedia:!1,sections:[],storyFonts:[],onEnableDraw:function(){}});const di=ln({threshold:[0,.25,.5,.75,1],rootMargin:"-200px 0px 0px 0px"})(pi);function yi(e){return yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yi(e)}function mi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Oi(r.key),r)}}function bi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(bi=function(){return!!e})()}function vi(e){return vi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vi(e)}function gi(e,t){return gi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},gi(e,t)}function hi(e,t,n){return(t=Oi(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oi(e){var t=function(e){if("object"!=yi(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=yi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==yi(t)?t:t+""}var wi=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return hi(e=function(e,t,n){return t=vi(t),function(e,t){if(t&&("object"==yi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,bi()?Reflect.construct(t,n||[],vi(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"getAdjustedSelector",(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/#\d|^#-\d/g,(function(e,t){return t?"#\\"+t[1]+t[2]:"#\\3"+e[1]+" "}))})),hi(e,"getFocusedTarget",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.targets,n=e.props.padding,r=void 0===n?{}:n;return t.map((function(t){var n=t.selector,o=null;try{var i=window.document.querySelector(e.getAdjustedSelector(n));if(i){var a=i.getBoundingClientRect(),c=a.top,l=a.right,u=a.bottom,s=a.left;o={x:s-r,y:c-r,w:l-s+2*r,h:u-c+2*r}}}catch(e){console.warn(e)}finally{return o}})).filter((function(e){return e}))})),hi(e,"getHolePath",(function(t){var n=t.x,r=t.y,o=t.w,i=t.h,a=e.props.borderRadius,c=void 0===a?8:a;return"M ".concat(n," ").concat(r+c," q 0 -").concat(c," ").concat(c," -").concat(c," h ").concat(o-2*c," q ").concat(c," 0 ").concat(c," ").concat(c," v ").concat(i-2*c," q 0 ").concat(c," -").concat(c," ").concat(c," h-").concat(o-2*c," q -").concat(c," 0 -").concat(c," -").concat(c," v-").concat(i-2*c)})),hi(e,"getPath",(function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getFocusedTarget();return"M 0 0 h ".concat(n," v ").concat(t," h -").concat(n," v -").concat(t)+r.map(e.getHolePath).join(" ")})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gi(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this,t=this.props,n=t.onMaskClicked,r=t.stopEventsOnTargets,o=void 0!==r&&r,a=t.targets,c=this.getFocusedTarget(a.filter((function(e){var t=e.stopEventsOnTarget;return o||t})));return i().createElement("div",{style:{position:"fixed",height:"100vh",width:"100vw",top:0,left:0,zIndex:1e6,pointerEvents:"none"}},i().createElement(xe.A,null,(function(t){var r=t.width,o=t.height;return i().createElement("svg",{width:r,height:o,xmlns:"http://www.w3.org/2000/svg"},i().createElement("path",{d:e.getPath(o,r),fill:"rgba(0,0,0,0.7)",fillRule:"evenodd",pointerEvents:"visiblePainted",onClick:n}),c.map((function(t,n){return i().createElement("path",{key:n,d:e.getHolePath(t),fill:"transparent",pointerEvents:"visiblePainted"})})))})))}}],r&&mi(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);function Ei(e){return Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ei(e)}function Si(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Si(Object(n),!0).forEach((function(t){ji(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Si(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ji(e,t,n){return(t=function(e){var t=function(e){if("object"!=Ei(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ei(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ei(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}hi(wi,"propTypes",{targets:Ye().arrayOf(Ye().shape({selector:Ye().string,stopEventsOnTarget:Ye().bool})),padding:Ye().number,borderRadius:Ye().number,onMaskClicked:Ye().func,stopEventsOnTargets:Ye().bool}),hi(wi,"defaultProps",{targets:[],padding:0,borderRadius:8,onMaskClicked:function(){},stopEventsOnTargets:!1});var Ti=(0,Ue.A)((function(e){var t=e.sections;return 0===(void 0===t?[]:t).length}),(function(e){var t=e.add,n=void 0===t?function(){}:t;return{iconFit:!1,style:{position:"relative",width:"50%",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},glyph:"geostory",title:i().createElement(rt.A,{msgId:"geostory.emptyTitle"}),description:i().createElement(rt.A,{msgId:"geostory.emptyDescription"}),content:i().createElement($t,{addButtonClassName:"square-button-md",containerWidth:"100%",containerHeight:"100%",buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){n("sections",0,f.Fq.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){n("sections",0,f.Fq.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){n("sections",0,f.Fq.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveContent",onClick:function(){n("sections",0,f.Fq.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselContent",onClick:function(){n("sections",0,f.Fq.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){n("sections",0,f.Po.MEDIA)}},{glyph:"code",tooltipId:"geostory.addWebPageSection",onClick:function(){n("sections",0,f.Po.WEBPAGE)}}]})}}))(xe.A),Ii=function(e){var t=e.width;return e.mode===f.dX.EDIT?"":t<640?"sm":t>=640&&t<1024?"md":""};const Ci=(0,Re.compose)(Be,Ze,function(e){var t=e.showFocusMask,n=void 0===t?function(){}:t,r=e.defaultTargets,o=void 0===r?{selector:".ms-geostory-map-editor"}:r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=a.padding,l=void 0===c?0:c,u=a.borderRadius,s=void 0===u?8:u,f=a.stopEventsOnTargets,p=void 0!==f&&f,d=a.onMaskClicked,y=void 0===d?function(){}:d;return(0,Re.branch)(n,(function(e){return(0,Re.nest)((function(e){var t=e.focusedContent,n=e.children;return i().createElement(i().Fragment,null,n,i().createElement(wi,{targets:[t,o],padding:l,borderRadius:s,stopEventsOnTargets:p,onMaskClicked:y}))}),e)}))}({showFocusMask:function(e){var t=e.focusedContent,n=(void 0===t?{}:t).target;return(void 0===n?{}:n).id}}))((function(e){var t=e.mode,n=void 0===t?f.dX.VIEW:t,r=e.sections,o=void 0===r?[]:r,a=e.add,c=void 0===a?function(){}:a,l=e.onVisibilityChange,u=void 0===l?function(){}:l,s=e.updateCurrentPage,p=void 0===s?function(){}:s,d=e.editMedia,y=void 0===d?function(){}:d,m=e.editWebPage,b=void 0===m?function(){}:m,v=e.update,g=void 0===v?function(){}:v,h=e.remove,O=void 0===h?function(){}:h,w=e.focusedContent,E=e.isContentFocused,S=void 0!==E&&E,P=e.getSize,j=void 0===P?Ii:P,T=e.theme,I=void 0===T?{}:T,C=e.mediaViewer,A=e.contentToolbar,k=e.storyFonts,D=e.onSort,M=void 0===D?function(){}:D,x=e.isDrawEnabled,R=void 0!==x&&x,N=e.onEnableDraw,L=void 0===N?function(){}:N,_=e.defaultMarkerStyle,F=e.highlightedMarkerStyle;return i().createElement(Me.A,{className:"ms-cascade-story ms-".concat(n)},i().createElement(Ti,{sections:o,add:c},(function(e){var t,r=e.width,a=e.height,l=j({width:r,height:a,mode:n}),s=l?" ms-".concat(l):"",f="sm"===l,d=I&&Pn()(I)&&I||{};return i().createElement("div",{id:"ms-sections-container",className:"ms-sections-container".concat(s," ms-sections-hyperlinks"),style:Pi(Pi({},null==d?void 0:d.general),S&&{overflow:"hidden"})},(null==d||null===(t=d.link)||void 0===t?void 0:t.color)&&i().createElement("style",{dangerouslySetInnerHTML:{__html:"\n            .ms-sections-hyperlinks .ms-text-editor-main a,\n            .ms-sections-hyperlinks .ms-text-wrapper a,\n            .ms-sections-hyperlinks .ms-text-editor-main a:link,\n            .ms-sections-hyperlinks .ms-text-wrapper a:link,\n            .ms-sections-hyperlinks .ms-text-editor-main a:visited,\n            .ms-sections-hyperlinks .ms-text-wrapper a:visited,\n            .ms-sections-hyperlinks .ms-text-editor-main a:active,\n            .ms-sections-hyperlinks .ms-text-wrapper a:active {\n                color: ".concat(d.link.color,";\n                opacity: 1;\n            }\n            .ms-sections-hyperlinks .ms-text-editor-main a:hover,\n            .ms-sections-hyperlinks .ms-text-wrapper a:hover {\n                color: ").concat(d.link.color,";\n                opacity: 0.75;\n            }\n        ")}}),o.map((function(e){var t=e.contents,l=void 0===t?[]:t,s=e.id,m=e.type,v=e.cover,h=e.background;return i().createElement(di,{focusedContent:w,onVisibilityChange:u,add:c,editMedia:y,expandableMedia:f,editWebPage:b,updateCurrentPage:p,update:g,remove:O,key:s,id:s,viewHeight:a,viewWidth:r,type:m,mode:n,contents:l,cover:v,storyTheme:d,mediaViewer:C,contentToolbar:A,sections:o,storyFonts:k,onSort:M,isDrawEnabled:R,onEnableDraw:L,background:h,defaultMarkerStyle:_,highlightedMarkerStyle:F})})))})))}));var Ai=n(590179),ki=n.n(Ai),Di=n(757104);function Mi(e){return Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mi(e)}function xi(e){return function(e){if(Array.isArray(e))return Ri(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ri(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ri(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ri(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Ni(){return Ni=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ni.apply(null,arguments)}function Li(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Li(Object(n),!0).forEach((function(t){Fi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Li(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fi(e,t,n){return(t=function(e){var t=function(e){if("object"!=Mi(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Mi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Mi(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zi=(0,wn.A)(un.A);const Wi=(0,Re.compose)((0,a.connect)((0,c.Mz)(q.Zl,q.Wt,(function(e,t){return{resources:e,isContentFocused:t}}))),(0,Re.withProps)((function(e){var t,n,r=e.resources,o=e.resourceId,i=e.map,a=void 0===i?{}:i,c=pn()(r,{id:o})||{},l=ki()(c.data,["context"]),u=-1!==(null===(t=(null==a?void 0:a.layers)||[])||void 0===t?void 0:t.indexOf(null))||-1!==(null===(n=(null==a?void 0:a.groups)||[])||void 0===n?void 0:n.indexOf(null)),s=_i(_i({},a),{},{layers:(a.layers||(null==l?void 0:l.layers)||[]).map((function(e){return e||void 0})),groups:(a.groups||(null==l?void 0:l.groups)||[]).map((function(e){return e||void 0}))});return{map:(0,f.uL)(l,s,u)}})));var Bi=(0,Re.compose)((0,a.connect)((0,c.Mz)(q.$e,(function(){return{focusedEl:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}))),(0,Re.withProps)((function(e){var t=e.focusedEl,n=void 0===t?{}:t,r=n.resourceId,o=n.map;return{map:o||{},resourceId:r,disableReset:!o}}))),Ui=(0,Re.withHandlers)({onChangeMap:function(e){var t=e.update,n=e.focusedContent,r=void 0===n?{}:n;return function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"merge";t("".concat(r.path,".map.").concat(e),n,o)}},onChange:function(e){var t=e.update,n=e.focusedContent,r=void 0===n?{}:n;return function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"merge";t(r.path+".".concat(e),n,o)}}}),Vi=(0,Re.withHandlers)({toggleEditing:function(e){var t=e.editMap,n=e.update,r=e.focusedContent;return function(){return n(r.path+".editMap",!t)}},onReset:function(e){var t=e.update,n=e.focusedContent,r=(void 0===n?{}:n).path,o=void 0===r?"":r;return function(){t(o+".map",void 0)}}}),qi=function(e){return i().createElement(zi,Ni({glyph:"repeat",bsStyle:"primary",className:"square-button-md no-border",tooltipId:"geostory.contentToolbar.resetMap",confirmTitle:i().createElement(rt.A,{msgId:"geostory.contentToolbar.resetMapConfirm"}),confirmContent:i().createElement(rt.A,{msgId:"geostory.contentToolbar.resetConfirmContent"})},e))},Hi=(0,Re.compose)((0,Re.withProps)((function(e){var t=e.disableReset,n=e.onReset,r=e.buttonItems,o=void 0===r?[]:r,a=e.map;return{buttons:[{renderButton:i().createElement(qi,{disabled:t,onClick:n})}].concat(xi(o.map((function(e){var t=e.Component;return{renderButton:i().createElement(t,{map:a})}}))))}})),Di.A,(0,Re.withStateHandlers)((function(){return{editNode:void 0}}),{setEditNode:function(){return function(e){return{editNode:e}}},closeNodeEditor:function(){return function(){return{editNode:void 0}}}}),(0,Re.branch)((function(e){return!!e.editNode}),(0,Re.withProps)((function(e){var t=e.selectedNodes,n=void 0===t?[]:t,r=e.closeNodeEditor,o=void 0===r?function(){}:r;return{buttons:[{visible:1===n.length,tooltipId:"close",glyph:"1-close",onClick:o}]}})),(0,Re.withProps)((function(e){var t=e.selectedNodes,n=void 0===t?[]:t,r=e.setEditNode,o=void 0===r?function(){}:r,i=e.buttons,a=void 0===i?[]:i;return{buttons:[{visible:1===n.length,glyph:"wrench",tooltipId:"toc.toolLayerSettingsTooltip",onClick:function(){o(n[0])}}].concat(xi(a))}})))),Gi=(0,Re.compose)((0,Re.withPropsOnChange)(["focusedContent"],(function(e){var t=e.map,n=e.focusedEl;return{contentMap:(void 0===n?{}:n).map,lastSavedMap:t}})),(0,Re.withPropsOnChange)(["map"],(function(e){var t=e.map,n=e.lastSavedMap;return{pendingChanges:!bn()(n,t)}}))),Xi=(0,Re.compose)((0,Re.withProps)((function(e){var t=e.toggleEditing;return{CloseBtn:function(e){return i().createElement(un.A,Ni({onClick:t},e))}}}))),$i=(0,Re.mapPropsStream)((function(e){var t=(0,Re.createEventHandler)(),n=t.stream,r=t.handler;return e.pluck("map").distinctUntilChanged((function(e,t){return bn()(e,t)})).switchMap((function(e){return n.map((function(t){return{map:_i(_i({},e),t)}})).startWith({map:e})})).combineLatest(e,(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).map;return _i(_i({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),{},{onMapViewLocalChanges:r,map:e})}))})),Zi=function(e,t){return void 0!==e&&void 0!==t&&e.toFixed(12)-t.toFixed(12)==0},Ki=(0,Re.withHandlers)({onMapViewChanges:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.update,n=e.editMap,r=void 0!==n&&n,o=e.onMapViewLocalChanges,i=e.map,a=void 0===i?{}:i,c=a.center,l=void 0===c?{}:c,u=a.zoom,s=a.mapStateSource,f=a.resolution,p=a.resetPanAndZoom;return function(e){var n=e.center,i=void 0===n?{}:n,a=e.zoom,c=e.mapStateSource,d=e.resolution,y=Zi(l.x,i.x)&&Zi(l.y,i.y);!r||y&&u===a?p?t("map",{center:l,zoom:u,mapStateSource:s,resolution:f,resetPanAndZoom:!1},"merge"):o({center:i,zoom:a,mapStateSource:c,resolution:d}):t("map",{center:i,zoom:a,mapStateSource:Fn()(),resolution:d,resetPanAndZoom:!1},"merge")}}}),Yi=n(191080),Ji=n(814915),Qi=n(4814),ea=n(164045),ta=["tabs","activeTab","width","setActiveTab"];function na(){return na=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},na.apply(null,arguments)}var ra=(0,ea.A)(tt.CI);var oa=n(531888),ia=n(192016),aa=n(444003),ca=n(348317),la=n(859797),ua=["map","onChangeMap"],sa=(0,Eo.A)(["placeholder","options"])(ia.Ay);const fa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.map,n=void 0===t?{zoomControl:!0,mapInfoControl:!1}:t,r=e.onChangeMap,o=void 0===r?function(){}:r,a=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,ua),c=n&&n.mapOptions||{},l=(0,f.hq)({mapOptions:c,zoomControl:!!P()(n.zoomControl)||n.zoomControl,mapInfoControl:!P()(n.mapInfoControl)&&n.mapInfoControl}),u=(0,aa.TF)(n);return i().createElement(tt.lV,{className:"ms-geostory-map-controls"},!u&&i().createElement(tt.gE,null,i().createElement(tt.mq,null,i().createElement(rt.A,{msgId:"geostory.mapEditor.zoom"})),i().createElement(ca.A,{onChange:function(){var e=!l.zoomControl;o("zoomControl",e),o("mapOptions.interactions",{doubleClickZoom:e,shiftDragZoom:e,pinchZoom:e})},className:"ms-geostory-map-controls-switch",checked:l.zoomControl}),i().createElement(sa,{options:[{label:"geostory.mapEditor.topLeft",value:"topLeft"},{label:"geostory.mapEditor.topRight",value:"topRight"},{label:"geostory.mapEditor.bottomLeft",value:"bottomLeft"},{label:"geostory.mapEditor.bottomRight",value:"bottomRight"}],wrapperStyle:{marginTop:"10px"},value:l.mapOptions&&l.mapOptions.zoomPosition||"topLeft",clearable:!1,disabled:!l.zoomControl,onChange:function(e){return o("mapOptions.zoomPosition",e&&e.value?e.value:"topLeft")},placeholder:"geostory.builder.settings.titlePlaceholder"})),i().createElement(tt.gE,null,i().createElement(tt.mq,null,i().createElement(rt.A,{msgId:"geostory.mapEditor.pan"})),i().createElement(ca.A,{onChange:function(){var e=!(l.mapOptions&&l.mapOptions.interactions&&l.mapOptions.interactions.dragPan);o("mapOptions.interactions",{dragPan:e,keyboardPan:e})},className:"ms-geostory-map-controls-switch",checked:l.mapOptions&&l.mapOptions.interactions&&l.mapOptions.interactions.dragPan})),!u&&i().createElement(tt.gE,null,i().createElement(tt.mq,null,i().createElement(rt.A,{msgId:"geostory.mapEditor.identify"})),i().createElement(ca.A,{onChange:function(){var e=!l.mapInfoControl;o("mapInfoControl",e)},className:"ms-geostory-map-controls-switch",checked:l.mapInfoControl}),l.mapInfoControl&&!a.hideIdentifyOptions&&i().createElement(la.A,{disabled:!l.mapInfoControl,popoverMessage:"geostory.builder.settings.templateTooltip",infoFormat:l.mapOptions&&l.mapOptions.mapInfoFormat||"application/json",onInfoFormatChange:function(e){return o("mapOptions.mapInfoFormat",e)},selectProps:{wrapperStyle:{marginTop:10}}})))};var pa=n(734068),da=(0,Re.withProps)((function(e){return{tabs:e.tabs||[{id:"toc",titleId:"geostory.mapEditor.toc",tooltipId:"geostory.mapEditor.toc",glyph:"1-layer",visible:!0,Component:pa.A},{id:"settings",titleId:"geostory.mapEditor.settings",tooltipId:"geostory.mapEditor.settings",glyph:"wrench",visible:!0,Component:fa}]}}));const ya=(0,Re.compose)((0,oa.A)("activeTab","setActiveTab","toc"),da);var ma=n(877731),ba=n.n(ma),va=(0,Re.compose)(Qi.A,(0,Re.withProps)((function(e){var t=e.selectedNode;return{title:t&&t.title}})),(0,Yi.A)("title"))((function(e){var t=e.title,n=e.description;return i().createElement("div",{className:"text-center"},i().createElement("div",{className:"mapstore-step-title"},t),i().createElement("div",{className:"mapstore-step-description"},n))})),ga=(0,Qi.A)(Ji.A),ha=ya((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tabs,n=void 0===t?[]:t,r=e.activeTab,o=(e.width,e.setActiveTab),a=void 0===o?function(){}:o,c=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,ta);return i().createElement("div",{key:"ms-geostory-map-settings-navbar",className:"ms-row-tab"},i().createElement("div",null,i().createElement(tt.so,{bsStyle:"tabs",activeKey:r,justified:!0},n.map((function(e){return i().createElement(ra,{key:"ms-tab-settings-"+e.id,tooltipId:e.tooltipId,eventKey:e.id,onClick:function(){return a(e.id)}},i().createElement(tt.e6,{glyph:e.glyph}))})))),i().createElement("div",null,n.filter((function(e){return e.id&&e.id===r})).filter((function(e){return e.Component})).map((function(e){return i().createElement(e.Component,na({},c,{key:"ms-geostory-tab-settings-body-"+e.id}))}))))}));const Oa=(0,Re.branch)((function(e){var t=e.focusedContent;return(void 0===t?{}:t).path}),(0,Re.compose)((0,Re.defaultProps)({isFocused:!0,editMap:!0}),Bi,Wi,Gi,Ui,Vi,Hi,Xi))((function(e){var t=e.mode,n=void 0===t?f.dX.VIEW:t,r=e.isFocused,o=void 0!==r&&r,a=e.map,c=void 0===a?{}:a,l=e.onChange,u=void 0===l?function(){}:l,s=e.onChangeMap,p=void 0===s?function(){}:s,d=e.onNodeSelect,y=void 0===d?function(){}:d,m=e.selectedNodes,b=e.buttons,v=void 0===b?[]:b,g=e.editNode,h=e.closeNodeEditor,O=e.CloseBtn,w=void 0===O?function(){return null}:O,E=e.isDrawEnabled,S=e.hideIdentifyOptions;return n===f.dX.EDIT&&o?i().createElement("div",{key:"left-column",style:{order:-1,width:400,position:"relative"}},!E&&i().createElement(Me.A,{className:"ms-geostory-map-editor",header:i().createElement("div",{className:"ms-geostory-map-editor-header text-center"},i().createElement(tt.fI,null,i().createElement(tt.fv,{md:12,className:"text-center",style:{overflow:"hidden",lineHeight:"52px"}},i().createElement(w,{glyph:"1-close",className:"pull-left on-close-btn square-button no-border ",tooltipId:"geostory.contentToolbar.closeMapEditing"}),i().createElement("div",{className:"mapstore-step-title"},i().createElement(rt.A,{msgId:"geostory.mapEditor.configureMapOptions"})))),i().createElement(Lt.A,{transitionProps:!1,btnGroupProps:{className:"ms-geostory-map-editor-toolbar"},btnDefaultProps:{className:"square-button-md no-border",bsStyle:"primary",noTooltipWhenDisabled:!0},buttons:v}))},!!g&&[i().createElement(va,{map:c,editNode:g}),i().createElement(ga,{closeNodeEditor:h,editNode:g,map:c,onChange:function(e,t){var n=ba()(e,t,{map:c}),r=(null==n?void 0:n.map)||{},o=r.layers,i=r.groups;e.includes("map.layers[")?p("layers",o,"replace"):p("groups",i,"replace")}})]||[i().createElement(ha,{map:c,onChange:u,onChangeMap:p,selectedNodes:m,onSelect:y,hideIdentifyOptions:S})])):null}));var wa=n(679859),Ea=n.n(wa),Sa=n(436334),Pa=n(395348),ja=n(791292),Ta=n(112585);function Ia(e){return Ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ia(e)}function Ca(){return Ca=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ca.apply(null,arguments)}function Aa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ka(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Aa(Object(n),!0).forEach((function(t){Da(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Aa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Da(e,t,n){return(t=function(e){var t=function(e){if("object"!=Ia(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ia(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ia(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ma=function(e){var t=function(){return i().createElement("div",{className:"ms-media-error"},i().createElement(tt.e6,{glyph:"exclamation-sign"}))},n=function(e){var t=e.style,n=void 0===t?{}:t;return i().createElement("div",{style:n,className:"ms-media-loader"},i().createElement(gt.A,{size:52}))};return function(r){var o={},a=r.sectionType;if((a===f.Fq.PARAGRAPH||a===f.Fq.IMMERSIVE||a===f.Fq.CAROUSEL)&&r.type===f.mI.IMAGE){var c=((null==r?void 0:r.imgHeight)||9)/((null==r?void 0:r.imgWidth)||16)*100;o={paddingTop:"".concat(c,"%")}}return r.lazy?i().createElement(vt,{key:r.loadingId,id:r.loadingId,debounceTime:r.debounceTime,loading:r.isLoading,onLoad:function(e){return r.onLoad(ka(ka({},r.loading),{},Da({},e,!1)))},loaderComponent:n,loaderStyle:o},i().createElement(e,Ca({},r,{type:r.type,loaderComponent:n,loaderStyle:o,errorComponent:t}))):i().createElement(e,Ca({},r,{key:r.id,type:r.mediaType||r.type,loaderComponent:n,errorComponent:t}))}};var xa=n(50173),Ra=n(437430),Na=n(734871),La=["autoplay"],_a=["type"];function Fa(e){return Fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fa(e)}function za(){return za=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},za.apply(null,arguments)}function Wa(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Ba(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ua(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ba(Object(n),!0).forEach((function(t){Va(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ba(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Va(e,t,n){return(t=function(e){var t=function(e){if("object"!=Fa(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Fa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Fa(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qa=(0,Re.branch)((function(e){return e.resourceId}),(0,Re.compose)((0,a.connect)((0,c.Mz)(q.Zl,(function(e){return{resources:e}}))),(0,Re.withProps)((function(e){var t=e.resources,n=e.resourceId;return(pn()(t,{id:n})||{}).data}))),(0,Ue.A)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.sectionType;return!n&&r!==f.Fq.TITLE&&!Ea()([f.Fq.IMMERSIVE,f.Fq.CAROUSEL],r)}),(function(){return{glyph:"picture"}})))(Ma(Sa.A)),Ha=(0,Re.compose)((0,Re.branch)((function(e){return e.resourceId}),Wi),(0,Re.withProps)((function(e){var t=e.map,n=void 0===t?{}:t;return{map:Ua(Ua({},n),{},{layers:n.layers&&n.layers.map((function(e){if(e.tileMatrixSet&&n.sources){var t=(0,Ta.hL)(n.sources,e);return Ua(Ua({},e),t)}return e}))})}})),xa.A,Ra.A,$i,Ki,Na.b)(Ma(Pa.A)),Ga={image:qa,map:Ha,video:(0,Re.branch)((function(e){return e.resourceId}),(0,Re.compose)((0,a.connect)((0,c.Mz)(q.Zl,(function(e){return{resources:e}}))),(0,Re.withProps)((function(e){var t=e.resources,n=e.resourceId,r=e.autoplay,o=(pn()(t,{id:n})||{}).data||{},i=o.autoplay;return Ua(Ua({},Wa(o,La)),{},{autoplay:void 0!==r?r:i})}))),(0,Ue.A)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.sectionType;return!n&&r!==f.Fq.TITLE&&!Ea()([f.Fq.IMMERSIVE,f.Fq.CAROUSEL],r)}),(function(){return{glyph:"play"}})))(Ma(ja.A))};const Xa=function(e){var t=e.type,n=Wa(e,_a),r=Ga[t];return r?i().createElement(r,za({type:t},n)):null};var $a=["resources"];function Za(){return Za=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Za.apply(null,arguments)}const Ka=(0,a.connect)((0,c.Mz)(q.Zl,(function(e){return{resources:e}})))((function(e){var t=e.resources,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,$a);if(n.resourceId){var r=(pn()(t,{id:n.resourceId})||{}).data||{};return i().createElement(Xn,Za({},r,n))}return i().createElement(Xn,n)}));var Ya=["story","mode","onAdd","messages","fontFamilies","storyFonts","webFont","onUpdate","onBasicError","onUpdateMediaEditorSetting","mediaEditorSettings","geostoryTitle"];function Ja(){return Ja=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ja.apply(null,arguments)}var Qa=function(e){var t,n=e.story,r=e.mode,a=void 0===r?f.dX.VIEW:r,c=e.onAdd,l=e.messages,s=e.fontFamilies,d=void 0===s?[]:s,y=e.storyFonts,m=void 0===y?[]:y,b=e.webFont,v=void 0===b?u():b,g=e.onUpdate,h=void 0===g?function(){}:g,O=e.onBasicError,w=void 0===O?function(){}:O,E=e.onUpdateMediaEditorSetting,S=e.mediaEditorSettings,P=e.geostoryTitle,j=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Ya),T=(0,o.useRef)(),I=(0,o.useCallback)((function(e){return(0,p.kA)(l,e)}),[l]),C=function(e,t,n,r){return c(e,t,n,r?I(r):I)};return(0,o.useEffect)((function(){window.__geostory_interaction=function(e,t){"scrollTo"===e&&(0,f.oS)(t,{behavior:"smooth"})}}),[]),(0,o.useEffect)((function(){h("settings.theme.fontFamilies",d,"merge",{uniqueByKey:"family"}),S&&E(S)}),[]),(0,o.useEffect)((function(){m.length>0&&m.filter((function(e){var t=e.src;return t&&!document.head.querySelector("link[href='".concat(t,"']"))})).length>0&&v.load((0,f.Z_)(m,(function(){}),(function(){return w({message:"geostory.builder.settings.webFontLoadError"})})))}),[m]),(0,o.useEffect)((function(){var e=null==j?void 0:j.gid;return T.current||(T.current=document.title),P&&e&&(document.title=P),function(){e&&(document.title=T.current)}}),[P]),i().createElement(Me.A,{className:"ms-geostory",columns:[i().createElement(Oa,Ja({},j,{buttonItems:null===(t=j.items)||void 0===t?void 0:t.filter((function(e){return"mapEditorToolbar"===e.target})),add:C,update:h,mode:a,hideIdentifyOptions:j.hideIdentifyOptions}))]},i().createElement(Ci,Ja({},n,j,{storyFonts:(0,f.TV)(m),add:C,update:h,mode:a,mediaViewer:Xa,contentToolbar:Ka})))};Qa.defaultProps={storyFonts:[],fontFamilies:[],onUpdateMediaEditorSetting:function(){}};const ec=(0,s.i1)("GeoStory",{component:(0,a.connect)((0,c.j8)({mode:q.XU,story:q.E_,messages:ke.TI,focusedContent:q.Uj,isContentFocused:q.Wt,theme:function(e){var t;return(null===(t=(0,q.t2)(e))||void 0===t?void 0:t.theme)||{}},storyFonts:q.d$,isDrawEnabled:q.TZ,geostoryTitle:q.U2}),{onAdd:y.WQ,onUpdate:y.yo,updateCurrentPage:y.yf,onUpdateSetting:y.cD,remove:y.TF,onSort:y.Cy,editMedia:m.bk,editWebPage:y._v,onBasicError:d.X,onUpdateMediaEditorSetting:y.ob,onEnableDraw:y.uM})(Qa),reducers:{geostory:De.A},epics:r})},306364:(e,t,n)=>{"use strict";n.d(t,{$u:()=>C,Ed:()=>j,Kn:()=>y,L8:()=>g,RZ:()=>D,S0:()=>v,TH:()=>m,YI:()=>A,eB:()=>P,es:()=>O,g8:()=>k,g9:()=>I,kT:()=>T,nf:()=>E,p1:()=>w,sn:()=>h,sz:()=>d,um:()=>b,vu:()=>S});var r=n(858156),o=n.n(r),i=n(907309),a=n.n(i),c=n(801081),l=n(112585);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return(t=function(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(e){return o()(e,"mediaEditor.open")},y=function(e){return o()(e,"mediaEditor.saveState.editing",!1)},m=function(e){return o()(e,"mediaEditor.saveState.addingMedia",!1)},b=function(e){return o()(e,"mediaEditor.saveState")},v=function(e){return o()(e,"mediaEditor.settings.sourceId")},g=function(e){return o()(e,"mediaEditor.settings.mediaType")},h=function(e){return o()(e,"mediaEditor.settings.sources")},O=function(e){return o()(h(e),v(e),{})},w=function(e){return function(e){return o()(function(e){return o()(e,"mediaEditor.settings.mediaTypes")}(e),"".concat(g(e),".sources"),[])}(e).map((function(t){return{id:t,name:(n=t,function(e){return o()(h(e),"".concat(n),{})})(e).name};var n}))},E=function(e){return o()(e,'mediaEditor.data["'.concat(g(e),'"]["').concat(v(e),'"].resultData'))},S=function(e){return o()(e,'mediaEditor.data["'.concat(g(e),'"]["').concat(v(e),'"].params'))},P=function(e){return o()(E(e),"resources")},j=function(e){return o()(E(e),"totalCount")},T=function(e){return o()(e,"mediaEditor.selected")},I=function(e){return o()(e,"mediaEditor.loadingSelected")},C=function(e){return o()(e,"mediaEditor.loadingList")},A=(0,c.Mz)(P,T,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=a()(e,{id:t});return n&&"map"===n.type&&n.data.layers?f(f({},n),{},{data:f(f({},n.data),{},{layers:n.data.layers.map((function(e){if((e.tileMatrixSet||e.availableTileMatrixSets)&&n.data.sources){var t=(0,l.hL)(n.data.sources,e);return f(f({},e),t)}return e}))})}):n})),k=function(e){return o()(e,"mediaEditor.disabledMediaType",[])},D=function(e){return k(e).length&&!A(e)&&"map"===g(e)||I(e)}},958722:(e,t,n)=>{"use strict";n.d(t,{X:()=>o});var r=n(883832),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.title,n=void 0===t?"notification.warning":t,o=e.autoDismiss,i=void 0===o?6:o,a=e.position,c=void 0===a?"tc":a,l=e.message,u=void 0===l?"Error":l;return(0,r.z3)({title:n,autoDismiss:i,position:c,message:u})}},372401:(e,t,n)=>{e.exports=n.p+"grid.svg"},855799:(e,t,n)=>{e.exports=n.p+"world.svg"},522131:(e,t,n)=>{e.exports=n.p+"MapStore2/web/client/components/geostory/contents/carousel/img/default.jpg"},141265:(e,t,n)=>{e.exports=n.p+"MapStore2/web/client/components/geostory/layouts/sections/patterns/dots.png"}}]);